(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[486],{63:(e,a,t)=>{"use strict";var s=t(7260);t.o(s,"useParams")&&t.d(a,{useParams:function(){return s.useParams}}),t.o(s,"useRouter")&&t.d(a,{useRouter:function(){return s.useRouter}})},4831:(e,a,t)=>{Promise.resolve().then(t.bind(t,9485))},7337:(e,a,t)=>{"use strict";t.d(a,{StatsDashboard:()=>m});var s=t(5155),l=t(2115);function o(e){let{activity:a}=e,t=a.slice(-35),l=35===t.length?t:0===t.length?Array.from({length:35},(e,a)=>{let t=new Date;return t.setDate(t.getDate()-(34-a)),{date:t.toISOString().slice(0,10),messages:0}}):[...Array.from({length:35-t.length},(e,a)=>({date:((e,a)=>{let t=new Date("".concat(e,"T00:00:00"));return t.setDate(t.getDate()+a),t.toISOString().slice(0,10)})(t[0].date,a-(35-t.length)),messages:0})),...t];return(0,s.jsxs)("section",{className:"oc-panel p-4 md:p-5",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Activity"}),(0,s.jsx)("p",{className:"text-sm text-[color:var(--text-secondary)]",children:"Message intensity over the last 35 days."})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs text-[color:var(--text-muted)]",children:[(0,s.jsx)("span",{children:"Low"}),(0,s.jsx)("span",{className:"inline-block size-3 rounded-sm bg-[#13203a]"}),(0,s.jsx)("span",{className:"inline-block size-3 rounded-sm bg-cyan-900/70"}),(0,s.jsx)("span",{className:"inline-block size-3 rounded-sm bg-cyan-700/80"}),(0,s.jsx)("span",{className:"inline-block size-3 rounded-sm bg-[color:var(--cyan-mid)]"}),(0,s.jsx)("span",{className:"inline-block size-3 rounded-sm bg-[color:var(--cyan-bright)]"}),(0,s.jsx)("span",{children:"High"})]})]}),(0,s.jsx)("div",{className:"mt-4 grid grid-cols-7 gap-2","aria-label":"Activity heatmap",children:l.map((e,a)=>{var t;return(0,s.jsx)("div",{title:"".concat(e.date,": ").concat(e.messages," messages"),className:"aspect-square min-h-4 rounded-md border border-white/5 ".concat((t=e.messages)>=40?"bg-[color:var(--cyan-bright)] shadow-[0_0_16px_rgba(25,226,197,0.45)]":t>=20?"bg-[color:var(--cyan-mid)]":t>=8?"bg-cyan-700/80":t>0?"bg-cyan-900/70":"bg-[#13203a]")},"".concat(e.date,"-").concat(a))})})]})}function r(e){let{label:a,value:t,caption:l,tone:o="cyan"}=e;return(0,s.jsxs)("article",{className:"oc-panel p-4 ".concat("coral"===o?"shadow-[0_0_30px_rgba(255,92,87,0.09)]":"shadow-[0_0_30px_rgba(25,226,197,0.09)]"),children:[(0,s.jsx)("div",{className:"pointer-events-none absolute inset-x-0 top-0 h-px bg-gradient-to-r ".concat("coral"===o?"from-[color:var(--coral-bright)]/80 to-transparent":"from-[color:var(--cyan-bright)]/80 to-transparent")}),(0,s.jsx)("p",{className:"text-xs uppercase tracking-[0.2em] text-[color:var(--text-muted)]",children:a}),(0,s.jsx)("p",{className:"mt-2 text-3xl font-semibold leading-none",children:t}),l?(0,s.jsx)("p",{className:"mt-1 text-sm text-[color:var(--text-secondary)]",children:l}):null]})}let n=["24h","7d","30d","all"],c={"24h":"24 hours","7d":"7 days","30d":"30 days",all:"all time"},i=e=>Intl.NumberFormat("en-US").format(e),d=e=>"all"===e?"All-time aggregate":"Window: ".concat(c[e]);function m(e){let a,{stats:t}=e,[c,m]=(0,l.useState)("30d"),x=(0,l.useMemo)(()=>t.periods[c],[c,t.periods]);return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("section",{className:"oc-panel p-4 md:p-5",children:(0,s.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"oc-kicker",children:"Usage Window"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-[color:var(--text-secondary)]",children:"Toggle the category window to inspect near-term spikes versus all-time totals."})]}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:n.map(e=>{let a=e===c;return(0,s.jsx)("button",{type:"button",onClick:()=>m(e),className:"rounded-full border px-3 py-1.5 text-xs font-semibold uppercase tracking-[0.14em] transition ".concat(a?"border-[color:var(--cyan-mid)] bg-[color:var(--cyan-soft)] text-[color:var(--text-primary)]":"border-[color:var(--border-subtle)] bg-[color:var(--bg-surface)] text-[color:var(--text-secondary)] hover:text-white"),children:e},e)})})]})}),(0,s.jsxs)("section",{className:"grid gap-4 sm:grid-cols-2 xl:grid-cols-4",children:[(0,s.jsx)(r,{label:"Total Tokens",value:i(x.tokens),caption:d(c),tone:"cyan"}),(0,s.jsx)(r,{label:"Total Cost",value:(a=x.cost,Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:2}).format(a)),caption:d(c),tone:"coral"}),(0,s.jsx)(r,{label:"Messages",value:i(x.messages),caption:d(c),tone:"cyan"}),(0,s.jsx)(r,{label:"Sessions",value:i(x.sessions),caption:d(c),tone:"coral"})]}),(0,s.jsxs)("section",{className:"grid gap-4 lg:grid-cols-2",children:[(0,s.jsxs)("article",{className:"oc-panel p-4 md:p-5",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Top Models"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-[color:var(--text-secondary)]",children:"Token-heavy models over the selected data horizon."}),(0,s.jsx)("ul",{className:"mt-4 space-y-3",children:t.topModels.map(e=>(0,s.jsxs)("li",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between gap-3 text-sm",children:[(0,s.jsx)("span",{className:"truncate",children:e.model}),(0,s.jsx)("span",{className:"font-[family-name:var(--font-mono)] text-[color:var(--text-secondary)]",children:i(e.tokens)})]}),(0,s.jsx)("div",{className:"mt-1.5 h-1.5 overflow-hidden rounded-full bg-white/7",children:(0,s.jsx)("div",{className:"h-full rounded-full bg-gradient-to-r from-[color:var(--coral-mid)] to-[color:var(--coral-bright)]",style:{width:"".concat(((e,a)=>{let t=Math.max(...a.map(e=>e.tokens),1);return Math.max(6,Math.round(e.tokens/t*100))})(e,t.topModels),"%")}})})]},e.model))})]}),(0,s.jsxs)("article",{className:"oc-panel p-4 md:p-5",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Top Tools"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-[color:var(--text-secondary)]",children:"Most-invoked tools from OpenClaw session telemetry."}),(0,s.jsx)("ul",{className:"mt-4 space-y-3",children:t.topTools.map(e=>(0,s.jsxs)("li",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between gap-3 text-sm",children:[(0,s.jsx)("span",{className:"truncate",children:e.tool}),(0,s.jsx)("span",{className:"font-[family-name:var(--font-mono)] text-[color:var(--text-secondary)]",children:i(e.count)})]}),(0,s.jsx)("div",{className:"mt-1.5 h-1.5 overflow-hidden rounded-full bg-white/7",children:(0,s.jsx)("div",{className:"h-full rounded-full bg-gradient-to-r from-[color:var(--cyan-mid)] to-[color:var(--cyan-bright)]",style:{width:"".concat(((e,a)=>{let t=Math.max(...a.map(e=>e.count),1);return Math.max(6,Math.round(e.count/t*100))})(e,t.topTools),"%")}})})]},e.tool))})]})]}),(0,s.jsx)(o,{activity:t.activity})]})}},9485:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>i});var s=t(5155),l=t(2619),o=t.n(l),r=t(63),n=t(2115),c=t(7337);function i(){let e=(0,r.useRouter)(),[a,t]=(0,n.useState)(null),[l,i]=(0,n.useState)(null),[d,m]=(0,n.useState)(!0),[x,h]=(0,n.useState)(!1),[p,u]=(0,n.useState)(null),g=(0,n.useMemo)(()=>{let e=localStorage.getItem("clawboard.gatewayUrl"),a=localStorage.getItem("clawboard.apiKey");return e||a?{gatewayUrl:e,apiKey:a}:null},[]),y=async e=>{let a=await fetch("/api/stats/".concat(encodeURIComponent(e)),{cache:"no-store"});if(!a.ok){var t;throw Error(null!=(t=(await a.json()).error)?t:"Unable to load stats")}i(await a.json())};(0,n.useEffect)(()=>{let e=localStorage.getItem("clawboard.token");if(!e)return void m(!1);t(e),y(e).catch(e=>{u(e instanceof Error?e.message:"Unable to load dashboard")}).finally(()=>{m(!1)})},[]);let b=async()=>{if(!a)return void u("No active local session. Reconnect from the home page.");u(null),h(!0);try{let t=await fetch("/api/sync",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({anonymousToken:a,...(null==g?void 0:g.gatewayUrl)?{gatewayUrl:g.gatewayUrl}:{},...(null==g?void 0:g.apiKey)?{apiKey:g.apiKey}:{}})});if(!t.ok){var e;let a=await t.json();throw Error(null!=(e=a.error)?e:"Sync failed")}await y(a)}catch(e){u(e instanceof Error?e.message:"Sync failed")}finally{h(!1)}},f=async()=>{if(!a||!l)return;let e=!l.shareEnabled;i({...l,shareEnabled:e});let t=await fetch("/api/share",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({anonymousToken:a,shareEnabled:e})});if(!t.ok){var s;i({...l,shareEnabled:!e}),u(null!=(s=(await t.json()).error)?s:"Unable to update sharing preference")}},v=!d&&!a;return(0,s.jsxs)("main",{className:"oc-shell",children:[(0,s.jsxs)("header",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"oc-kicker",children:"ClawBoard Control Room"}),(0,s.jsx)("h1",{className:"mt-1 text-4xl font-semibold md:text-5xl",children:"Usage Dashboard"}),(0,s.jsx)("p",{className:"mt-2 text-sm text-[color:var(--text-secondary)]",children:"Live OpenClaw telemetry in read-only mode."})]}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,s.jsx)(o(),{href:"/",className:"oc-nav-link",children:"Home"}),(0,s.jsx)(o(),{href:"/leaderboard",className:"oc-nav-link",children:"Leaderboard"}),(0,s.jsx)("button",{type:"button",onClick:()=>{localStorage.removeItem("clawboard.token"),localStorage.removeItem("clawboard.gatewayUrl"),localStorage.removeItem("clawboard.apiKey"),e.push("/")},disabled:!a,className:"oc-nav-link disabled:cursor-not-allowed",children:"Disconnect"})]})]}),v?(0,s.jsxs)("section",{className:"oc-panel mt-7 p-6",children:[(0,s.jsx)("p",{className:"oc-kicker",children:"Session Required"}),(0,s.jsx)("h2",{className:"mt-2 text-2xl font-semibold",children:"No local session found."}),(0,s.jsx)("p",{className:"mt-2 text-sm text-[color:var(--text-secondary)]",children:"Connect from the home page to start reading usage stats from your OpenClaw gateway."}),(0,s.jsx)(o(),{href:"/",className:"oc-button-primary mt-5 px-4 py-2 text-sm",children:"Go to Home"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("section",{className:"oc-panel mt-7 p-4 md:p-5",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,s.jsxs)("p",{className:"text-sm text-[color:var(--text-secondary)]",children:["Last updated: ",l?new Date(l.updatedAt).toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):"Not synced yet"]}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,s.jsx)("button",{type:"button",onClick:b,disabled:x||!a,className:"oc-button-primary px-4 py-2 text-sm",children:x?"Syncing...":"Sync Now"}),(0,s.jsx)("button",{type:"button",onClick:f,disabled:!l,className:"oc-button-secondary px-4 py-2 text-sm",children:(null==l?void 0:l.shareEnabled)?"Sharing Enabled":"Enable Sharing"})]})]}),(0,s.jsx)("div",{className:"oc-trust mt-4 rounded-lg px-3 py-2 text-xs text-[color:var(--text-secondary)]",children:"Safety: this dashboard only reads telemetry stats. It cannot execute tasks, call tools, or alter files."})]}),p?(0,s.jsx)("p",{className:"mt-4 rounded-lg border border-[color:var(--border-strong)] bg-[color:var(--coral-soft)] px-3 py-2 text-sm text-rose-100",children:p}):null,(0,s.jsx)("section",{className:"mt-7",children:d?(0,s.jsx)("div",{className:"oc-panel p-8 text-sm text-[color:var(--text-secondary)]",children:"Loading dashboard..."}):l?(0,s.jsx)(c.StatsDashboard,{stats:l}):(0,s.jsx)("div",{className:"oc-panel p-8 text-sm text-[color:var(--text-secondary)]",children:"No stats available yet. Run one sync to populate your dashboard."})})]})]})}}},e=>{e.O(0,[619,441,255,358],()=>e(e.s=4831)),_N_E=e.O()}]);