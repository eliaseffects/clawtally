(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{63:(e,t,a)=>{"use strict";var o=a(7260);a.o(o,"useRouter")&&a.d(t,{useRouter:function(){return o.useRouter}})},1213:(e,t,a)=>{Promise.resolve().then(a.bind(a,8746)),Promise.resolve().then(a.t.bind(a,2619,23))},8746:(e,t,a)=>{"use strict";a.d(t,{ConnectForm:()=>s});var o=a(5155),r=a(63),l=a(2115);function s(){let e=(0,r.useRouter)(),[t,a]=(0,l.useState)("ws://127.0.0.1:18789"),[s,n]=(0,l.useState)(""),[c,d]=(0,l.useState)(!1),[i,u]=(0,l.useState)(null),p=async a=>{a.preventDefault(),u(null),d(!0);try{var o,r;let a=await fetch("/api/connect",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({gatewayUrl:t,apiKey:s})});if(!a.ok){let e=await a.json();u(null!=(o=e.error)?o:"Failed to connect");return}let l=await a.json();localStorage.setItem("clawboard.gatewayUrl",t),localStorage.setItem("clawboard.apiKey",s),localStorage.setItem("clawboard.token",l.anonymousToken);let n=await fetch("/api/sync",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({anonymousToken:l.anonymousToken,gatewayUrl:t,apiKey:s})});if(!n.ok){let e=await n.json();u(null!=(r=e.error)?r:"Connected but failed to sync usage");return}e.push("/dashboard")}catch(e){u("Network error while connecting to gateway")}finally{d(!1)}};return(0,o.jsxs)("form",{onSubmit:p,className:"space-y-4 rounded-3xl border border-[color:var(--border)] bg-[color:var(--bg-secondary)] p-6",children:[(0,o.jsxs)("div",{className:"space-y-2",children:[(0,o.jsx)("label",{htmlFor:"gateway-url",className:"block text-xs uppercase tracking-[0.18em] text-[color:var(--text-muted)]",children:"Gateway URL"}),(0,o.jsx)("input",{id:"gateway-url",type:"url",value:t,onChange:e=>a(e.target.value),placeholder:"ws://127.0.0.1:18789",className:"w-full rounded-xl border border-[color:var(--border)] bg-black/20 px-3 py-2 text-sm outline-none transition focus:border-emerald-400",required:!0}),(0,o.jsxs)("p",{className:"text-xs text-[color:var(--text-muted)]",children:["Use ",(0,o.jsx)("code",{children:"ws://localhost:18789"}),". ",(0,o.jsx)("code",{children:"http://"})," URLs are converted automatically."]})]}),(0,o.jsxs)("div",{className:"space-y-2",children:[(0,o.jsx)("label",{htmlFor:"api-key",className:"block text-xs uppercase tracking-[0.18em] text-[color:var(--text-muted)]",children:"API Key"}),(0,o.jsx)("input",{id:"api-key",type:"password",value:s,onChange:e=>n(e.target.value),placeholder:"Optional",className:"w-full rounded-xl border border-[color:var(--border)] bg-black/20 px-3 py-2 text-sm outline-none transition focus:border-emerald-400"})]}),i?(0,o.jsx)("p",{className:"rounded-lg bg-rose-900/35 px-3 py-2 text-sm text-rose-200",children:i}):null,(0,o.jsx)("button",{type:"submit",disabled:c,className:"w-full rounded-xl bg-emerald-400 px-4 py-2 text-sm font-semibold text-black transition hover:bg-emerald-300 disabled:cursor-not-allowed disabled:opacity-70",children:c?"Connecting...":"Connect"})]})}}},e=>{e.O(0,[619,441,255,358],()=>e(e.s=1213)),_N_E=e.O()}]);