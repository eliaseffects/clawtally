(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[486],{63:(e,t,a)=>{"use strict";var r=a(7260);a.o(r,"useParams")&&a.d(t,{useParams:function(){return r.useParams}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}})},4831:(e,t,a)=>{Promise.resolve().then(a.bind(a,7926))},7926:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var r=a(5155),o=a(2619),s=a.n(o),l=a(63),n=a(2115);function c(e){let{activity:t}=e,a=t.slice(-35),o=35===a.length?a:0===a.length?Array.from({length:35},(e,t)=>{let a=new Date;return a.setDate(a.getDate()-(34-t)),{date:a.toISOString().slice(0,10),messages:0}}):[...Array.from({length:35-a.length},(e,t)=>({date:((e,t)=>{let a=new Date("".concat(e,"T00:00:00"));return a.setDate(a.getDate()+t),a.toISOString().slice(0,10)})(a[0].date,t-(35-a.length)),messages:0})),...a];return(0,r.jsxs)("section",{className:"rounded-2xl border border-[color:var(--border)] bg-[color:var(--bg-secondary)] p-4",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-[color:var(--text-muted)]",children:"Activity (last 35 days)"}),(0,r.jsx)("div",{className:"mt-4 grid grid-cols-7 gap-2",children:o.map((e,t)=>{var a;return(0,r.jsx)("div",{title:"".concat(e.date,": ").concat(e.messages," messages"),className:"aspect-square min-h-4 rounded-md ".concat((a=e.messages)>=40?"bg-emerald-400":a>=20?"bg-emerald-500/70":a>=8?"bg-emerald-700/65":a>0?"bg-emerald-900/70":"bg-slate-800")},"".concat(e.date,"-").concat(t))})})]})}function i(e){let{label:t,value:a,caption:o}=e;return(0,r.jsxs)("article",{className:"rounded-2xl border border-[color:var(--border)] bg-[color:var(--bg-secondary)] p-4",children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-[0.2em] text-[color:var(--text-muted)]",children:t}),(0,r.jsx)("p",{className:"mt-2 text-2xl font-semibold leading-none",children:a}),o?(0,r.jsx)("p",{className:"mt-1 text-sm text-[color:var(--text-muted)]",children:o}):null]})}let d=e=>Intl.NumberFormat("en-US").format(e);function m(e){let t,{stats:a}=e;return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("section",{className:"grid gap-4 sm:grid-cols-2 xl:grid-cols-4",children:[(0,r.jsx)(i,{label:"Total Tokens",value:d(a.totalTokens),caption:"All time"}),(0,r.jsx)(i,{label:"Total Cost",value:(t=a.totalCost,Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:2}).format(t)),caption:"All time"}),(0,r.jsx)(i,{label:"Messages",value:d(a.messageCount),caption:"All time"}),(0,r.jsx)(i,{label:"Sessions",value:d(a.sessionCount),caption:"All time"})]}),(0,r.jsxs)("section",{className:"grid gap-4 lg:grid-cols-2",children:[(0,r.jsxs)("article",{className:"rounded-2xl border border-[color:var(--border)] bg-[color:var(--bg-secondary)] p-4",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-[color:var(--text-muted)]",children:"Top Models"}),(0,r.jsx)("ul",{className:"mt-3 space-y-2",children:a.topModels.map(e=>(0,r.jsxs)("li",{className:"flex items-center justify-between gap-3 text-sm",children:[(0,r.jsx)("span",{children:e.model}),(0,r.jsx)("span",{className:"font-[family-name:var(--font-mono)] text-[color:var(--text-muted)]",children:d(e.tokens)})]},e.model))})]}),(0,r.jsxs)("article",{className:"rounded-2xl border border-[color:var(--border)] bg-[color:var(--bg-secondary)] p-4",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-[color:var(--text-muted)]",children:"Top Tools"}),(0,r.jsx)("ul",{className:"mt-3 space-y-2",children:a.topTools.map(e=>(0,r.jsxs)("li",{className:"flex items-center justify-between gap-3 text-sm",children:[(0,r.jsx)("span",{children:e.tool}),(0,r.jsx)("span",{className:"font-[family-name:var(--font-mono)] text-[color:var(--text-muted)]",children:d(e.count)})]},e.tool))})]})]}),(0,r.jsx)(c,{activity:a.activity})]})}function u(){let e=(0,l.useRouter)(),[t,a]=(0,n.useState)(null),[o,c]=(0,n.useState)(null),[i,d]=(0,n.useState)(!0),[u,x]=(0,n.useState)(!1),[b,h]=(0,n.useState)(null),p=(0,n.useMemo)(()=>{let e=localStorage.getItem("clawboard.gatewayUrl"),t=localStorage.getItem("clawboard.apiKey");return e||t?{gatewayUrl:e,apiKey:t}:null},[]),g=async e=>{let t=await fetch("/api/stats/".concat(encodeURIComponent(e)),{cache:"no-store"});if(!t.ok){var a;throw Error(null!=(a=(await t.json()).error)?a:"Unable to load stats")}c(await t.json())};(0,n.useEffect)(()=>{let e=localStorage.getItem("clawboard.token");if(!e)return void d(!1);a(e),g(e).catch(e=>{h(e instanceof Error?e.message:"Unable to load dashboard")}).finally(()=>{d(!1)})},[]);let f=async()=>{if(!t)return void h("No active local session. Reconnect from the home page.");h(null),x(!0);try{let a=await fetch("/api/sync",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({anonymousToken:t,...(null==p?void 0:p.gatewayUrl)?{gatewayUrl:p.gatewayUrl}:{},...(null==p?void 0:p.apiKey)?{apiKey:p.apiKey}:{}})});if(!a.ok){var e;let t=await a.json();throw Error(null!=(e=t.error)?e:"Sync failed")}await g(t)}catch(e){h(e instanceof Error?e.message:"Sync failed")}finally{x(!1)}},v=async()=>{if(!t||!o)return;let e=!o.shareEnabled;c({...o,shareEnabled:e});let a=await fetch("/api/share",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({anonymousToken:t,shareEnabled:e})});if(!a.ok){var r;c({...o,shareEnabled:!e}),h(null!=(r=(await a.json()).error)?r:"Unable to update sharing preference")}},y=!i&&!t;return(0,r.jsxs)("main",{className:"mx-auto min-h-screen w-full max-w-6xl px-5 py-10 md:px-8 md:py-14",children:[(0,r.jsxs)("header",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-[0.2em] text-[color:var(--text-muted)]",children:"Personal Dashboard"}),(0,r.jsx)("h1",{className:"mt-1 text-2xl font-semibold",children:"Your OpenClaw usage snapshot"})]}),(0,r.jsxs)("div",{className:"flex w-full flex-wrap items-center gap-2 text-sm md:w-auto",children:[(0,r.jsx)(s(),{href:"/leaderboard",className:"rounded-xl border border-[color:var(--border)] px-3 py-2 text-[color:var(--text-muted)] transition hover:text-white focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-emerald-400",children:"View Leaderboard"}),(0,r.jsx)("button",{type:"button",onClick:()=>{localStorage.removeItem("clawboard.token"),localStorage.removeItem("clawboard.gatewayUrl"),localStorage.removeItem("clawboard.apiKey"),e.push("/")},disabled:!t,className:"rounded-xl border border-[color:var(--border)] px-3 py-2 text-[color:var(--text-muted)] transition hover:text-white focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-emerald-400 disabled:cursor-not-allowed disabled:opacity-50",children:"Disconnect"})]})]}),y?(0,r.jsxs)("section",{className:"mt-6 rounded-2xl border border-[color:var(--border)] bg-[color:var(--bg-secondary)] p-6",children:[(0,r.jsx)("p",{className:"text-sm text-[color:var(--text-muted)]",children:"No local session is active on this device."}),(0,r.jsx)("p",{className:"mt-2 text-sm text-[color:var(--text-muted)]",children:"Reconnect from the home page to resume sync and sharing."}),(0,r.jsx)(s(),{href:"/",className:"mt-4 inline-flex rounded-xl bg-emerald-400 px-4 py-2 text-sm font-semibold text-black transition hover:bg-emerald-300 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-emerald-400",children:"Go Home"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("section",{className:"mt-6 rounded-2xl border border-[color:var(--border)] bg-[color:var(--bg-secondary)] p-4 text-sm",children:(0,r.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,r.jsxs)("p",{className:"text-[color:var(--text-muted)]",children:["Last updated: ",o?new Date(o.updatedAt).toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):"Not synced yet"]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{type:"button",onClick:f,disabled:u||!t,className:"rounded-lg bg-emerald-400 px-3 py-2 text-sm font-semibold text-black transition hover:bg-emerald-300 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-emerald-400 disabled:cursor-not-allowed disabled:opacity-75",children:u?"Syncing...":"Sync Now"}),(0,r.jsx)("button",{type:"button",onClick:v,disabled:!o,className:"rounded-lg border border-[color:var(--border)] px-3 py-2 text-[color:var(--text-muted)] transition hover:text-white focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-emerald-400 disabled:opacity-60",children:(null==o?void 0:o.shareEnabled)?"Sharing On":"Share Anonymously"})]})]})}),b?(0,r.jsx)("p",{className:"mt-4 rounded-lg bg-rose-900/35 px-3 py-2 text-sm text-rose-200",children:b}):null,(0,r.jsx)("section",{className:"mt-6",children:i?(0,r.jsx)("div",{className:"rounded-2xl border border-[color:var(--border)] bg-[color:var(--bg-secondary)] p-8 text-sm text-[color:var(--text-muted)]",children:"Loading dashboard..."}):o?(0,r.jsx)(m,{stats:o}):(0,r.jsx)("div",{className:"rounded-2xl border border-[color:var(--border)] bg-[color:var(--bg-secondary)] p-8 text-sm text-[color:var(--text-muted)]",children:"No stats available yet. Sync once to populate your dashboard."})})]})]})}}},e=>{e.O(0,[619,441,255,358],()=>e(e.s=4831)),_N_E=e.O()}]);