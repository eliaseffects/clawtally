/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/connect/route";
exports.ids = ["app/api/connect/route"];
exports.modules = {

/***/ "(rsc)/./app/api/connect/route.ts":
/*!**********************************!*\
  !*** ./app/api/connect/route.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_data_store__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/data/store */ \"(rsc)/./lib/data/store.ts\");\n/* harmony import */ var _lib_gateway_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/gateway/client */ \"(rsc)/./lib/gateway/client.ts\");\n/* harmony import */ var _lib_tokens__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/tokens */ \"(rsc)/./lib/tokens.ts\");\n\n\n\n\nasync function POST(request) {\n    const body = await request.json();\n    if (!body.gatewayUrl) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"gatewayUrl is required\"\n        }, {\n            status: 400\n        });\n    }\n    let parsedUrl;\n    try {\n        parsedUrl = new URL(body.gatewayUrl);\n    } catch  {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"gatewayUrl must be a valid URL\"\n        }, {\n            status: 400\n        });\n    }\n    let agents;\n    try {\n        agents = await (0,_lib_gateway_client__WEBPACK_IMPORTED_MODULE_2__.validateGatewayConnection)({\n            gatewayUrl: parsedUrl.toString(),\n            apiKey: body.apiKey\n        });\n    } catch (error) {\n        const message = error instanceof Error ? error.message : \"Connection failed\";\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: message\n        }, {\n            status: 502\n        });\n    }\n    const userId = crypto.randomUUID();\n    (0,_lib_data_store__WEBPACK_IMPORTED_MODULE_1__.createUser)({\n        id: userId,\n        anonymousId: userId.slice(0, 6),\n        claimed: false,\n        shareEnabled: false,\n        gatewayUrl: parsedUrl.toString(),\n        gatewayApiKey: body.apiKey ?? \"\",\n        createdAt: new Date().toISOString()\n    });\n    const anonymousToken = (0,_lib_tokens__WEBPACK_IMPORTED_MODULE_3__.issueAnonymousToken)(userId);\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        success: true,\n        agents,\n        anonymousToken\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2Nvbm5lY3Qvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBMkM7QUFFRztBQUNtQjtBQUVkO0FBTzVDLGVBQWVJLEtBQUtDLE9BQWdCO0lBQ3pDLE1BQU1DLE9BQVEsTUFBTUQsUUFBUUUsSUFBSTtJQUVoQyxJQUFJLENBQUNELEtBQUtFLFVBQVUsRUFBRTtRQUNwQixPQUFPUixxREFBWUEsQ0FBQ08sSUFBSSxDQUFDO1lBQUVFLE9BQU87UUFBeUIsR0FBRztZQUFFQyxRQUFRO1FBQUk7SUFDOUU7SUFFQSxJQUFJQztJQUNKLElBQUk7UUFDRkEsWUFBWSxJQUFJQyxJQUFJTixLQUFLRSxVQUFVO0lBQ3JDLEVBQUUsT0FBTTtRQUNOLE9BQU9SLHFEQUFZQSxDQUFDTyxJQUFJLENBQUM7WUFBRUUsT0FBTztRQUFpQyxHQUFHO1lBQUVDLFFBQVE7UUFBSTtJQUN0RjtJQUVBLElBQUlHO0lBQ0osSUFBSTtRQUNGQSxTQUFTLE1BQU1YLDhFQUF5QkEsQ0FBQztZQUN2Q00sWUFBWUcsVUFBVUcsUUFBUTtZQUM5QkMsUUFBUVQsS0FBS1MsTUFBTTtRQUNyQjtJQUNGLEVBQUUsT0FBT04sT0FBTztRQUNkLE1BQU1PLFVBQVVQLGlCQUFpQlEsUUFBUVIsTUFBTU8sT0FBTyxHQUFHO1FBQ3pELE9BQU9oQixxREFBWUEsQ0FBQ08sSUFBSSxDQUFDO1lBQUVFLE9BQU9PO1FBQVEsR0FBRztZQUFFTixRQUFRO1FBQUk7SUFDN0Q7SUFFQSxNQUFNUSxTQUFTQyxPQUFPQyxVQUFVO0lBQ2hDbkIsMkRBQVVBLENBQUM7UUFDVG9CLElBQUlIO1FBQ0pJLGFBQWFKLE9BQU9LLEtBQUssQ0FBQyxHQUFHO1FBQzdCQyxTQUFTO1FBQ1RDLGNBQWM7UUFDZGpCLFlBQVlHLFVBQVVHLFFBQVE7UUFDOUJZLGVBQWVwQixLQUFLUyxNQUFNLElBQUk7UUFDOUJZLFdBQVcsSUFBSUMsT0FBT0MsV0FBVztJQUNuQztJQUVBLE1BQU1DLGlCQUFpQjNCLGdFQUFtQkEsQ0FBQ2U7SUFFM0MsT0FBT2xCLHFEQUFZQSxDQUFDTyxJQUFJLENBQUM7UUFDdkJ3QixTQUFTO1FBQ1RsQjtRQUNBaUI7SUFDRjtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvZWxpYXNzdGV2ZW5zb24vRGVza3RvcC9Qcm9qZWN0cy9jbGF3Ym9hcmQvYXBwL2FwaS9jb25uZWN0L3JvdXRlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L3NlcnZlclwiO1xuXG5pbXBvcnQgeyBjcmVhdGVVc2VyIH0gZnJvbSBcIkAvbGliL2RhdGEvc3RvcmVcIjtcbmltcG9ydCB7IHZhbGlkYXRlR2F0ZXdheUNvbm5lY3Rpb24gfSBmcm9tIFwiQC9saWIvZ2F0ZXdheS9jbGllbnRcIjtcbmltcG9ydCB7IEdhdGV3YXlBZ2VudCB9IGZyb20gXCJAL2xpYi9nYXRld2F5L3R5cGVzXCI7XG5pbXBvcnQgeyBpc3N1ZUFub255bW91c1Rva2VuIH0gZnJvbSBcIkAvbGliL3Rva2Vuc1wiO1xuXG5pbnRlcmZhY2UgQ29ubmVjdEJvZHkge1xuICBnYXRld2F5VXJsPzogc3RyaW5nO1xuICBhcGlLZXk/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IFJlcXVlc3QpIHtcbiAgY29uc3QgYm9keSA9IChhd2FpdCByZXF1ZXN0Lmpzb24oKSkgYXMgQ29ubmVjdEJvZHk7XG5cbiAgaWYgKCFib2R5LmdhdGV3YXlVcmwpIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogXCJnYXRld2F5VXJsIGlzIHJlcXVpcmVkXCIgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgfVxuXG4gIGxldCBwYXJzZWRVcmw6IFVSTDtcbiAgdHJ5IHtcbiAgICBwYXJzZWRVcmwgPSBuZXcgVVJMKGJvZHkuZ2F0ZXdheVVybCk7XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcImdhdGV3YXlVcmwgbXVzdCBiZSBhIHZhbGlkIFVSTFwiIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gIH1cblxuICBsZXQgYWdlbnRzOiBHYXRld2F5QWdlbnRbXTtcbiAgdHJ5IHtcbiAgICBhZ2VudHMgPSBhd2FpdCB2YWxpZGF0ZUdhdGV3YXlDb25uZWN0aW9uKHtcbiAgICAgIGdhdGV3YXlVcmw6IHBhcnNlZFVybC50b1N0cmluZygpLFxuICAgICAgYXBpS2V5OiBib2R5LmFwaUtleSxcbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zdCBtZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBcIkNvbm5lY3Rpb24gZmFpbGVkXCI7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IG1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMiB9KTtcbiAgfVxuXG4gIGNvbnN0IHVzZXJJZCA9IGNyeXB0by5yYW5kb21VVUlEKCk7XG4gIGNyZWF0ZVVzZXIoe1xuICAgIGlkOiB1c2VySWQsXG4gICAgYW5vbnltb3VzSWQ6IHVzZXJJZC5zbGljZSgwLCA2KSxcbiAgICBjbGFpbWVkOiBmYWxzZSxcbiAgICBzaGFyZUVuYWJsZWQ6IGZhbHNlLFxuICAgIGdhdGV3YXlVcmw6IHBhcnNlZFVybC50b1N0cmluZygpLFxuICAgIGdhdGV3YXlBcGlLZXk6IGJvZHkuYXBpS2V5ID8/IFwiXCIsXG4gICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gIH0pO1xuXG4gIGNvbnN0IGFub255bW91c1Rva2VuID0gaXNzdWVBbm9ueW1vdXNUb2tlbih1c2VySWQpO1xuXG4gIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgc3VjY2VzczogdHJ1ZSxcbiAgICBhZ2VudHMsXG4gICAgYW5vbnltb3VzVG9rZW4sXG4gIH0pO1xufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImNyZWF0ZVVzZXIiLCJ2YWxpZGF0ZUdhdGV3YXlDb25uZWN0aW9uIiwiaXNzdWVBbm9ueW1vdXNUb2tlbiIsIlBPU1QiLCJyZXF1ZXN0IiwiYm9keSIsImpzb24iLCJnYXRld2F5VXJsIiwiZXJyb3IiLCJzdGF0dXMiLCJwYXJzZWRVcmwiLCJVUkwiLCJhZ2VudHMiLCJ0b1N0cmluZyIsImFwaUtleSIsIm1lc3NhZ2UiLCJFcnJvciIsInVzZXJJZCIsImNyeXB0byIsInJhbmRvbVVVSUQiLCJpZCIsImFub255bW91c0lkIiwic2xpY2UiLCJjbGFpbWVkIiwic2hhcmVFbmFibGVkIiwiZ2F0ZXdheUFwaUtleSIsImNyZWF0ZWRBdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImFub255bW91c1Rva2VuIiwic3VjY2VzcyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/connect/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/data/store.ts":
/*!***************************!*\
  !*** ./lib/data/store.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createUser: () => (/* binding */ createUser),\n/* harmony export */   getLeaderboard: () => (/* binding */ getLeaderboard),\n/* harmony export */   getUserById: () => (/* binding */ getUserById),\n/* harmony export */   listUsers: () => (/* binding */ listUsers),\n/* harmony export */   saveUserStats: () => (/* binding */ saveUserStats),\n/* harmony export */   updateUser: () => (/* binding */ updateUser)\n/* harmony export */ });\nconst getStore = ()=>{\n    if (!globalThis.__clawboardStore) {\n        globalThis.__clawboardStore = {\n            users: new Map()\n        };\n    }\n    return globalThis.__clawboardStore;\n};\nconst createUser = (user)=>{\n    getStore().users.set(user.id, user);\n    return user;\n};\nconst getUserById = (userId)=>getStore().users.get(userId);\nconst updateUser = (userId, partial)=>{\n    const store = getStore();\n    const current = store.users.get(userId);\n    if (!current) {\n        return null;\n    }\n    const updated = {\n        ...current,\n        ...partial\n    };\n    store.users.set(userId, updated);\n    return updated;\n};\nconst saveUserStats = (userId, stats)=>{\n    return updateUser(userId, {\n        stats\n    });\n};\nconst metricValue = (user, category, period)=>{\n    if (!user.stats) {\n        return 0;\n    }\n    if (category === \"streak\") {\n        return user.stats.streak;\n    }\n    const scoped = user.stats.periods[period];\n    switch(category){\n        case \"tokens\":\n            return scoped.tokens;\n        case \"cost\":\n            return scoped.cost;\n        case \"messages\":\n            return scoped.messages;\n        case \"sessions\":\n            return scoped.sessions;\n        default:\n            return 0;\n    }\n};\nconst getLeaderboard = (category, period)=>{\n    const users = Array.from(getStore().users.values()).filter((user)=>user.shareEnabled && user.stats);\n    return users.map((user)=>({\n            anonymousId: user.anonymousId,\n            value: metricValue(user, category, period),\n            claimed: user.claimed,\n            identity: user.identity\n        })).sort((left, right)=>right.value - left.value).slice(0, 100).map((entry, index)=>({\n            rank: index + 1,\n            ...entry\n        }));\n};\nconst listUsers = ()=>Array.from(getStore().users.values());\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZGF0YS9zdG9yZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFXQSxNQUFNQSxXQUFXO0lBQ2YsSUFBSSxDQUFDQyxXQUFXQyxnQkFBZ0IsRUFBRTtRQUNoQ0QsV0FBV0MsZ0JBQWdCLEdBQUc7WUFDNUJDLE9BQU8sSUFBSUM7UUFDYjtJQUNGO0lBRUEsT0FBT0gsV0FBV0MsZ0JBQWdCO0FBQ3BDO0FBRU8sTUFBTUcsYUFBYSxDQUFDQztJQUN6Qk4sV0FBV0csS0FBSyxDQUFDSSxHQUFHLENBQUNELEtBQUtFLEVBQUUsRUFBRUY7SUFDOUIsT0FBT0E7QUFDVCxFQUFFO0FBRUssTUFBTUcsY0FBYyxDQUFDQyxTQUEyQ1YsV0FBV0csS0FBSyxDQUFDUSxHQUFHLENBQUNELFFBQVE7QUFFN0YsTUFBTUUsYUFBYSxDQUFDRixRQUFnQkc7SUFDekMsTUFBTUMsUUFBUWQ7SUFDZCxNQUFNZSxVQUFVRCxNQUFNWCxLQUFLLENBQUNRLEdBQUcsQ0FBQ0Q7SUFDaEMsSUFBSSxDQUFDSyxTQUFTO1FBQ1osT0FBTztJQUNUO0lBRUEsTUFBTUMsVUFBc0I7UUFDMUIsR0FBR0QsT0FBTztRQUNWLEdBQUdGLE9BQU87SUFDWjtJQUNBQyxNQUFNWCxLQUFLLENBQUNJLEdBQUcsQ0FBQ0csUUFBUU07SUFDeEIsT0FBT0E7QUFDVCxFQUFFO0FBRUssTUFBTUMsZ0JBQWdCLENBQUNQLFFBQWdCUTtJQUM1QyxPQUFPTixXQUFXRixRQUFRO1FBQUVRO0lBQU07QUFDcEMsRUFBRTtBQUVGLE1BQU1DLGNBQWMsQ0FDbEJiLE1BQ0FjLFVBQ0FDO0lBRUEsSUFBSSxDQUFDZixLQUFLWSxLQUFLLEVBQUU7UUFDZixPQUFPO0lBQ1Q7SUFFQSxJQUFJRSxhQUFhLFVBQVU7UUFDekIsT0FBT2QsS0FBS1ksS0FBSyxDQUFDSSxNQUFNO0lBQzFCO0lBRUEsTUFBTUMsU0FBU2pCLEtBQUtZLEtBQUssQ0FBQ00sT0FBTyxDQUFDSCxPQUFPO0lBQ3pDLE9BQVFEO1FBQ04sS0FBSztZQUNILE9BQU9HLE9BQU9FLE1BQU07UUFDdEIsS0FBSztZQUNILE9BQU9GLE9BQU9HLElBQUk7UUFDcEIsS0FBSztZQUNILE9BQU9ILE9BQU9JLFFBQVE7UUFDeEIsS0FBSztZQUNILE9BQU9KLE9BQU9LLFFBQVE7UUFDeEI7WUFDRSxPQUFPO0lBQ1g7QUFDRjtBQUVPLE1BQU1DLGlCQUFpQixDQUM1QlQsVUFDQUM7SUFFQSxNQUFNbEIsUUFBUTJCLE1BQU1DLElBQUksQ0FBQy9CLFdBQVdHLEtBQUssQ0FBQzZCLE1BQU0sSUFBSUMsTUFBTSxDQUFDLENBQUMzQixPQUFTQSxLQUFLNEIsWUFBWSxJQUFJNUIsS0FBS1ksS0FBSztJQUVwRyxPQUFPZixNQUNKZ0MsR0FBRyxDQUFDLENBQUM3QixPQUFVO1lBQ2Q4QixhQUFhOUIsS0FBSzhCLFdBQVc7WUFDN0JDLE9BQU9sQixZQUFZYixNQUFNYyxVQUFVQztZQUNuQ2lCLFNBQVNoQyxLQUFLZ0MsT0FBTztZQUNyQkMsVUFBVWpDLEtBQUtpQyxRQUFRO1FBQ3pCLElBQ0NDLElBQUksQ0FBQyxDQUFDQyxNQUFNQyxRQUFVQSxNQUFNTCxLQUFLLEdBQUdJLEtBQUtKLEtBQUssRUFDOUNNLEtBQUssQ0FBQyxHQUFHLEtBQ1RSLEdBQUcsQ0FBQyxDQUFDUyxPQUFPQyxRQUFXO1lBQ3RCQyxNQUFNRCxRQUFRO1lBQ2QsR0FBR0QsS0FBSztRQUNWO0FBQ0osRUFBRTtBQUVLLE1BQU1HLFlBQVksSUFBb0JqQixNQUFNQyxJQUFJLENBQUMvQixXQUFXRyxLQUFLLENBQUM2QixNQUFNLElBQUkiLCJzb3VyY2VzIjpbIi9Vc2Vycy9lbGlhc3N0ZXZlbnNvbi9EZXNrdG9wL1Byb2plY3RzL2NsYXdib2FyZC9saWIvZGF0YS9zdG9yZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBMZWFkZXJib2FyZENhdGVnb3J5LCBMZWFkZXJib2FyZEVudHJ5LCBMZWFkZXJib2FyZFBlcmlvZCwgVXNlclJlY29yZCwgVXNhZ2VTdGF0cyB9IGZyb20gXCJAL2xpYi90eXBlc1wiO1xuXG5pbnRlcmZhY2UgQ2xhd2JvYXJkU3RvcmUge1xuICB1c2VyczogTWFwPHN0cmluZywgVXNlclJlY29yZD47XG59XG5cbmRlY2xhcmUgZ2xvYmFsIHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXZhclxuICB2YXIgX19jbGF3Ym9hcmRTdG9yZTogQ2xhd2JvYXJkU3RvcmUgfCB1bmRlZmluZWQ7XG59XG5cbmNvbnN0IGdldFN0b3JlID0gKCk6IENsYXdib2FyZFN0b3JlID0+IHtcbiAgaWYgKCFnbG9iYWxUaGlzLl9fY2xhd2JvYXJkU3RvcmUpIHtcbiAgICBnbG9iYWxUaGlzLl9fY2xhd2JvYXJkU3RvcmUgPSB7XG4gICAgICB1c2VyczogbmV3IE1hcDxzdHJpbmcsIFVzZXJSZWNvcmQ+KCksXG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiBnbG9iYWxUaGlzLl9fY2xhd2JvYXJkU3RvcmU7XG59O1xuXG5leHBvcnQgY29uc3QgY3JlYXRlVXNlciA9ICh1c2VyOiBVc2VyUmVjb3JkKTogVXNlclJlY29yZCA9PiB7XG4gIGdldFN0b3JlKCkudXNlcnMuc2V0KHVzZXIuaWQsIHVzZXIpO1xuICByZXR1cm4gdXNlcjtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRVc2VyQnlJZCA9ICh1c2VySWQ6IHN0cmluZyk6IFVzZXJSZWNvcmQgfCB1bmRlZmluZWQgPT4gZ2V0U3RvcmUoKS51c2Vycy5nZXQodXNlcklkKTtcblxuZXhwb3J0IGNvbnN0IHVwZGF0ZVVzZXIgPSAodXNlcklkOiBzdHJpbmcsIHBhcnRpYWw6IFBhcnRpYWw8VXNlclJlY29yZD4pOiBVc2VyUmVjb3JkIHwgbnVsbCA9PiB7XG4gIGNvbnN0IHN0b3JlID0gZ2V0U3RvcmUoKTtcbiAgY29uc3QgY3VycmVudCA9IHN0b3JlLnVzZXJzLmdldCh1c2VySWQpO1xuICBpZiAoIWN1cnJlbnQpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGNvbnN0IHVwZGF0ZWQ6IFVzZXJSZWNvcmQgPSB7XG4gICAgLi4uY3VycmVudCxcbiAgICAuLi5wYXJ0aWFsLFxuICB9O1xuICBzdG9yZS51c2Vycy5zZXQodXNlcklkLCB1cGRhdGVkKTtcbiAgcmV0dXJuIHVwZGF0ZWQ7XG59O1xuXG5leHBvcnQgY29uc3Qgc2F2ZVVzZXJTdGF0cyA9ICh1c2VySWQ6IHN0cmluZywgc3RhdHM6IFVzYWdlU3RhdHMpOiBVc2VyUmVjb3JkIHwgbnVsbCA9PiB7XG4gIHJldHVybiB1cGRhdGVVc2VyKHVzZXJJZCwgeyBzdGF0cyB9KTtcbn07XG5cbmNvbnN0IG1ldHJpY1ZhbHVlID0gKFxuICB1c2VyOiBVc2VyUmVjb3JkLFxuICBjYXRlZ29yeTogTGVhZGVyYm9hcmRDYXRlZ29yeSxcbiAgcGVyaW9kOiBMZWFkZXJib2FyZFBlcmlvZCxcbik6IG51bWJlciA9PiB7XG4gIGlmICghdXNlci5zdGF0cykge1xuICAgIHJldHVybiAwO1xuICB9XG5cbiAgaWYgKGNhdGVnb3J5ID09PSBcInN0cmVha1wiKSB7XG4gICAgcmV0dXJuIHVzZXIuc3RhdHMuc3RyZWFrO1xuICB9XG5cbiAgY29uc3Qgc2NvcGVkID0gdXNlci5zdGF0cy5wZXJpb2RzW3BlcmlvZF07XG4gIHN3aXRjaCAoY2F0ZWdvcnkpIHtcbiAgICBjYXNlIFwidG9rZW5zXCI6XG4gICAgICByZXR1cm4gc2NvcGVkLnRva2VucztcbiAgICBjYXNlIFwiY29zdFwiOlxuICAgICAgcmV0dXJuIHNjb3BlZC5jb3N0O1xuICAgIGNhc2UgXCJtZXNzYWdlc1wiOlxuICAgICAgcmV0dXJuIHNjb3BlZC5tZXNzYWdlcztcbiAgICBjYXNlIFwic2Vzc2lvbnNcIjpcbiAgICAgIHJldHVybiBzY29wZWQuc2Vzc2lvbnM7XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiAwO1xuICB9XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0TGVhZGVyYm9hcmQgPSAoXG4gIGNhdGVnb3J5OiBMZWFkZXJib2FyZENhdGVnb3J5LFxuICBwZXJpb2Q6IExlYWRlcmJvYXJkUGVyaW9kLFxuKTogTGVhZGVyYm9hcmRFbnRyeVtdID0+IHtcbiAgY29uc3QgdXNlcnMgPSBBcnJheS5mcm9tKGdldFN0b3JlKCkudXNlcnMudmFsdWVzKCkpLmZpbHRlcigodXNlcikgPT4gdXNlci5zaGFyZUVuYWJsZWQgJiYgdXNlci5zdGF0cyk7XG5cbiAgcmV0dXJuIHVzZXJzXG4gICAgLm1hcCgodXNlcikgPT4gKHtcbiAgICAgIGFub255bW91c0lkOiB1c2VyLmFub255bW91c0lkLFxuICAgICAgdmFsdWU6IG1ldHJpY1ZhbHVlKHVzZXIsIGNhdGVnb3J5LCBwZXJpb2QpLFxuICAgICAgY2xhaW1lZDogdXNlci5jbGFpbWVkLFxuICAgICAgaWRlbnRpdHk6IHVzZXIuaWRlbnRpdHksXG4gICAgfSkpXG4gICAgLnNvcnQoKGxlZnQsIHJpZ2h0KSA9PiByaWdodC52YWx1ZSAtIGxlZnQudmFsdWUpXG4gICAgLnNsaWNlKDAsIDEwMClcbiAgICAubWFwKChlbnRyeSwgaW5kZXgpID0+ICh7XG4gICAgICByYW5rOiBpbmRleCArIDEsXG4gICAgICAuLi5lbnRyeSxcbiAgICB9KSk7XG59O1xuXG5leHBvcnQgY29uc3QgbGlzdFVzZXJzID0gKCk6IFVzZXJSZWNvcmRbXSA9PiBBcnJheS5mcm9tKGdldFN0b3JlKCkudXNlcnMudmFsdWVzKCkpO1xuIl0sIm5hbWVzIjpbImdldFN0b3JlIiwiZ2xvYmFsVGhpcyIsIl9fY2xhd2JvYXJkU3RvcmUiLCJ1c2VycyIsIk1hcCIsImNyZWF0ZVVzZXIiLCJ1c2VyIiwic2V0IiwiaWQiLCJnZXRVc2VyQnlJZCIsInVzZXJJZCIsImdldCIsInVwZGF0ZVVzZXIiLCJwYXJ0aWFsIiwic3RvcmUiLCJjdXJyZW50IiwidXBkYXRlZCIsInNhdmVVc2VyU3RhdHMiLCJzdGF0cyIsIm1ldHJpY1ZhbHVlIiwiY2F0ZWdvcnkiLCJwZXJpb2QiLCJzdHJlYWsiLCJzY29wZWQiLCJwZXJpb2RzIiwidG9rZW5zIiwiY29zdCIsIm1lc3NhZ2VzIiwic2Vzc2lvbnMiLCJnZXRMZWFkZXJib2FyZCIsIkFycmF5IiwiZnJvbSIsInZhbHVlcyIsImZpbHRlciIsInNoYXJlRW5hYmxlZCIsIm1hcCIsImFub255bW91c0lkIiwidmFsdWUiLCJjbGFpbWVkIiwiaWRlbnRpdHkiLCJzb3J0IiwibGVmdCIsInJpZ2h0Iiwic2xpY2UiLCJlbnRyeSIsImluZGV4IiwicmFuayIsImxpc3RVc2VycyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/data/store.ts\n");

/***/ }),

/***/ "(rsc)/./lib/gateway/client.ts":
/*!*******************************!*\
  !*** ./lib/gateway/client.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   fetchGatewayStats: () => (/* binding */ fetchGatewayStats),\n/* harmony export */   validateGatewayConnection: () => (/* binding */ validateGatewayConnection)\n/* harmony export */ });\n/* harmony import */ var _lib_gateway_device_identity__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/gateway/device-identity */ \"(rsc)/./lib/gateway/device-identity.ts\");\n\nconst DEFAULT_TIMEOUT_MS = 10000;\nconst ALLOW_MOCK = process.env.CLAWBOARD_ALLOW_MOCK_STATS === \"true\";\nconst CLIENT_ID = \"gateway-client\";\nconst CLIENT_MODE = \"backend\";\nconst ROLE = \"operator\";\nconst SCOPES = [\n    \"operator.read\",\n    \"operator.write\",\n    \"operator.admin\"\n];\nconst normalizeGatewayUrl = (gatewayUrl)=>{\n    const trimmed = gatewayUrl.trim().replace(/\\/+$/, \"\");\n    if (/^wss?:\\/\\//i.test(trimmed)) {\n        return trimmed;\n    }\n    if (/^https?:\\/\\//i.test(trimmed)) {\n        const url = new URL(trimmed);\n        const protocol = url.protocol === \"https:\" ? \"wss:\" : \"ws:\";\n        return `${protocol}//${url.host}${url.pathname}`.replace(/\\/+$/, \"\");\n    }\n    return `ws://${trimmed}`;\n};\nconst createRequestId = (prefix)=>`${prefix}_${Date.now()}_${Math.random().toString(36).slice(2, 8)}`;\nconst toNumber = (value)=>typeof value === \"number\" && Number.isFinite(value) ? value : 0;\nconst isoDateFromTimestamp = (timestampMs)=>new Date(timestampMs).toISOString().slice(0, 10);\nconst rawFrameToText = (raw)=>{\n    if (typeof raw === \"string\") {\n        return raw;\n    }\n    if (Buffer.isBuffer(raw)) {\n        return raw.toString();\n    }\n    if (Array.isArray(raw) && raw.every((item)=>Buffer.isBuffer(item))) {\n        return Buffer.concat(raw).toString();\n    }\n    if (raw instanceof ArrayBuffer) {\n        return Buffer.from(raw).toString();\n    }\n    if (ArrayBuffer.isView(raw)) {\n        return Buffer.from(raw.buffer, raw.byteOffset, raw.byteLength).toString();\n    }\n    return String(raw);\n};\nconst totalsTokens = (totals)=>{\n    if (!totals) {\n        return 0;\n    }\n    const bucketTotal = toNumber(totals.input) + toNumber(totals.output) + toNumber(totals.cacheRead) + toNumber(totals.cacheWrite);\n    return bucketTotal > 0 ? bucketTotal : toNumber(totals.totalTokens);\n};\nconst totalsCost = (totals)=>{\n    if (!totals) {\n        return 0;\n    }\n    const bucketTotal = toNumber(totals.inputCost) + toNumber(totals.outputCost) + toNumber(totals.cacheReadCost) + toNumber(totals.cacheWriteCost);\n    return bucketTotal > 0 ? bucketTotal : toNumber(totals.totalCost);\n};\nconst sessionTokens = (session)=>toNumber(session.usage?.totalTokens ?? session.totalTokens);\nconst sessionCost = (session)=>toNumber(session.usage?.totalCost ?? session.totalCost);\nconst sessionMessages = (session)=>toNumber(session.usage?.messageCounts?.total ?? session.messages);\nconst sessionToolCalls = (session)=>toNumber(session.usage?.messageCounts?.toolCalls ?? session.usage?.toolUsage?.totalCalls);\nconst sessionActivityTimestamp = (session)=>toNumber(session.usage?.lastActivity ?? session.updatedAt);\nconst roundMoney = (value)=>Number(value.toFixed(2));\nconst todayIso = ()=>new Date().toISOString().slice(0, 10);\nconst shiftIsoDate = (isoDate, days)=>{\n    const base = new Date(`${isoDate}T00:00:00`);\n    base.setDate(base.getDate() + days);\n    return base.toISOString().slice(0, 10);\n};\nconst fallbackDailyFromSessions = (sessions)=>{\n    const byDate = new Map();\n    for (const session of sessions){\n        const timestamp = sessionActivityTimestamp(session);\n        if (!timestamp) {\n            continue;\n        }\n        const date = isoDateFromTimestamp(timestamp);\n        const current = byDate.get(date) ?? {\n            date,\n            tokens: 0,\n            cost: 0,\n            messages: 0\n        };\n        byDate.set(date, {\n            date,\n            tokens: current.tokens + sessionTokens(session),\n            cost: current.cost + sessionCost(session),\n            messages: current.messages + sessionMessages(session)\n        });\n    }\n    return [\n        ...byDate.values()\n    ].sort((left, right)=>left.date.localeCompare(right.date));\n};\nconst normalizeDailyUsage = (daily, sessions)=>{\n    if (daily && daily.length > 0) {\n        const mapped = daily.map((entry)=>({\n                date: entry.date,\n                tokens: toNumber(entry.tokens),\n                cost: toNumber(entry.cost),\n                messages: toNumber(entry.messages)\n            })).sort((left, right)=>left.date.localeCompare(right.date));\n        if (mapped.length > 0) {\n            return mapped;\n        }\n    }\n    return fallbackDailyFromSessions(sessions);\n};\nconst buildTopModels = (usage)=>{\n    const fromAggregates = usage.aggregates?.byModel?.map((entry)=>{\n        const modelName = [\n            entry.provider,\n            entry.model\n        ].filter(Boolean).join(\"/\") || \"unknown\";\n        return {\n            model: modelName,\n            tokens: Math.round(totalsTokens(entry.totals))\n        };\n    }).filter((entry)=>entry.tokens > 0).sort((left, right)=>right.tokens - left.tokens).slice(0, 5);\n    if (fromAggregates && fromAggregates.length > 0) {\n        return fromAggregates;\n    }\n    const byModel = new Map();\n    for (const session of usage.sessions){\n        const model = session.model || \"unknown\";\n        byModel.set(model, (byModel.get(model) ?? 0) + sessionTokens(session));\n    }\n    return [\n        ...byModel.entries()\n    ].map(([model, tokens])=>({\n            model,\n            tokens: Math.round(tokens)\n        })).sort((left, right)=>right.tokens - left.tokens).slice(0, 5);\n};\nconst buildTopTools = (usage)=>{\n    const fromAggregates = usage.aggregates?.tools?.tools?.map((tool)=>({\n            tool: tool.name || \"unknown\",\n            count: Math.round(toNumber(tool.count))\n        })).sort((left, right)=>right.count - left.count).slice(0, 5);\n    if (fromAggregates && fromAggregates.length > 0) {\n        return fromAggregates;\n    }\n    const byTool = new Map();\n    for (const session of usage.sessions){\n        const tools = session.usage?.toolUsage?.tools ?? [];\n        for (const tool of tools){\n            const name = tool.name || \"unknown\";\n            byTool.set(name, (byTool.get(name) ?? 0) + toNumber(tool.count));\n        }\n    }\n    if (byTool.size > 0) {\n        return [\n            ...byTool.entries()\n        ].map(([tool, count])=>({\n                tool,\n                count: Math.round(count)\n            })).sort((left, right)=>right.count - left.count).slice(0, 5);\n    }\n    return [\n        {\n            tool: \"tool_calls\",\n            count: usage.sessions.reduce((sum, session)=>sum + sessionToolCalls(session), 0)\n        }\n    ];\n};\nconst buildActivity = (daily)=>{\n    if (daily.length > 0) {\n        return daily.slice(-35).map((entry)=>({\n                date: entry.date,\n                messages: Math.round(entry.messages)\n            }));\n    }\n    const today = new Date();\n    return Array.from({\n        length: 35\n    }).map((_, index)=>{\n        const date = new Date(today);\n        date.setDate(today.getDate() - (34 - index));\n        return {\n            date: date.toISOString().slice(0, 10),\n            messages: 0\n        };\n    });\n};\nconst usageMessageCount = (usage, daily)=>toNumber(usage.aggregates?.messages?.total) || daily.reduce((sum, entry)=>sum + entry.messages, 0) || usage.sessions.reduce((sum, session)=>sum + sessionMessages(session), 0);\nconst toPeriodStat = (usage)=>{\n    const daily = normalizeDailyUsage(usage.aggregates?.daily, usage.sessions);\n    return {\n        tokens: Math.round(totalsTokens(usage.totals)),\n        cost: roundMoney(totalsCost(usage.totals)),\n        messages: Math.round(usageMessageCount(usage, daily)),\n        sessions: usage.sessions.length\n    };\n};\nconst fetchUsageSnapshot = async (input, params)=>{\n    const usage = await gatewayRequest(input, \"sessions.usage\", params);\n    if (!usage || !Array.isArray(usage.sessions) || !usage.totals) {\n        throw new Error(\"sessions.usage response is missing expected fields.\");\n    }\n    return usage;\n};\nconst buildConnectParams = async (input)=>{\n    const identity = await (0,_lib_gateway_device_identity__WEBPACK_IMPORTED_MODULE_0__.getOrCreateDeviceIdentity)();\n    const token = input.apiKey ?? \"\";\n    const device = await (0,_lib_gateway_device_identity__WEBPACK_IMPORTED_MODULE_0__.signConnectChallenge)({\n        identity,\n        clientId: CLIENT_ID,\n        clientMode: CLIENT_MODE,\n        role: ROLE,\n        scopes: SCOPES,\n        token\n    });\n    return {\n        minProtocol: 3,\n        maxProtocol: 3,\n        client: {\n            id: CLIENT_ID,\n            displayName: \"ClawBoard\",\n            version: \"0.1.0\",\n            platform: \"node\",\n            mode: CLIENT_MODE,\n            instanceId: `clawboard-${process.pid}`\n        },\n        role: ROLE,\n        scopes: SCOPES,\n        device,\n        ...token ? {\n            auth: {\n                token\n            }\n        } : {}\n    };\n};\nconst gatewayRequest = async (input, method, params, timeoutMs = DEFAULT_TIMEOUT_MS)=>{\n    process.env.WS_NO_BUFFER_UTIL = \"1\";\n    process.env.WS_NO_UTF_8_VALIDATE = \"1\";\n    const wsModule = await Promise.all(/*! import() */[__webpack_require__.e(\"vendor-chunks/ws\"), __webpack_require__.e(\"_32c4-_66e9\")]).then(__webpack_require__.bind(__webpack_require__, /*! ws */ \"(rsc)/./node_modules/ws/wrapper.mjs\"));\n    const WebSocket = wsModule.default;\n    const connectParams = await buildConnectParams(input);\n    const wsUrl = normalizeGatewayUrl(input.gatewayUrl);\n    return new Promise((resolve, reject)=>{\n        const connectId = createRequestId(\"connect\");\n        const requestId = createRequestId(\"req\");\n        let settled = false;\n        let handshakeComplete = false;\n        const ws = new WebSocket(wsUrl);\n        const settle = (callback)=>{\n            if (settled) {\n                return;\n            }\n            settled = true;\n            clearTimeout(timer);\n            callback();\n        };\n        const timer = setTimeout(()=>{\n            settle(()=>{\n                try {\n                    ws.close();\n                } catch  {\n                // ignore close failures on timeout\n                }\n                reject(new Error(`Gateway request timed out after ${timeoutMs}ms`));\n            });\n        }, timeoutMs);\n        ws.on(\"open\", ()=>{\n            ws.send(JSON.stringify({\n                type: \"req\",\n                id: connectId,\n                method: \"connect\",\n                params: connectParams\n            }));\n        });\n        ws.on(\"message\", (raw)=>{\n            if (settled) {\n                return;\n            }\n            let frame;\n            try {\n                frame = JSON.parse(rawFrameToText(raw));\n            } catch  {\n                return;\n            }\n            if (frame.type !== \"res\") {\n                return;\n            }\n            if (!handshakeComplete && frame.id === connectId) {\n                if (frame.error) {\n                    const handshakeError = frame.error;\n                    settle(()=>reject(new Error(`Gateway handshake failed: ${handshakeError.message}`)));\n                    return;\n                }\n                handshakeComplete = true;\n                ws.send(JSON.stringify({\n                    type: \"req\",\n                    id: requestId,\n                    method,\n                    ...params ? {\n                        params\n                    } : {}\n                }));\n                return;\n            }\n            if (handshakeComplete && frame.id === requestId) {\n                settle(()=>{\n                    try {\n                        ws.close();\n                    } catch  {\n                    // ignore close failures after response\n                    }\n                    if (frame.error) {\n                        const requestError = frame.error;\n                        reject(new Error(`Gateway error [${requestError.code}]: ${requestError.message}`));\n                        return;\n                    }\n                    resolve(frame.payload ?? frame.result);\n                });\n            }\n        });\n        ws.on(\"error\", (error)=>{\n            settle(()=>{\n                reject(new Error(`Gateway connection error: ${error.message}`));\n            });\n        });\n        ws.on(\"close\", ()=>{\n            if (settled) {\n                return;\n            }\n            settle(()=>{\n                reject(new Error(\"Gateway connection closed unexpectedly\"));\n            });\n        });\n    });\n};\nconst deterministicNumber = (input, min, max)=>{\n    let hash = 0;\n    for(let index = 0; index < input.length; index += 1){\n        hash = (hash * 31 + input.charCodeAt(index)) % 2147483647;\n    }\n    const span = max - min;\n    return min + hash % (span + 1);\n};\nconst generateFallbackStats = (seed)=>{\n    const totalTokens = deterministicNumber(`${seed}:tokens`, 50000, 2000000);\n    const messageCount = deterministicNumber(`${seed}:messages`, 300, 9000);\n    const sessionCount = deterministicNumber(`${seed}:sessions`, 20, 900);\n    const totalCost = Number((totalTokens / 1000000 * 2.4).toFixed(2));\n    const topModels = [\n        {\n            model: \"claude-sonnet\",\n            tokens: Math.floor(totalTokens * 0.42)\n        },\n        {\n            model: \"gpt-4o\",\n            tokens: Math.floor(totalTokens * 0.31)\n        },\n        {\n            model: \"o3-mini\",\n            tokens: Math.floor(totalTokens * 0.17)\n        },\n        {\n            model: \"llama-3.3\",\n            tokens: Math.floor(totalTokens * 0.1)\n        }\n    ];\n    const topTools = [\n        {\n            tool: \"exec\",\n            count: Math.floor(messageCount * 0.35)\n        },\n        {\n            tool: \"web.search\",\n            count: Math.floor(messageCount * 0.2)\n        },\n        {\n            tool: \"read_file\",\n            count: Math.floor(messageCount * 0.18)\n        },\n        {\n            tool: \"write_file\",\n            count: Math.floor(messageCount * 0.13)\n        },\n        {\n            tool: \"git\",\n            count: Math.floor(messageCount * 0.1)\n        }\n    ];\n    const today = new Date();\n    const activity = Array.from({\n        length: 35\n    }).map((_, index)=>{\n        const date = new Date(today);\n        date.setDate(today.getDate() - (34 - index));\n        const daySeed = deterministicNumber(`${seed}:${date.toISOString().slice(0, 10)}`, 0, 50);\n        return {\n            date: date.toISOString().slice(0, 10),\n            messages: daySeed\n        };\n    });\n    return {\n        totalTokens,\n        totalCost,\n        messageCount,\n        sessionCount,\n        topModels,\n        topTools,\n        activity\n    };\n};\nconst unwrapAgents = (payload)=>{\n    const rawAgents = payload && typeof payload === \"object\" && \"agents\" in payload && Array.isArray(payload.agents) ? payload.agents : Array.isArray(payload) ? payload : [];\n    return rawAgents.filter((agent)=>Boolean(agent) && typeof agent === \"object\").map((agent)=>{\n        const id = typeof agent.id === \"string\" ? agent.id : \"agent:unknown\";\n        const name = typeof agent.name === \"string\" && agent.name.length > 0 ? agent.name : id;\n        return {\n            id,\n            name,\n            status: \"active\"\n        };\n    });\n};\nconst validateGatewayConnection = async (input)=>{\n    try {\n        const result = await gatewayRequest(input, \"agents.list\");\n        const agents = unwrapAgents(result);\n        if (agents.length > 0) {\n            return agents;\n        }\n        throw new Error(\"Gateway returned an empty agents list.\");\n    } catch (error) {\n        if (ALLOW_MOCK) {\n            return [\n                {\n                    id: \"agent:main\",\n                    name: \"Main Agent\",\n                    status: \"active\"\n                }\n            ];\n        }\n        const message = error instanceof Error ? error.message : \"Unknown gateway error\";\n        throw new Error(`Unable to connect to gateway: ${message}`);\n    }\n};\nconst fetchGatewayStats = async (input)=>{\n    try {\n        const endDate = todayIso();\n        const startDate24h = endDate;\n        const startDate7d = shiftIsoDate(endDate, -6);\n        const startDate30d = shiftIsoDate(endDate, -29);\n        const startDateAll = process.env.CLAWBOARD_ALL_TIME_START_DATE || \"1970-01-01\";\n        const [usageAll, usage24h, usage7d, usage30d] = await Promise.all([\n            fetchUsageSnapshot(input, {\n                startDate: startDateAll,\n                endDate,\n                limit: 100000\n            }),\n            fetchUsageSnapshot(input, {\n                startDate: startDate24h,\n                endDate,\n                limit: 20000\n            }),\n            fetchUsageSnapshot(input, {\n                startDate: startDate7d,\n                endDate,\n                limit: 20000\n            }),\n            fetchUsageSnapshot(input, {\n                startDate: startDate30d,\n                endDate,\n                limit: 20000\n            })\n        ]);\n        const periods = {\n            \"24h\": toPeriodStat(usage24h),\n            \"7d\": toPeriodStat(usage7d),\n            \"30d\": toPeriodStat(usage30d),\n            all: toPeriodStat(usageAll)\n        };\n        const daily = normalizeDailyUsage(usage30d.aggregates?.daily, usage30d.sessions);\n        return {\n            totalTokens: periods.all.tokens,\n            totalCost: periods.all.cost,\n            messageCount: periods.all.messages,\n            sessionCount: periods.all.sessions,\n            topModels: buildTopModels(usageAll),\n            topTools: buildTopTools(usageAll),\n            activity: buildActivity(daily),\n            periods\n        };\n    } catch (error) {\n        if (ALLOW_MOCK) {\n            return generateFallbackStats(`${input.gatewayUrl}:${input.apiKey ?? \"\"}`);\n        }\n        const message = error instanceof Error ? error.message : \"Unknown gateway error\";\n        throw new Error(`Unable to fetch usage from gateway: ${message}`);\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFTWSxPQUFPO1lBQU87U0FDN0U7UUFFRCxNQUFNQyxVQUFVO1lBQ2QsT0FBT2pHLGFBQWEyRjtZQUNwQixNQUFNM0YsYUFBYTRGO1lBQ25CLE9BQU81RixhQUFhNkY7WUFDcEJDLEtBQUs5RixhQUFhMEY7UUFDcEI7UUFFQSxNQUFNekgsUUFBUUQsb0JBQW9CNkgsU0FBU3JILFVBQVUsRUFBRVAsT0FBTzRILFNBQVM1SSxRQUFRO1FBRS9FLE9BQU87WUFDTGhDLGFBQWFnTCxRQUFRSCxHQUFHLENBQUN0SSxNQUFNO1lBQy9CakMsV0FBVzBLLFFBQVFILEdBQUcsQ0FBQ3JJLElBQUk7WUFDM0I2RyxjQUFjMkIsUUFBUUgsR0FBRyxDQUFDL0osUUFBUTtZQUNsQ3dJLGNBQWMwQixRQUFRSCxHQUFHLENBQUM3SSxRQUFRO1lBQ2xDdUgsV0FBV2xHLGVBQWVvSDtZQUMxQmhCLFVBQVV4RixjQUFjd0c7WUFDeEJmLFVBQVVoRixjQUFjMUI7WUFDeEJnSTtRQUNGO0lBQ0YsRUFBRSxPQUFPMUMsT0FBTztRQUNkLElBQUkvTCxZQUFZO1lBQ2QsT0FBTzRNLHNCQUFzQixHQUFHdkosTUFBTTVDLFVBQVUsQ0FBQyxDQUFDLEVBQUU0QyxNQUFNMkYsTUFBTSxJQUFJLElBQUk7UUFDMUU7UUFFQSxNQUFNaUQsVUFBVUYsaUJBQWlCbkQsUUFBUW1ELE1BQU1FLE9BQU8sR0FBRztRQUN6RCxNQUFNLElBQUlyRCxNQUFNLENBQUMsb0NBQW9DLEVBQUVxRCxTQUFTO0lBQ2xFO0FBQ0YsRUFBRSIsInNvdXJjZXMiOlsiL1VzZXJzL2VsaWFzc3RldmVuc29uL0Rlc2t0b3AvUHJvamVjdHMvY2xhd2JvYXJkL2xpYi9nYXRld2F5L2NsaWVudC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXRPckNyZWF0ZURldmljZUlkZW50aXR5LCBzaWduQ29ubmVjdENoYWxsZW5nZSB9IGZyb20gXCJAL2xpYi9nYXRld2F5L2RldmljZS1pZGVudGl0eVwiO1xuaW1wb3J0IHtcbiAgR2F0ZXdheUFnZW50LFxuICBHYXRld2F5Q29ubmVjdGlvbklucHV0LFxuICBHYXRld2F5RnJhbWUsXG4gIEdhdGV3YXlSYXdTdGF0cyxcbiAgR2F0ZXdheVVzYWdlRGFpbHksXG4gIEdhdGV3YXlVc2FnZVJlc3BvbnNlLFxuICBHYXRld2F5VXNhZ2VTZXNzaW9uLFxuICBHYXRld2F5VXNhZ2VUb3RhbHMsXG59IGZyb20gXCJAL2xpYi9nYXRld2F5L3R5cGVzXCI7XG5pbXBvcnQgeyBQZXJpb2RTdGF0LCBUb3BNb2RlbCwgVG9wVG9vbCB9IGZyb20gXCJAL2xpYi90eXBlc1wiO1xuXG5jb25zdCBERUZBVUxUX1RJTUVPVVRfTVMgPSAxMF8wMDA7XG5jb25zdCBBTExPV19NT0NLID0gcHJvY2Vzcy5lbnYuQ0xBV0JPQVJEX0FMTE9XX01PQ0tfU1RBVFMgPT09IFwidHJ1ZVwiO1xuXG5jb25zdCBDTElFTlRfSUQgPSBcImdhdGV3YXktY2xpZW50XCI7XG5jb25zdCBDTElFTlRfTU9ERSA9IFwiYmFja2VuZFwiO1xuY29uc3QgUk9MRSA9IFwib3BlcmF0b3JcIjtcbmNvbnN0IFNDT1BFUzogUmVhZG9ubHlBcnJheTxzdHJpbmc+ID0gW1wib3BlcmF0b3IucmVhZFwiLCBcIm9wZXJhdG9yLndyaXRlXCIsIFwib3BlcmF0b3IuYWRtaW5cIl07XG5cbmNvbnN0IG5vcm1hbGl6ZUdhdGV3YXlVcmwgPSAoZ2F0ZXdheVVybDogc3RyaW5nKTogc3RyaW5nID0+IHtcbiAgY29uc3QgdHJpbW1lZCA9IGdhdGV3YXlVcmwudHJpbSgpLnJlcGxhY2UoL1xcLyskLywgXCJcIik7XG5cbiAgaWYgKC9ed3NzPzpcXC9cXC8vaS50ZXN0KHRyaW1tZWQpKSB7XG4gICAgcmV0dXJuIHRyaW1tZWQ7XG4gIH1cblxuICBpZiAoL15odHRwcz86XFwvXFwvL2kudGVzdCh0cmltbWVkKSkge1xuICAgIGNvbnN0IHVybCA9IG5ldyBVUkwodHJpbW1lZCk7XG4gICAgY29uc3QgcHJvdG9jb2wgPSB1cmwucHJvdG9jb2wgPT09IFwiaHR0cHM6XCIgPyBcIndzczpcIiA6IFwid3M6XCI7XG4gICAgcmV0dXJuIGAke3Byb3RvY29sfS8vJHt1cmwuaG9zdH0ke3VybC5wYXRobmFtZX1gLnJlcGxhY2UoL1xcLyskLywgXCJcIik7XG4gIH1cblxuICByZXR1cm4gYHdzOi8vJHt0cmltbWVkfWA7XG59O1xuXG5jb25zdCBjcmVhdGVSZXF1ZXN0SWQgPSAocHJlZml4OiBzdHJpbmcpOiBzdHJpbmcgPT5cbiAgYCR7cHJlZml4fV8ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc2xpY2UoMiwgOCl9YDtcblxuY29uc3QgdG9OdW1iZXIgPSAodmFsdWU6IHVua25vd24pOiBudW1iZXIgPT4gKHR5cGVvZiB2YWx1ZSA9PT0gXCJudW1iZXJcIiAmJiBOdW1iZXIuaXNGaW5pdGUodmFsdWUpID8gdmFsdWUgOiAwKTtcblxuY29uc3QgaXNvRGF0ZUZyb21UaW1lc3RhbXAgPSAodGltZXN0YW1wTXM6IG51bWJlcik6IHN0cmluZyA9PiBuZXcgRGF0ZSh0aW1lc3RhbXBNcykudG9JU09TdHJpbmcoKS5zbGljZSgwLCAxMCk7XG5cbmNvbnN0IHJhd0ZyYW1lVG9UZXh0ID0gKHJhdzogdW5rbm93bik6IHN0cmluZyA9PiB7XG4gIGlmICh0eXBlb2YgcmF3ID09PSBcInN0cmluZ1wiKSB7XG4gICAgcmV0dXJuIHJhdztcbiAgfVxuXG4gIGlmIChCdWZmZXIuaXNCdWZmZXIocmF3KSkge1xuICAgIHJldHVybiByYXcudG9TdHJpbmcoKTtcbiAgfVxuXG4gIGlmIChBcnJheS5pc0FycmF5KHJhdykgJiYgcmF3LmV2ZXJ5KChpdGVtKSA9PiBCdWZmZXIuaXNCdWZmZXIoaXRlbSkpKSB7XG4gICAgcmV0dXJuIEJ1ZmZlci5jb25jYXQocmF3KS50b1N0cmluZygpO1xuICB9XG5cbiAgaWYgKHJhdyBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgcmV0dXJuIEJ1ZmZlci5mcm9tKHJhdykudG9TdHJpbmcoKTtcbiAgfVxuXG4gIGlmIChBcnJheUJ1ZmZlci5pc1ZpZXcocmF3KSkge1xuICAgIHJldHVybiBCdWZmZXIuZnJvbShyYXcuYnVmZmVyLCByYXcuYnl0ZU9mZnNldCwgcmF3LmJ5dGVMZW5ndGgpLnRvU3RyaW5nKCk7XG4gIH1cblxuICByZXR1cm4gU3RyaW5nKHJhdyk7XG59O1xuXG5jb25zdCB0b3RhbHNUb2tlbnMgPSAodG90YWxzPzogR2F0ZXdheVVzYWdlVG90YWxzKTogbnVtYmVyID0+IHtcbiAgaWYgKCF0b3RhbHMpIHtcbiAgICByZXR1cm4gMDtcbiAgfVxuXG4gIGNvbnN0IGJ1Y2tldFRvdGFsID1cbiAgICB0b051bWJlcih0b3RhbHMuaW5wdXQpICsgdG9OdW1iZXIodG90YWxzLm91dHB1dCkgKyB0b051bWJlcih0b3RhbHMuY2FjaGVSZWFkKSArIHRvTnVtYmVyKHRvdGFscy5jYWNoZVdyaXRlKTtcbiAgcmV0dXJuIGJ1Y2tldFRvdGFsID4gMCA/IGJ1Y2tldFRvdGFsIDogdG9OdW1iZXIodG90YWxzLnRvdGFsVG9rZW5zKTtcbn07XG5cbmNvbnN0IHRvdGFsc0Nvc3QgPSAodG90YWxzPzogR2F0ZXdheVVzYWdlVG90YWxzKTogbnVtYmVyID0+IHtcbiAgaWYgKCF0b3RhbHMpIHtcbiAgICByZXR1cm4gMDtcbiAgfVxuXG4gIGNvbnN0IGJ1Y2tldFRvdGFsID1cbiAgICB0b051bWJlcih0b3RhbHMuaW5wdXRDb3N0KSArXG4gICAgdG9OdW1iZXIodG90YWxzLm91dHB1dENvc3QpICtcbiAgICB0b051bWJlcih0b3RhbHMuY2FjaGVSZWFkQ29zdCkgK1xuICAgIHRvTnVtYmVyKHRvdGFscy5jYWNoZVdyaXRlQ29zdCk7XG4gIHJldHVybiBidWNrZXRUb3RhbCA+IDAgPyBidWNrZXRUb3RhbCA6IHRvTnVtYmVyKHRvdGFscy50b3RhbENvc3QpO1xufTtcblxuY29uc3Qgc2Vzc2lvblRva2VucyA9IChzZXNzaW9uOiBHYXRld2F5VXNhZ2VTZXNzaW9uKTogbnVtYmVyID0+XG4gIHRvTnVtYmVyKHNlc3Npb24udXNhZ2U/LnRvdGFsVG9rZW5zID8/IHNlc3Npb24udG90YWxUb2tlbnMpO1xuXG5jb25zdCBzZXNzaW9uQ29zdCA9IChzZXNzaW9uOiBHYXRld2F5VXNhZ2VTZXNzaW9uKTogbnVtYmVyID0+XG4gIHRvTnVtYmVyKHNlc3Npb24udXNhZ2U/LnRvdGFsQ29zdCA/PyBzZXNzaW9uLnRvdGFsQ29zdCk7XG5cbmNvbnN0IHNlc3Npb25NZXNzYWdlcyA9IChzZXNzaW9uOiBHYXRld2F5VXNhZ2VTZXNzaW9uKTogbnVtYmVyID0+XG4gIHRvTnVtYmVyKHNlc3Npb24udXNhZ2U/Lm1lc3NhZ2VDb3VudHM/LnRvdGFsID8/IHNlc3Npb24ubWVzc2FnZXMpO1xuXG5jb25zdCBzZXNzaW9uVG9vbENhbGxzID0gKHNlc3Npb246IEdhdGV3YXlVc2FnZVNlc3Npb24pOiBudW1iZXIgPT5cbiAgdG9OdW1iZXIoc2Vzc2lvbi51c2FnZT8ubWVzc2FnZUNvdW50cz8udG9vbENhbGxzID8/IHNlc3Npb24udXNhZ2U/LnRvb2xVc2FnZT8udG90YWxDYWxscyk7XG5cbmNvbnN0IHNlc3Npb25BY3Rpdml0eVRpbWVzdGFtcCA9IChzZXNzaW9uOiBHYXRld2F5VXNhZ2VTZXNzaW9uKTogbnVtYmVyID0+XG4gIHRvTnVtYmVyKHNlc3Npb24udXNhZ2U/Lmxhc3RBY3Rpdml0eSA/PyBzZXNzaW9uLnVwZGF0ZWRBdCk7XG5cbmNvbnN0IHJvdW5kTW9uZXkgPSAodmFsdWU6IG51bWJlcik6IG51bWJlciA9PiBOdW1iZXIodmFsdWUudG9GaXhlZCgyKSk7XG5jb25zdCB0b2RheUlzbyA9ICgpOiBzdHJpbmcgPT4gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNsaWNlKDAsIDEwKTtcbmNvbnN0IHNoaWZ0SXNvRGF0ZSA9IChpc29EYXRlOiBzdHJpbmcsIGRheXM6IG51bWJlcik6IHN0cmluZyA9PiB7XG4gIGNvbnN0IGJhc2UgPSBuZXcgRGF0ZShgJHtpc29EYXRlfVQwMDowMDowMGApO1xuICBiYXNlLnNldERhdGUoYmFzZS5nZXREYXRlKCkgKyBkYXlzKTtcbiAgcmV0dXJuIGJhc2UudG9JU09TdHJpbmcoKS5zbGljZSgwLCAxMCk7XG59O1xuXG5pbnRlcmZhY2UgRGFpbHlVc2FnZVJvbGx1cCB7XG4gIGRhdGU6IHN0cmluZztcbiAgdG9rZW5zOiBudW1iZXI7XG4gIGNvc3Q6IG51bWJlcjtcbiAgbWVzc2FnZXM6IG51bWJlcjtcbn1cblxuY29uc3QgZmFsbGJhY2tEYWlseUZyb21TZXNzaW9ucyA9IChzZXNzaW9uczogUmVhZG9ubHlBcnJheTxHYXRld2F5VXNhZ2VTZXNzaW9uPik6IERhaWx5VXNhZ2VSb2xsdXBbXSA9PiB7XG4gIGNvbnN0IGJ5RGF0ZSA9IG5ldyBNYXA8c3RyaW5nLCBEYWlseVVzYWdlUm9sbHVwPigpO1xuXG4gIGZvciAoY29uc3Qgc2Vzc2lvbiBvZiBzZXNzaW9ucykge1xuICAgIGNvbnN0IHRpbWVzdGFtcCA9IHNlc3Npb25BY3Rpdml0eVRpbWVzdGFtcChzZXNzaW9uKTtcbiAgICBpZiAoIXRpbWVzdGFtcCkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgY29uc3QgZGF0ZSA9IGlzb0RhdGVGcm9tVGltZXN0YW1wKHRpbWVzdGFtcCk7XG4gICAgY29uc3QgY3VycmVudCA9IGJ5RGF0ZS5nZXQoZGF0ZSkgPz8geyBkYXRlLCB0b2tlbnM6IDAsIGNvc3Q6IDAsIG1lc3NhZ2VzOiAwIH07XG4gICAgYnlEYXRlLnNldChkYXRlLCB7XG4gICAgICBkYXRlLFxuICAgICAgdG9rZW5zOiBjdXJyZW50LnRva2VucyArIHNlc3Npb25Ub2tlbnMoc2Vzc2lvbiksXG4gICAgICBjb3N0OiBjdXJyZW50LmNvc3QgKyBzZXNzaW9uQ29zdChzZXNzaW9uKSxcbiAgICAgIG1lc3NhZ2VzOiBjdXJyZW50Lm1lc3NhZ2VzICsgc2Vzc2lvbk1lc3NhZ2VzKHNlc3Npb24pLFxuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIFsuLi5ieURhdGUudmFsdWVzKCldLnNvcnQoKGxlZnQsIHJpZ2h0KSA9PiBsZWZ0LmRhdGUubG9jYWxlQ29tcGFyZShyaWdodC5kYXRlKSk7XG59O1xuXG5jb25zdCBub3JtYWxpemVEYWlseVVzYWdlID0gKFxuICBkYWlseTogUmVhZG9ubHlBcnJheTxHYXRld2F5VXNhZ2VEYWlseT4gfCB1bmRlZmluZWQsXG4gIHNlc3Npb25zOiBSZWFkb25seUFycmF5PEdhdGV3YXlVc2FnZVNlc3Npb24+LFxuKTogRGFpbHlVc2FnZVJvbGx1cFtdID0+IHtcbiAgaWYgKGRhaWx5ICYmIGRhaWx5Lmxlbmd0aCA+IDApIHtcbiAgICBjb25zdCBtYXBwZWQgPSBkYWlseVxuICAgICAgLm1hcCgoZW50cnkpID0+ICh7XG4gICAgICAgIGRhdGU6IGVudHJ5LmRhdGUsXG4gICAgICAgIHRva2VuczogdG9OdW1iZXIoZW50cnkudG9rZW5zKSxcbiAgICAgICAgY29zdDogdG9OdW1iZXIoZW50cnkuY29zdCksXG4gICAgICAgIG1lc3NhZ2VzOiB0b051bWJlcihlbnRyeS5tZXNzYWdlcyksXG4gICAgICB9KSlcbiAgICAgIC5zb3J0KChsZWZ0LCByaWdodCkgPT4gbGVmdC5kYXRlLmxvY2FsZUNvbXBhcmUocmlnaHQuZGF0ZSkpO1xuXG4gICAgaWYgKG1hcHBlZC5sZW5ndGggPiAwKSB7XG4gICAgICByZXR1cm4gbWFwcGVkO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBmYWxsYmFja0RhaWx5RnJvbVNlc3Npb25zKHNlc3Npb25zKTtcbn07XG5cbmNvbnN0IGJ1aWxkVG9wTW9kZWxzID0gKHVzYWdlOiBHYXRld2F5VXNhZ2VSZXNwb25zZSk6IFRvcE1vZGVsW10gPT4ge1xuICBjb25zdCBmcm9tQWdncmVnYXRlcyA9IHVzYWdlLmFnZ3JlZ2F0ZXM/LmJ5TW9kZWxcbiAgICA/Lm1hcCgoZW50cnkpID0+IHtcbiAgICAgIGNvbnN0IG1vZGVsTmFtZSA9IFtlbnRyeS5wcm92aWRlciwgZW50cnkubW9kZWxdLmZpbHRlcihCb29sZWFuKS5qb2luKFwiL1wiKSB8fCBcInVua25vd25cIjtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG1vZGVsOiBtb2RlbE5hbWUsXG4gICAgICAgIHRva2VuczogTWF0aC5yb3VuZCh0b3RhbHNUb2tlbnMoZW50cnkudG90YWxzKSksXG4gICAgICB9O1xuICAgIH0pXG4gICAgLmZpbHRlcigoZW50cnkpID0+IGVudHJ5LnRva2VucyA+IDApXG4gICAgLnNvcnQoKGxlZnQsIHJpZ2h0KSA9PiByaWdodC50b2tlbnMgLSBsZWZ0LnRva2VucylcbiAgICAuc2xpY2UoMCwgNSk7XG5cbiAgaWYgKGZyb21BZ2dyZWdhdGVzICYmIGZyb21BZ2dyZWdhdGVzLmxlbmd0aCA+IDApIHtcbiAgICByZXR1cm4gZnJvbUFnZ3JlZ2F0ZXM7XG4gIH1cblxuICBjb25zdCBieU1vZGVsID0gbmV3IE1hcDxzdHJpbmcsIG51bWJlcj4oKTtcbiAgZm9yIChjb25zdCBzZXNzaW9uIG9mIHVzYWdlLnNlc3Npb25zKSB7XG4gICAgY29uc3QgbW9kZWwgPSBzZXNzaW9uLm1vZGVsIHx8IFwidW5rbm93blwiO1xuICAgIGJ5TW9kZWwuc2V0KG1vZGVsLCAoYnlNb2RlbC5nZXQobW9kZWwpID8/IDApICsgc2Vzc2lvblRva2VucyhzZXNzaW9uKSk7XG4gIH1cblxuICByZXR1cm4gWy4uLmJ5TW9kZWwuZW50cmllcygpXVxuICAgIC5tYXAoKFttb2RlbCwgdG9rZW5zXSkgPT4gKHsgbW9kZWwsIHRva2VuczogTWF0aC5yb3VuZCh0b2tlbnMpIH0pKVxuICAgIC5zb3J0KChsZWZ0LCByaWdodCkgPT4gcmlnaHQudG9rZW5zIC0gbGVmdC50b2tlbnMpXG4gICAgLnNsaWNlKDAsIDUpO1xufTtcblxuY29uc3QgYnVpbGRUb3BUb29scyA9ICh1c2FnZTogR2F0ZXdheVVzYWdlUmVzcG9uc2UpOiBUb3BUb29sW10gPT4ge1xuICBjb25zdCBmcm9tQWdncmVnYXRlcyA9IHVzYWdlLmFnZ3JlZ2F0ZXM/LnRvb2xzPy50b29sc1xuICAgID8ubWFwKCh0b29sKSA9PiAoe1xuICAgICAgdG9vbDogdG9vbC5uYW1lIHx8IFwidW5rbm93blwiLFxuICAgICAgY291bnQ6IE1hdGgucm91bmQodG9OdW1iZXIodG9vbC5jb3VudCkpLFxuICAgIH0pKVxuICAgIC5zb3J0KChsZWZ0LCByaWdodCkgPT4gcmlnaHQuY291bnQgLSBsZWZ0LmNvdW50KVxuICAgIC5zbGljZSgwLCA1KTtcblxuICBpZiAoZnJvbUFnZ3JlZ2F0ZXMgJiYgZnJvbUFnZ3JlZ2F0ZXMubGVuZ3RoID4gMCkge1xuICAgIHJldHVybiBmcm9tQWdncmVnYXRlcztcbiAgfVxuXG4gIGNvbnN0IGJ5VG9vbCA9IG5ldyBNYXA8c3RyaW5nLCBudW1iZXI+KCk7XG4gIGZvciAoY29uc3Qgc2Vzc2lvbiBvZiB1c2FnZS5zZXNzaW9ucykge1xuICAgIGNvbnN0IHRvb2xzID0gc2Vzc2lvbi51c2FnZT8udG9vbFVzYWdlPy50b29scyA/PyBbXTtcbiAgICBmb3IgKGNvbnN0IHRvb2wgb2YgdG9vbHMpIHtcbiAgICAgIGNvbnN0IG5hbWUgPSB0b29sLm5hbWUgfHwgXCJ1bmtub3duXCI7XG4gICAgICBieVRvb2wuc2V0KG5hbWUsIChieVRvb2wuZ2V0KG5hbWUpID8/IDApICsgdG9OdW1iZXIodG9vbC5jb3VudCkpO1xuICAgIH1cbiAgfVxuXG4gIGlmIChieVRvb2wuc2l6ZSA+IDApIHtcbiAgICByZXR1cm4gWy4uLmJ5VG9vbC5lbnRyaWVzKCldXG4gICAgICAubWFwKChbdG9vbCwgY291bnRdKSA9PiAoeyB0b29sLCBjb3VudDogTWF0aC5yb3VuZChjb3VudCkgfSkpXG4gICAgICAuc29ydCgobGVmdCwgcmlnaHQpID0+IHJpZ2h0LmNvdW50IC0gbGVmdC5jb3VudClcbiAgICAgIC5zbGljZSgwLCA1KTtcbiAgfVxuXG4gIHJldHVybiBbXG4gICAge1xuICAgICAgdG9vbDogXCJ0b29sX2NhbGxzXCIsXG4gICAgICBjb3VudDogdXNhZ2Uuc2Vzc2lvbnMucmVkdWNlKChzdW0sIHNlc3Npb24pID0+IHN1bSArIHNlc3Npb25Ub29sQ2FsbHMoc2Vzc2lvbiksIDApLFxuICAgIH0sXG4gIF07XG59O1xuXG5jb25zdCBidWlsZEFjdGl2aXR5ID0gKGRhaWx5OiBSZWFkb25seUFycmF5PERhaWx5VXNhZ2VSb2xsdXA+KSA9PiB7XG4gIGlmIChkYWlseS5sZW5ndGggPiAwKSB7XG4gICAgcmV0dXJuIGRhaWx5LnNsaWNlKC0zNSkubWFwKChlbnRyeSkgPT4gKHtcbiAgICAgIGRhdGU6IGVudHJ5LmRhdGUsXG4gICAgICBtZXNzYWdlczogTWF0aC5yb3VuZChlbnRyeS5tZXNzYWdlcyksXG4gICAgfSkpO1xuICB9XG5cbiAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZSgpO1xuICByZXR1cm4gQXJyYXkuZnJvbSh7IGxlbmd0aDogMzUgfSkubWFwKChfLCBpbmRleCkgPT4ge1xuICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSh0b2RheSk7XG4gICAgZGF0ZS5zZXREYXRlKHRvZGF5LmdldERhdGUoKSAtICgzNCAtIGluZGV4KSk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGRhdGU6IGRhdGUudG9JU09TdHJpbmcoKS5zbGljZSgwLCAxMCksXG4gICAgICBtZXNzYWdlczogMCxcbiAgICB9O1xuICB9KTtcbn07XG5cbmNvbnN0IHVzYWdlTWVzc2FnZUNvdW50ID0gKHVzYWdlOiBHYXRld2F5VXNhZ2VSZXNwb25zZSwgZGFpbHk6IFJlYWRvbmx5QXJyYXk8RGFpbHlVc2FnZVJvbGx1cD4pOiBudW1iZXIgPT5cbiAgdG9OdW1iZXIodXNhZ2UuYWdncmVnYXRlcz8ubWVzc2FnZXM/LnRvdGFsKSB8fFxuICBkYWlseS5yZWR1Y2UoKHN1bSwgZW50cnkpID0+IHN1bSArIGVudHJ5Lm1lc3NhZ2VzLCAwKSB8fFxuICB1c2FnZS5zZXNzaW9ucy5yZWR1Y2UoKHN1bSwgc2Vzc2lvbikgPT4gc3VtICsgc2Vzc2lvbk1lc3NhZ2VzKHNlc3Npb24pLCAwKTtcblxuY29uc3QgdG9QZXJpb2RTdGF0ID0gKHVzYWdlOiBHYXRld2F5VXNhZ2VSZXNwb25zZSk6IFBlcmlvZFN0YXQgPT4ge1xuICBjb25zdCBkYWlseSA9IG5vcm1hbGl6ZURhaWx5VXNhZ2UodXNhZ2UuYWdncmVnYXRlcz8uZGFpbHksIHVzYWdlLnNlc3Npb25zKTtcbiAgcmV0dXJuIHtcbiAgICB0b2tlbnM6IE1hdGgucm91bmQodG90YWxzVG9rZW5zKHVzYWdlLnRvdGFscykpLFxuICAgIGNvc3Q6IHJvdW5kTW9uZXkodG90YWxzQ29zdCh1c2FnZS50b3RhbHMpKSxcbiAgICBtZXNzYWdlczogTWF0aC5yb3VuZCh1c2FnZU1lc3NhZ2VDb3VudCh1c2FnZSwgZGFpbHkpKSxcbiAgICBzZXNzaW9uczogdXNhZ2Uuc2Vzc2lvbnMubGVuZ3RoLFxuICB9O1xufTtcblxuY29uc3QgZmV0Y2hVc2FnZVNuYXBzaG90ID0gYXN5bmMgKFxuICBpbnB1dDogR2F0ZXdheUNvbm5lY3Rpb25JbnB1dCxcbiAgcGFyYW1zPzogUmVjb3JkPHN0cmluZywgdW5rbm93bj4sXG4pOiBQcm9taXNlPEdhdGV3YXlVc2FnZVJlc3BvbnNlPiA9PiB7XG4gIGNvbnN0IHVzYWdlID0gYXdhaXQgZ2F0ZXdheVJlcXVlc3Q8R2F0ZXdheVVzYWdlUmVzcG9uc2U+KGlucHV0LCBcInNlc3Npb25zLnVzYWdlXCIsIHBhcmFtcyk7XG4gIGlmICghdXNhZ2UgfHwgIUFycmF5LmlzQXJyYXkodXNhZ2Uuc2Vzc2lvbnMpIHx8ICF1c2FnZS50b3RhbHMpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJzZXNzaW9ucy51c2FnZSByZXNwb25zZSBpcyBtaXNzaW5nIGV4cGVjdGVkIGZpZWxkcy5cIik7XG4gIH1cbiAgcmV0dXJuIHVzYWdlO1xufTtcblxuY29uc3QgYnVpbGRDb25uZWN0UGFyYW1zID0gYXN5bmMgKGlucHV0OiBHYXRld2F5Q29ubmVjdGlvbklucHV0KSA9PiB7XG4gIGNvbnN0IGlkZW50aXR5ID0gYXdhaXQgZ2V0T3JDcmVhdGVEZXZpY2VJZGVudGl0eSgpO1xuICBjb25zdCB0b2tlbiA9IGlucHV0LmFwaUtleSA/PyBcIlwiO1xuXG4gIGNvbnN0IGRldmljZSA9IGF3YWl0IHNpZ25Db25uZWN0Q2hhbGxlbmdlKHtcbiAgICBpZGVudGl0eSxcbiAgICBjbGllbnRJZDogQ0xJRU5UX0lELFxuICAgIGNsaWVudE1vZGU6IENMSUVOVF9NT0RFLFxuICAgIHJvbGU6IFJPTEUsXG4gICAgc2NvcGVzOiBTQ09QRVMsXG4gICAgdG9rZW4sXG4gIH0pO1xuXG4gIHJldHVybiB7XG4gICAgbWluUHJvdG9jb2w6IDMsXG4gICAgbWF4UHJvdG9jb2w6IDMsXG4gICAgY2xpZW50OiB7XG4gICAgICBpZDogQ0xJRU5UX0lELFxuICAgICAgZGlzcGxheU5hbWU6IFwiQ2xhd0JvYXJkXCIsXG4gICAgICB2ZXJzaW9uOiBcIjAuMS4wXCIsXG4gICAgICBwbGF0Zm9ybTogXCJub2RlXCIsXG4gICAgICBtb2RlOiBDTElFTlRfTU9ERSxcbiAgICAgIGluc3RhbmNlSWQ6IGBjbGF3Ym9hcmQtJHtwcm9jZXNzLnBpZH1gLFxuICAgIH0sXG4gICAgcm9sZTogUk9MRSxcbiAgICBzY29wZXM6IFNDT1BFUyxcbiAgICBkZXZpY2UsXG4gICAgLi4uKHRva2VuID8geyBhdXRoOiB7IHRva2VuIH0gfSA6IHt9KSxcbiAgfTtcbn07XG5cbmNvbnN0IGdhdGV3YXlSZXF1ZXN0ID0gYXN5bmMgPFQ+KFxuICBpbnB1dDogR2F0ZXdheUNvbm5lY3Rpb25JbnB1dCxcbiAgbWV0aG9kOiBzdHJpbmcsXG4gIHBhcmFtcz86IFJlY29yZDxzdHJpbmcsIHVua25vd24+LFxuICB0aW1lb3V0TXM6IG51bWJlciA9IERFRkFVTFRfVElNRU9VVF9NUyxcbik6IFByb21pc2U8VD4gPT4ge1xuICBwcm9jZXNzLmVudi5XU19OT19CVUZGRVJfVVRJTCA9IFwiMVwiO1xuICBwcm9jZXNzLmVudi5XU19OT19VVEZfOF9WQUxJREFURSA9IFwiMVwiO1xuICBjb25zdCB3c01vZHVsZSA9IGF3YWl0IGltcG9ydChcIndzXCIpO1xuICBjb25zdCBXZWJTb2NrZXQgPSB3c01vZHVsZS5kZWZhdWx0O1xuXG4gIGNvbnN0IGNvbm5lY3RQYXJhbXMgPSBhd2FpdCBidWlsZENvbm5lY3RQYXJhbXMoaW5wdXQpO1xuICBjb25zdCB3c1VybCA9IG5vcm1hbGl6ZUdhdGV3YXlVcmwoaW5wdXQuZ2F0ZXdheVVybCk7XG5cbiAgcmV0dXJuIG5ldyBQcm9taXNlPFQ+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBjb25zdCBjb25uZWN0SWQgPSBjcmVhdGVSZXF1ZXN0SWQoXCJjb25uZWN0XCIpO1xuICAgIGNvbnN0IHJlcXVlc3RJZCA9IGNyZWF0ZVJlcXVlc3RJZChcInJlcVwiKTtcbiAgICBsZXQgc2V0dGxlZCA9IGZhbHNlO1xuICAgIGxldCBoYW5kc2hha2VDb21wbGV0ZSA9IGZhbHNlO1xuXG4gICAgY29uc3Qgd3MgPSBuZXcgV2ViU29ja2V0KHdzVXJsKTtcblxuICAgIGNvbnN0IHNldHRsZSA9IChjYWxsYmFjazogKCkgPT4gdm9pZCkgPT4ge1xuICAgICAgaWYgKHNldHRsZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgc2V0dGxlZCA9IHRydWU7XG4gICAgICBjbGVhclRpbWVvdXQodGltZXIpO1xuICAgICAgY2FsbGJhY2soKTtcbiAgICB9O1xuXG4gICAgY29uc3QgdGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHNldHRsZSgoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgd3MuY2xvc2UoKTtcbiAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgLy8gaWdub3JlIGNsb3NlIGZhaWx1cmVzIG9uIHRpbWVvdXRcbiAgICAgICAgfVxuICAgICAgICByZWplY3QobmV3IEVycm9yKGBHYXRld2F5IHJlcXVlc3QgdGltZWQgb3V0IGFmdGVyICR7dGltZW91dE1zfW1zYCkpO1xuICAgICAgfSk7XG4gICAgfSwgdGltZW91dE1zKTtcblxuICAgIHdzLm9uKFwib3BlblwiLCAoKSA9PiB7XG4gICAgICB3cy5zZW5kKFxuICAgICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgdHlwZTogXCJyZXFcIixcbiAgICAgICAgICBpZDogY29ubmVjdElkLFxuICAgICAgICAgIG1ldGhvZDogXCJjb25uZWN0XCIsXG4gICAgICAgICAgcGFyYW1zOiBjb25uZWN0UGFyYW1zIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+LFxuICAgICAgICB9KSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICB3cy5vbihcIm1lc3NhZ2VcIiwgKHJhdzogdW5rbm93bikgPT4ge1xuICAgICAgaWYgKHNldHRsZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBsZXQgZnJhbWU6IEdhdGV3YXlGcmFtZTxUPjtcbiAgICAgIHRyeSB7XG4gICAgICAgIGZyYW1lID0gSlNPTi5wYXJzZShyYXdGcmFtZVRvVGV4dChyYXcpKSBhcyBHYXRld2F5RnJhbWU8VD47XG4gICAgICB9IGNhdGNoIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAoZnJhbWUudHlwZSAhPT0gXCJyZXNcIikge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmICghaGFuZHNoYWtlQ29tcGxldGUgJiYgZnJhbWUuaWQgPT09IGNvbm5lY3RJZCkge1xuICAgICAgICBpZiAoZnJhbWUuZXJyb3IpIHtcbiAgICAgICAgICBjb25zdCBoYW5kc2hha2VFcnJvciA9IGZyYW1lLmVycm9yO1xuICAgICAgICAgIHNldHRsZSgoKSA9PiByZWplY3QobmV3IEVycm9yKGBHYXRld2F5IGhhbmRzaGFrZSBmYWlsZWQ6ICR7aGFuZHNoYWtlRXJyb3IubWVzc2FnZX1gKSkpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGhhbmRzaGFrZUNvbXBsZXRlID0gdHJ1ZTtcbiAgICAgICAgd3Muc2VuZChcbiAgICAgICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICB0eXBlOiBcInJlcVwiLFxuICAgICAgICAgICAgaWQ6IHJlcXVlc3RJZCxcbiAgICAgICAgICAgIG1ldGhvZCxcbiAgICAgICAgICAgIC4uLihwYXJhbXMgPyB7IHBhcmFtcyB9IDoge30pLFxuICAgICAgICAgIH0pLFxuICAgICAgICApO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmIChoYW5kc2hha2VDb21wbGV0ZSAmJiBmcmFtZS5pZCA9PT0gcmVxdWVzdElkKSB7XG4gICAgICAgIHNldHRsZSgoKSA9PiB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHdzLmNsb3NlKCk7XG4gICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAvLyBpZ25vcmUgY2xvc2UgZmFpbHVyZXMgYWZ0ZXIgcmVzcG9uc2VcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoZnJhbWUuZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RFcnJvciA9IGZyYW1lLmVycm9yO1xuICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcihgR2F0ZXdheSBlcnJvciBbJHtyZXF1ZXN0RXJyb3IuY29kZX1dOiAke3JlcXVlc3RFcnJvci5tZXNzYWdlfWApKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXNvbHZlKChmcmFtZS5wYXlsb2FkID8/IGZyYW1lLnJlc3VsdCkgYXMgVCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgd3Mub24oXCJlcnJvclwiLCAoZXJyb3I6IEVycm9yKSA9PiB7XG4gICAgICBzZXR0bGUoKCkgPT4ge1xuICAgICAgICByZWplY3QobmV3IEVycm9yKGBHYXRld2F5IGNvbm5lY3Rpb24gZXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gKSk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIHdzLm9uKFwiY2xvc2VcIiwgKCkgPT4ge1xuICAgICAgaWYgKHNldHRsZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBzZXR0bGUoKCkgPT4ge1xuICAgICAgICByZWplY3QobmV3IEVycm9yKFwiR2F0ZXdheSBjb25uZWN0aW9uIGNsb3NlZCB1bmV4cGVjdGVkbHlcIikpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xufTtcblxuY29uc3QgZGV0ZXJtaW5pc3RpY051bWJlciA9IChpbnB1dDogc3RyaW5nLCBtaW46IG51bWJlciwgbWF4OiBudW1iZXIpOiBudW1iZXIgPT4ge1xuICBsZXQgaGFzaCA9IDA7XG4gIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBpbnB1dC5sZW5ndGg7IGluZGV4ICs9IDEpIHtcbiAgICBoYXNoID0gKGhhc2ggKiAzMSArIGlucHV0LmNoYXJDb2RlQXQoaW5kZXgpKSAlIDIxNDc0ODM2NDc7XG4gIH1cbiAgY29uc3Qgc3BhbiA9IG1heCAtIG1pbjtcbiAgcmV0dXJuIG1pbiArIChoYXNoICUgKHNwYW4gKyAxKSk7XG59O1xuXG5jb25zdCBnZW5lcmF0ZUZhbGxiYWNrU3RhdHMgPSAoc2VlZDogc3RyaW5nKTogR2F0ZXdheVJhd1N0YXRzID0+IHtcbiAgY29uc3QgdG90YWxUb2tlbnMgPSBkZXRlcm1pbmlzdGljTnVtYmVyKGAke3NlZWR9OnRva2Vuc2AsIDUwXzAwMCwgMl8wMDBfMDAwKTtcbiAgY29uc3QgbWVzc2FnZUNvdW50ID0gZGV0ZXJtaW5pc3RpY051bWJlcihgJHtzZWVkfTptZXNzYWdlc2AsIDMwMCwgOV8wMDApO1xuICBjb25zdCBzZXNzaW9uQ291bnQgPSBkZXRlcm1pbmlzdGljTnVtYmVyKGAke3NlZWR9OnNlc3Npb25zYCwgMjAsIDkwMCk7XG4gIGNvbnN0IHRvdGFsQ29zdCA9IE51bWJlcigodG90YWxUb2tlbnMgLyAxXzAwMF8wMDAgKiAyLjQpLnRvRml4ZWQoMikpO1xuXG4gIGNvbnN0IHRvcE1vZGVscyA9IFtcbiAgICB7IG1vZGVsOiBcImNsYXVkZS1zb25uZXRcIiwgdG9rZW5zOiBNYXRoLmZsb29yKHRvdGFsVG9rZW5zICogMC40MikgfSxcbiAgICB7IG1vZGVsOiBcImdwdC00b1wiLCB0b2tlbnM6IE1hdGguZmxvb3IodG90YWxUb2tlbnMgKiAwLjMxKSB9LFxuICAgIHsgbW9kZWw6IFwibzMtbWluaVwiLCB0b2tlbnM6IE1hdGguZmxvb3IodG90YWxUb2tlbnMgKiAwLjE3KSB9LFxuICAgIHsgbW9kZWw6IFwibGxhbWEtMy4zXCIsIHRva2VuczogTWF0aC5mbG9vcih0b3RhbFRva2VucyAqIDAuMSkgfSxcbiAgXTtcblxuICBjb25zdCB0b3BUb29scyA9IFtcbiAgICB7IHRvb2w6IFwiZXhlY1wiLCBjb3VudDogTWF0aC5mbG9vcihtZXNzYWdlQ291bnQgKiAwLjM1KSB9LFxuICAgIHsgdG9vbDogXCJ3ZWIuc2VhcmNoXCIsIGNvdW50OiBNYXRoLmZsb29yKG1lc3NhZ2VDb3VudCAqIDAuMikgfSxcbiAgICB7IHRvb2w6IFwicmVhZF9maWxlXCIsIGNvdW50OiBNYXRoLmZsb29yKG1lc3NhZ2VDb3VudCAqIDAuMTgpIH0sXG4gICAgeyB0b29sOiBcIndyaXRlX2ZpbGVcIiwgY291bnQ6IE1hdGguZmxvb3IobWVzc2FnZUNvdW50ICogMC4xMykgfSxcbiAgICB7IHRvb2w6IFwiZ2l0XCIsIGNvdW50OiBNYXRoLmZsb29yKG1lc3NhZ2VDb3VudCAqIDAuMSkgfSxcbiAgXTtcblxuICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCk7XG4gIGNvbnN0IGFjdGl2aXR5ID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogMzUgfSkubWFwKChfLCBpbmRleCkgPT4ge1xuICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSh0b2RheSk7XG4gICAgZGF0ZS5zZXREYXRlKHRvZGF5LmdldERhdGUoKSAtICgzNCAtIGluZGV4KSk7XG4gICAgY29uc3QgZGF5U2VlZCA9IGRldGVybWluaXN0aWNOdW1iZXIoYCR7c2VlZH06JHtkYXRlLnRvSVNPU3RyaW5nKCkuc2xpY2UoMCwgMTApfWAsIDAsIDUwKTtcbiAgICByZXR1cm4ge1xuICAgICAgZGF0ZTogZGF0ZS50b0lTT1N0cmluZygpLnNsaWNlKDAsIDEwKSxcbiAgICAgIG1lc3NhZ2VzOiBkYXlTZWVkLFxuICAgIH07XG4gIH0pO1xuXG4gIHJldHVybiB7XG4gICAgdG90YWxUb2tlbnMsXG4gICAgdG90YWxDb3N0LFxuICAgIG1lc3NhZ2VDb3VudCxcbiAgICBzZXNzaW9uQ291bnQsXG4gICAgdG9wTW9kZWxzLFxuICAgIHRvcFRvb2xzLFxuICAgIGFjdGl2aXR5LFxuICB9O1xufTtcblxuY29uc3QgdW53cmFwQWdlbnRzID0gKHBheWxvYWQ6IHVua25vd24pOiBHYXRld2F5QWdlbnRbXSA9PiB7XG4gIGNvbnN0IHJhd0FnZW50cyA9XG4gICAgcGF5bG9hZCAmJiB0eXBlb2YgcGF5bG9hZCA9PT0gXCJvYmplY3RcIiAmJiBcImFnZW50c1wiIGluIHBheWxvYWQgJiYgQXJyYXkuaXNBcnJheShwYXlsb2FkLmFnZW50cylcbiAgICAgID8gcGF5bG9hZC5hZ2VudHNcbiAgICAgIDogQXJyYXkuaXNBcnJheShwYXlsb2FkKVxuICAgICAgICA/IHBheWxvYWRcbiAgICAgICAgOiBbXTtcblxuICByZXR1cm4gcmF3QWdlbnRzXG4gICAgLmZpbHRlcigoYWdlbnQpOiBhZ2VudCBpcyB7IGlkPzogdW5rbm93bjsgbmFtZT86IHVua25vd24gfSA9PiBCb29sZWFuKGFnZW50KSAmJiB0eXBlb2YgYWdlbnQgPT09IFwib2JqZWN0XCIpXG4gICAgLm1hcCgoYWdlbnQpID0+IHtcbiAgICAgIGNvbnN0IGlkID0gdHlwZW9mIGFnZW50LmlkID09PSBcInN0cmluZ1wiID8gYWdlbnQuaWQgOiBcImFnZW50OnVua25vd25cIjtcbiAgICAgIGNvbnN0IG5hbWUgPSB0eXBlb2YgYWdlbnQubmFtZSA9PT0gXCJzdHJpbmdcIiAmJiBhZ2VudC5uYW1lLmxlbmd0aCA+IDAgPyBhZ2VudC5uYW1lIDogaWQ7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBpZCxcbiAgICAgICAgbmFtZSxcbiAgICAgICAgc3RhdHVzOiBcImFjdGl2ZVwiIGFzIGNvbnN0LFxuICAgICAgfTtcbiAgICB9KTtcbn07XG5cbmV4cG9ydCBjb25zdCB2YWxpZGF0ZUdhdGV3YXlDb25uZWN0aW9uID0gYXN5bmMgKGlucHV0OiBHYXRld2F5Q29ubmVjdGlvbklucHV0KTogUHJvbWlzZTxHYXRld2F5QWdlbnRbXT4gPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdhdGV3YXlSZXF1ZXN0PHVua25vd24+KGlucHV0LCBcImFnZW50cy5saXN0XCIpO1xuICAgIGNvbnN0IGFnZW50cyA9IHVud3JhcEFnZW50cyhyZXN1bHQpO1xuICAgIGlmIChhZ2VudHMubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIGFnZW50cztcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiR2F0ZXdheSByZXR1cm5lZCBhbiBlbXB0eSBhZ2VudHMgbGlzdC5cIik7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgaWYgKEFMTE9XX01PQ0spIHtcbiAgICAgIHJldHVybiBbeyBpZDogXCJhZ2VudDptYWluXCIsIG5hbWU6IFwiTWFpbiBBZ2VudFwiLCBzdGF0dXM6IFwiYWN0aXZlXCIgfV07XG4gICAgfVxuXG4gICAgY29uc3QgbWVzc2FnZSA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogXCJVbmtub3duIGdhdGV3YXkgZXJyb3JcIjtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYFVuYWJsZSB0byBjb25uZWN0IHRvIGdhdGV3YXk6ICR7bWVzc2FnZX1gKTtcbiAgfVxufTtcblxuZXhwb3J0IGNvbnN0IGZldGNoR2F0ZXdheVN0YXRzID0gYXN5bmMgKGlucHV0OiBHYXRld2F5Q29ubmVjdGlvbklucHV0KTogUHJvbWlzZTxHYXRld2F5UmF3U3RhdHM+ID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBlbmREYXRlID0gdG9kYXlJc28oKTtcbiAgICBjb25zdCBzdGFydERhdGUyNGggPSBlbmREYXRlO1xuICAgIGNvbnN0IHN0YXJ0RGF0ZTdkID0gc2hpZnRJc29EYXRlKGVuZERhdGUsIC02KTtcbiAgICBjb25zdCBzdGFydERhdGUzMGQgPSBzaGlmdElzb0RhdGUoZW5kRGF0ZSwgLTI5KTtcbiAgICBjb25zdCBzdGFydERhdGVBbGwgPSBwcm9jZXNzLmVudi5DTEFXQk9BUkRfQUxMX1RJTUVfU1RBUlRfREFURSB8fCBcIjE5NzAtMDEtMDFcIjtcblxuICAgIGNvbnN0IFt1c2FnZUFsbCwgdXNhZ2UyNGgsIHVzYWdlN2QsIHVzYWdlMzBkXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgIGZldGNoVXNhZ2VTbmFwc2hvdChpbnB1dCwgeyBzdGFydERhdGU6IHN0YXJ0RGF0ZUFsbCwgZW5kRGF0ZSwgbGltaXQ6IDEwMF8wMDAgfSksXG4gICAgICBmZXRjaFVzYWdlU25hcHNob3QoaW5wdXQsIHsgc3RhcnREYXRlOiBzdGFydERhdGUyNGgsIGVuZERhdGUsIGxpbWl0OiAyMF8wMDAgfSksXG4gICAgICBmZXRjaFVzYWdlU25hcHNob3QoaW5wdXQsIHsgc3RhcnREYXRlOiBzdGFydERhdGU3ZCwgZW5kRGF0ZSwgbGltaXQ6IDIwXzAwMCB9KSxcbiAgICAgIGZldGNoVXNhZ2VTbmFwc2hvdChpbnB1dCwgeyBzdGFydERhdGU6IHN0YXJ0RGF0ZTMwZCwgZW5kRGF0ZSwgbGltaXQ6IDIwXzAwMCB9KSxcbiAgICBdKTtcblxuICAgIGNvbnN0IHBlcmlvZHMgPSB7XG4gICAgICBcIjI0aFwiOiB0b1BlcmlvZFN0YXQodXNhZ2UyNGgpLFxuICAgICAgXCI3ZFwiOiB0b1BlcmlvZFN0YXQodXNhZ2U3ZCksXG4gICAgICBcIjMwZFwiOiB0b1BlcmlvZFN0YXQodXNhZ2UzMGQpLFxuICAgICAgYWxsOiB0b1BlcmlvZFN0YXQodXNhZ2VBbGwpLFxuICAgIH07XG5cbiAgICBjb25zdCBkYWlseSA9IG5vcm1hbGl6ZURhaWx5VXNhZ2UodXNhZ2UzMGQuYWdncmVnYXRlcz8uZGFpbHksIHVzYWdlMzBkLnNlc3Npb25zKTtcblxuICAgIHJldHVybiB7XG4gICAgICB0b3RhbFRva2VuczogcGVyaW9kcy5hbGwudG9rZW5zLFxuICAgICAgdG90YWxDb3N0OiBwZXJpb2RzLmFsbC5jb3N0LFxuICAgICAgbWVzc2FnZUNvdW50OiBwZXJpb2RzLmFsbC5tZXNzYWdlcyxcbiAgICAgIHNlc3Npb25Db3VudDogcGVyaW9kcy5hbGwuc2Vzc2lvbnMsXG4gICAgICB0b3BNb2RlbHM6IGJ1aWxkVG9wTW9kZWxzKHVzYWdlQWxsKSxcbiAgICAgIHRvcFRvb2xzOiBidWlsZFRvcFRvb2xzKHVzYWdlQWxsKSxcbiAgICAgIGFjdGl2aXR5OiBidWlsZEFjdGl2aXR5KGRhaWx5KSxcbiAgICAgIHBlcmlvZHMsXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBpZiAoQUxMT1dfTU9DSykge1xuICAgICAgcmV0dXJuIGdlbmVyYXRlRmFsbGJhY2tTdGF0cyhgJHtpbnB1dC5nYXRld2F5VXJsfToke2lucHV0LmFwaUtleSA/PyBcIlwifWApO1xuICAgIH1cblxuICAgIGNvbnN0IG1lc3NhZ2UgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFwiVW5rbm93biBnYXRld2F5IGVycm9yXCI7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBVbmFibGUgdG8gZmV0Y2ggdXNhZ2UgZnJvbSBnYXRld2F5OiAke21lc3NhZ2V9YCk7XG4gIH1cbn07XG4iXSwibmFtZXMiOlsiZ2V0T3JDcmVhdGVEZXZpY2VJZGVudGl0eSIsInNpZ25Db25uZWN0Q2hhbGxlbmdlIiwiREVGQVVMVF9USU1FT1VUX01TIiwiQUxMT1dfTU9DSyIsInByb2Nlc3MiLCJlbnYiLCJDTEFXQk9BUkRfQUxMT1dfTU9DS19TVEFUUyIsIkNMSUVOVF9JRCIsIkNMSUVOVF9NT0RFIiwiUk9MRSIsIlNDT1BFUyIsIm5vcm1hbGl6ZUdhdGV3YXlVcmwiLCJnYXRld2F5VXJsIiwidHJpbW1lZCIsInRyaW0iLCJyZXBsYWNlIiwidGVzdCIsInVybCIsIlVSTCIsInByb3RvY29sIiwiaG9zdCIsInBhdGhuYW1lIiwiY3JlYXRlUmVxdWVzdElkIiwicHJlZml4IiwiRGF0ZSIsIm5vdyIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsInNsaWNlIiwidG9OdW1iZXIiLCJ2YWx1ZSIsIk51bWJlciIsImlzRmluaXRlIiwiaXNvRGF0ZUZyb21UaW1lc3RhbXAiLCJ0aW1lc3RhbXBNcyIsInRvSVNPU3RyaW5nIiwicmF3RnJhbWVUb1RleHQiLCJyYXciLCJCdWZmZXIiLCJpc0J1ZmZlciIsIkFycmF5IiwiaXNBcnJheSIsImV2ZXJ5IiwiaXRlbSIsImNvbmNhdCIsIkFycmF5QnVmZmVyIiwiZnJvbSIsImlzVmlldyIsImJ1ZmZlciIsImJ5dGVPZmZzZXQiLCJieXRlTGVuZ3RoIiwiU3RyaW5nIiwidG90YWxzVG9rZW5zIiwidG90YWxzIiwiYnVja2V0VG90YWwiLCJpbnB1dCIsIm91dHB1dCIsImNhY2hlUmVhZCIsImNhY2hlV3JpdGUiLCJ0b3RhbFRva2VucyIsInRvdGFsc0Nvc3QiLCJpbnB1dENvc3QiLCJvdXRwdXRDb3N0IiwiY2FjaGVSZWFkQ29zdCIsImNhY2hlV3JpdGVDb3N0IiwidG90YWxDb3N0Iiwic2Vzc2lvblRva2VucyIsInNlc3Npb24iLCJ1c2FnZSIsInNlc3Npb25Db3N0Iiwic2Vzc2lvbk1lc3NhZ2VzIiwibWVzc2FnZUNvdW50cyIsInRvdGFsIiwibWVzc2FnZXMiLCJzZXNzaW9uVG9vbENhbGxzIiwidG9vbENhbGxzIiwidG9vbFVzYWdlIiwidG90YWxDYWxscyIsInNlc3Npb25BY3Rpdml0eVRpbWVzdGFtcCIsImxhc3RBY3Rpdml0eSIsInVwZGF0ZWRBdCIsInJvdW5kTW9uZXkiLCJ0b0ZpeGVkIiwidG9kYXlJc28iLCJzaGlmdElzb0RhdGUiLCJpc29EYXRlIiwiZGF5cyIsImJhc2UiLCJzZXREYXRlIiwiZ2V0RGF0ZSIsImZhbGxiYWNrRGFpbHlGcm9tU2Vzc2lvbnMiLCJzZXNzaW9ucyIsImJ5RGF0ZSIsIk1hcCIsInRpbWVzdGFtcCIsImRhdGUiLCJjdXJyZW50IiwiZ2V0IiwidG9rZW5zIiwiY29zdCIsInNldCIsInZhbHVlcyIsInNvcnQiLCJsZWZ0IiwicmlnaHQiLCJsb2NhbGVDb21wYXJlIiwibm9ybWFsaXplRGFpbHlVc2FnZSIsImRhaWx5IiwibGVuZ3RoIiwibWFwcGVkIiwibWFwIiwiZW50cnkiLCJidWlsZFRvcE1vZGVscyIsImZyb21BZ2dyZWdhdGVzIiwiYWdncmVnYXRlcyIsImJ5TW9kZWwiLCJtb2RlbE5hbWUiLCJwcm92aWRlciIsIm1vZGVsIiwiZmlsdGVyIiwiQm9vbGVhbiIsImpvaW4iLCJyb3VuZCIsImVudHJpZXMiLCJidWlsZFRvcFRvb2xzIiwidG9vbHMiLCJ0b29sIiwibmFtZSIsImNvdW50IiwiYnlUb29sIiwic2l6ZSIsInJlZHVjZSIsInN1bSIsImJ1aWxkQWN0aXZpdHkiLCJ0b2RheSIsIl8iLCJpbmRleCIsInVzYWdlTWVzc2FnZUNvdW50IiwidG9QZXJpb2RTdGF0IiwiZmV0Y2hVc2FnZVNuYXBzaG90IiwicGFyYW1zIiwiZ2F0ZXdheVJlcXVlc3QiLCJFcnJvciIsImJ1aWxkQ29ubmVjdFBhcmFtcyIsImlkZW50aXR5IiwidG9rZW4iLCJhcGlLZXkiLCJkZXZpY2UiLCJjbGllbnRJZCIsImNsaWVudE1vZGUiLCJyb2xlIiwic2NvcGVzIiwibWluUHJvdG9jb2wiLCJtYXhQcm90b2NvbCIsImNsaWVudCIsImlkIiwiZGlzcGxheU5hbWUiLCJ2ZXJzaW9uIiwicGxhdGZvcm0iLCJtb2RlIiwiaW5zdGFuY2VJZCIsInBpZCIsImF1dGgiLCJtZXRob2QiLCJ0aW1lb3V0TXMiLCJXU19OT19CVUZGRVJfVVRJTCIsIldTX05PX1VURl84X1ZBTElEQVRFIiwid3NNb2R1bGUiLCJXZWJTb2NrZXQiLCJkZWZhdWx0IiwiY29ubmVjdFBhcmFtcyIsIndzVXJsIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJjb25uZWN0SWQiLCJyZXF1ZXN0SWQiLCJzZXR0bGVkIiwiaGFuZHNoYWtlQ29tcGxldGUiLCJ3cyIsInNldHRsZSIsImNhbGxiYWNrIiwiY2xlYXJUaW1lb3V0IiwidGltZXIiLCJzZXRUaW1lb3V0IiwiY2xvc2UiLCJvbiIsInNlbmQiLCJKU09OIiwic3RyaW5naWZ5IiwidHlwZSIsImZyYW1lIiwicGFyc2UiLCJlcnJvciIsImhhbmRzaGFrZUVycm9yIiwibWVzc2FnZSIsInJlcXVlc3RFcnJvciIsImNvZGUiLCJwYXlsb2FkIiwicmVzdWx0IiwiZGV0ZXJtaW5pc3RpY051bWJlciIsIm1pbiIsIm1heCIsImhhc2giLCJjaGFyQ29kZUF0Iiwic3BhbiIsImdlbmVyYXRlRmFsbGJhY2tTdGF0cyIsInNlZWQiLCJtZXNzYWdlQ291bnQiLCJzZXNzaW9uQ291bnQiLCJ0b3BNb2RlbHMiLCJmbG9vciIsInRvcFRvb2xzIiwiYWN0aXZpdHkiLCJkYXlTZWVkIiwidW53cmFwQWdlbnRzIiwicmF3QWdlbnRzIiwiYWdlbnRzIiwiYWdlbnQiLCJzdGF0dXMiLCJ2YWxpZGF0ZUdhdGV3YXlDb25uZWN0aW9uIiwiZmV0Y2hHYXRld2F5U3RhdHMiLCJlbmREYXRlIiwic3RhcnREYXRlMjRoIiwic3RhcnREYXRlN2QiLCJzdGFydERhdGUzMGQiLCJzdGFydERhdGVBbGwiLCJDTEFXQk9BUkRfQUxMX1RJTUVfU1RBUlRfREFURSIsInVzYWdlQWxsIiwidXNhZ2UyNGgiLCJ1c2FnZTdkIiwidXNhZ2UzMGQiLCJhbGwiLCJzdGFydERhdGUiLCJsaW1pdCIsInBlcmlvZHMiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/gateway/client.ts\n");

/***/ }),

/***/ "(rsc)/./lib/gateway/device-identity.ts":
/*!****************************************!*\
  !*** ./lib/gateway/device-identity.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getOrCreateDeviceIdentity: () => (/* binding */ getOrCreateDeviceIdentity),\n/* harmony export */   signConnectChallenge: () => (/* binding */ signConnectChallenge)\n/* harmony export */ });\n/* harmony import */ var node_crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! node:crypto */ \"node:crypto\");\n/* harmony import */ var node_crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(node_crypto__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var node_fs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! node:fs */ \"node:fs\");\n/* harmony import */ var node_fs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(node_fs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var node_path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! node:path */ \"node:path\");\n/* harmony import */ var node_path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(node_path__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nconst getDevicePath = ()=>node_path__WEBPACK_IMPORTED_MODULE_2___default().join(process.cwd(), \".clawboard\", \"device.json\");\nconst extractRawPublicKey = (spkiDer)=>spkiDer.subarray(-32);\nconst extractRawPrivateKey = (pkcs8Der)=>pkcs8Der.subarray(-32);\nconst fingerprintPublicKey = (rawPublicKey)=>node_crypto__WEBPACK_IMPORTED_MODULE_0___default().createHash(\"sha256\").update(rawPublicKey).digest(\"hex\");\nconst generateDeviceIdentity = ()=>{\n    const { publicKey, privateKey } = node_crypto__WEBPACK_IMPORTED_MODULE_0___default().generateKeyPairSync(\"ed25519\");\n    const rawPub = extractRawPublicKey(publicKey.export({\n        type: \"spki\",\n        format: \"der\"\n    }));\n    const rawPriv = extractRawPrivateKey(privateKey.export({\n        type: \"pkcs8\",\n        format: \"der\"\n    }));\n    return {\n        deviceId: fingerprintPublicKey(rawPub),\n        publicKey: rawPub.toString(\"base64url\"),\n        privateKey: rawPriv.toString(\"base64url\")\n    };\n};\nconst readDeviceIdentity = async ()=>{\n    try {\n        const raw = await node_fs__WEBPACK_IMPORTED_MODULE_1__.promises.readFile(getDevicePath(), \"utf-8\");\n        const parsed = JSON.parse(raw);\n        if (typeof parsed.deviceId !== \"string\" || typeof parsed.publicKey !== \"string\" || typeof parsed.privateKey !== \"string\") {\n            return null;\n        }\n        return {\n            deviceId: parsed.deviceId,\n            publicKey: parsed.publicKey,\n            privateKey: parsed.privateKey\n        };\n    } catch  {\n        return null;\n    }\n};\nconst writeDeviceIdentity = async (identity)=>{\n    const devicePath = getDevicePath();\n    await node_fs__WEBPACK_IMPORTED_MODULE_1__.promises.mkdir(node_path__WEBPACK_IMPORTED_MODULE_2___default().dirname(devicePath), {\n        recursive: true\n    });\n    await node_fs__WEBPACK_IMPORTED_MODULE_1__.promises.writeFile(devicePath, JSON.stringify(identity, null, 2), \"utf-8\");\n};\nconst getOrCreateDeviceIdentity = async ()=>{\n    const existing = await readDeviceIdentity();\n    if (existing) {\n        return existing;\n    }\n    const identity = generateDeviceIdentity();\n    await writeDeviceIdentity(identity);\n    return identity;\n};\nconst buildDeviceAuthPayload = (params)=>[\n        \"v1\",\n        params.deviceId,\n        params.clientId,\n        params.clientMode,\n        params.role,\n        params.scopes.join(\",\"),\n        String(params.signedAtMs),\n        params.token\n    ].join(\"|\");\nconst signConnectChallenge = async (params)=>{\n    const signedAtMs = Date.now();\n    const payload = buildDeviceAuthPayload({\n        deviceId: params.identity.deviceId,\n        clientId: params.clientId,\n        clientMode: params.clientMode,\n        role: params.role,\n        scopes: params.scopes,\n        signedAtMs,\n        token: params.token\n    });\n    const rawPriv = Buffer.from(params.identity.privateKey, \"base64url\");\n    const pkcs8Header = Buffer.from(\"302e020100300506032b657004220420\", \"hex\");\n    const pkcs8Der = Buffer.concat([\n        pkcs8Header,\n        rawPriv\n    ]);\n    const privateKeyObject = node_crypto__WEBPACK_IMPORTED_MODULE_0___default().createPrivateKey({\n        key: pkcs8Der,\n        format: \"der\",\n        type: \"pkcs8\"\n    });\n    const signature = node_crypto__WEBPACK_IMPORTED_MODULE_0___default().sign(null, Buffer.from(payload, \"utf-8\"), privateKeyObject);\n    return {\n        id: params.identity.deviceId,\n        publicKey: params.identity.publicKey,\n        signature: signature.toString(\"base64url\"),\n        signedAt: signedAtMs\n    };\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LE1BQU0zQixVQUFVZ0MsT0FBT0MsSUFBSSxDQUFDYixPQUFPVixRQUFRLENBQUNoQixVQUFVLEVBQUU7SUFDeEQsTUFBTXdDLGNBQWNGLE9BQU9DLElBQUksQ0FBQyxvQ0FBb0M7SUFDcEUsTUFBTS9DLFdBQVc4QyxPQUFPRyxNQUFNLENBQUM7UUFBQ0Q7UUFBYWxDO0tBQVE7SUFFckQsTUFBTW9DLG1CQUFtQjlELG1FQUF1QixDQUFDO1FBQy9DZ0UsS0FBS3BEO1FBQ0xhLFFBQVE7UUFDUkQsTUFBTTtJQUNSO0lBRUEsTUFBTXlDLFlBQVlqRSx1REFBVyxDQUFDLE1BQU0wRCxPQUFPQyxJQUFJLENBQUNGLFNBQVMsVUFBVUs7SUFFbkUsT0FBTztRQUNMSyxJQUFJckIsT0FBT1YsUUFBUSxDQUFDVCxRQUFRO1FBQzVCUixXQUFXMkIsT0FBT1YsUUFBUSxDQUFDakIsU0FBUztRQUNwQzhDLFdBQVdBLFVBQVVyQyxRQUFRLENBQUM7UUFDOUJ3QyxVQUFVaEI7SUFDWjtBQUNGLEVBQUUiLCJzb3VyY2VzIjpbIi9Vc2Vycy9lbGlhc3N0ZXZlbnNvbi9EZXNrdG9wL1Byb2plY3RzL2NsYXdib2FyZC9saWIvZ2F0ZXdheS9kZXZpY2UtaWRlbnRpdHkudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNyeXB0byBmcm9tIFwibm9kZTpjcnlwdG9cIjtcbmltcG9ydCB7IHByb21pc2VzIGFzIGZzIH0gZnJvbSBcIm5vZGU6ZnNcIjtcbmltcG9ydCBwYXRoIGZyb20gXCJub2RlOnBhdGhcIjtcblxuaW50ZXJmYWNlIERldmljZUlkZW50aXR5IHtcbiAgZGV2aWNlSWQ6IHN0cmluZztcbiAgcHVibGljS2V5OiBzdHJpbmc7XG4gIHByaXZhdGVLZXk6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIERldmljZVNpZ25hdHVyZSB7XG4gIGlkOiBzdHJpbmc7XG4gIHB1YmxpY0tleTogc3RyaW5nO1xuICBzaWduYXR1cmU6IHN0cmluZztcbiAgc2lnbmVkQXQ6IG51bWJlcjtcbn1cblxuY29uc3QgZ2V0RGV2aWNlUGF0aCA9ICgpOiBzdHJpbmcgPT4gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksIFwiLmNsYXdib2FyZFwiLCBcImRldmljZS5qc29uXCIpO1xuXG5jb25zdCBleHRyYWN0UmF3UHVibGljS2V5ID0gKHNwa2lEZXI6IEJ1ZmZlcik6IEJ1ZmZlciA9PiBzcGtpRGVyLnN1YmFycmF5KC0zMik7XG5jb25zdCBleHRyYWN0UmF3UHJpdmF0ZUtleSA9IChwa2NzOERlcjogQnVmZmVyKTogQnVmZmVyID0+IHBrY3M4RGVyLnN1YmFycmF5KC0zMik7XG5cbmNvbnN0IGZpbmdlcnByaW50UHVibGljS2V5ID0gKHJhd1B1YmxpY0tleTogQnVmZmVyKTogc3RyaW5nID0+XG4gIGNyeXB0by5jcmVhdGVIYXNoKFwic2hhMjU2XCIpLnVwZGF0ZShyYXdQdWJsaWNLZXkpLmRpZ2VzdChcImhleFwiKTtcblxuY29uc3QgZ2VuZXJhdGVEZXZpY2VJZGVudGl0eSA9ICgpOiBEZXZpY2VJZGVudGl0eSA9PiB7XG4gIGNvbnN0IHsgcHVibGljS2V5LCBwcml2YXRlS2V5IH0gPSBjcnlwdG8uZ2VuZXJhdGVLZXlQYWlyU3luYyhcImVkMjU1MTlcIik7XG5cbiAgY29uc3QgcmF3UHViID0gZXh0cmFjdFJhd1B1YmxpY0tleShwdWJsaWNLZXkuZXhwb3J0KHsgdHlwZTogXCJzcGtpXCIsIGZvcm1hdDogXCJkZXJcIiB9KSBhcyBCdWZmZXIpO1xuICBjb25zdCByYXdQcml2ID0gZXh0cmFjdFJhd1ByaXZhdGVLZXkocHJpdmF0ZUtleS5leHBvcnQoeyB0eXBlOiBcInBrY3M4XCIsIGZvcm1hdDogXCJkZXJcIiB9KSBhcyBCdWZmZXIpO1xuXG4gIHJldHVybiB7XG4gICAgZGV2aWNlSWQ6IGZpbmdlcnByaW50UHVibGljS2V5KHJhd1B1YiksXG4gICAgcHVibGljS2V5OiByYXdQdWIudG9TdHJpbmcoXCJiYXNlNjR1cmxcIiksXG4gICAgcHJpdmF0ZUtleTogcmF3UHJpdi50b1N0cmluZyhcImJhc2U2NHVybFwiKSxcbiAgfTtcbn07XG5cbmNvbnN0IHJlYWREZXZpY2VJZGVudGl0eSA9IGFzeW5jICgpOiBQcm9taXNlPERldmljZUlkZW50aXR5IHwgbnVsbD4gPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHJhdyA9IGF3YWl0IGZzLnJlYWRGaWxlKGdldERldmljZVBhdGgoKSwgXCJ1dGYtOFwiKTtcbiAgICBjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKHJhdykgYXMgUGFydGlhbDxEZXZpY2VJZGVudGl0eT47XG4gICAgaWYgKFxuICAgICAgdHlwZW9mIHBhcnNlZC5kZXZpY2VJZCAhPT0gXCJzdHJpbmdcIiB8fFxuICAgICAgdHlwZW9mIHBhcnNlZC5wdWJsaWNLZXkgIT09IFwic3RyaW5nXCIgfHxcbiAgICAgIHR5cGVvZiBwYXJzZWQucHJpdmF0ZUtleSAhPT0gXCJzdHJpbmdcIlxuICAgICkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICBkZXZpY2VJZDogcGFyc2VkLmRldmljZUlkLFxuICAgICAgcHVibGljS2V5OiBwYXJzZWQucHVibGljS2V5LFxuICAgICAgcHJpdmF0ZUtleTogcGFyc2VkLnByaXZhdGVLZXksXG4gICAgfTtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn07XG5cbmNvbnN0IHdyaXRlRGV2aWNlSWRlbnRpdHkgPSBhc3luYyAoaWRlbnRpdHk6IERldmljZUlkZW50aXR5KTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gIGNvbnN0IGRldmljZVBhdGggPSBnZXREZXZpY2VQYXRoKCk7XG4gIGF3YWl0IGZzLm1rZGlyKHBhdGguZGlybmFtZShkZXZpY2VQYXRoKSwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG4gIGF3YWl0IGZzLndyaXRlRmlsZShkZXZpY2VQYXRoLCBKU09OLnN0cmluZ2lmeShpZGVudGl0eSwgbnVsbCwgMiksIFwidXRmLThcIik7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0T3JDcmVhdGVEZXZpY2VJZGVudGl0eSA9IGFzeW5jICgpOiBQcm9taXNlPERldmljZUlkZW50aXR5PiA9PiB7XG4gIGNvbnN0IGV4aXN0aW5nID0gYXdhaXQgcmVhZERldmljZUlkZW50aXR5KCk7XG4gIGlmIChleGlzdGluZykge1xuICAgIHJldHVybiBleGlzdGluZztcbiAgfVxuXG4gIGNvbnN0IGlkZW50aXR5ID0gZ2VuZXJhdGVEZXZpY2VJZGVudGl0eSgpO1xuICBhd2FpdCB3cml0ZURldmljZUlkZW50aXR5KGlkZW50aXR5KTtcbiAgcmV0dXJuIGlkZW50aXR5O1xufTtcblxuY29uc3QgYnVpbGREZXZpY2VBdXRoUGF5bG9hZCA9IChwYXJhbXM6IHtcbiAgZGV2aWNlSWQ6IHN0cmluZztcbiAgY2xpZW50SWQ6IHN0cmluZztcbiAgY2xpZW50TW9kZTogc3RyaW5nO1xuICByb2xlOiBzdHJpbmc7XG4gIHNjb3BlczogUmVhZG9ubHlBcnJheTxzdHJpbmc+O1xuICBzaWduZWRBdE1zOiBudW1iZXI7XG4gIHRva2VuOiBzdHJpbmc7XG59KTogc3RyaW5nID0+XG4gIFtcbiAgICBcInYxXCIsXG4gICAgcGFyYW1zLmRldmljZUlkLFxuICAgIHBhcmFtcy5jbGllbnRJZCxcbiAgICBwYXJhbXMuY2xpZW50TW9kZSxcbiAgICBwYXJhbXMucm9sZSxcbiAgICBwYXJhbXMuc2NvcGVzLmpvaW4oXCIsXCIpLFxuICAgIFN0cmluZyhwYXJhbXMuc2lnbmVkQXRNcyksXG4gICAgcGFyYW1zLnRva2VuLFxuICBdLmpvaW4oXCJ8XCIpO1xuXG5leHBvcnQgY29uc3Qgc2lnbkNvbm5lY3RDaGFsbGVuZ2UgPSBhc3luYyAocGFyYW1zOiB7XG4gIGlkZW50aXR5OiBEZXZpY2VJZGVudGl0eTtcbiAgY2xpZW50SWQ6IHN0cmluZztcbiAgY2xpZW50TW9kZTogc3RyaW5nO1xuICByb2xlOiBzdHJpbmc7XG4gIHNjb3BlczogUmVhZG9ubHlBcnJheTxzdHJpbmc+O1xuICB0b2tlbjogc3RyaW5nO1xufSk6IFByb21pc2U8RGV2aWNlU2lnbmF0dXJlPiA9PiB7XG4gIGNvbnN0IHNpZ25lZEF0TXMgPSBEYXRlLm5vdygpO1xuXG4gIGNvbnN0IHBheWxvYWQgPSBidWlsZERldmljZUF1dGhQYXlsb2FkKHtcbiAgICBkZXZpY2VJZDogcGFyYW1zLmlkZW50aXR5LmRldmljZUlkLFxuICAgIGNsaWVudElkOiBwYXJhbXMuY2xpZW50SWQsXG4gICAgY2xpZW50TW9kZTogcGFyYW1zLmNsaWVudE1vZGUsXG4gICAgcm9sZTogcGFyYW1zLnJvbGUsXG4gICAgc2NvcGVzOiBwYXJhbXMuc2NvcGVzLFxuICAgIHNpZ25lZEF0TXMsXG4gICAgdG9rZW46IHBhcmFtcy50b2tlbixcbiAgfSk7XG5cbiAgY29uc3QgcmF3UHJpdiA9IEJ1ZmZlci5mcm9tKHBhcmFtcy5pZGVudGl0eS5wcml2YXRlS2V5LCBcImJhc2U2NHVybFwiKTtcbiAgY29uc3QgcGtjczhIZWFkZXIgPSBCdWZmZXIuZnJvbShcIjMwMmUwMjAxMDAzMDA1MDYwMzJiNjU3MDA0MjIwNDIwXCIsIFwiaGV4XCIpO1xuICBjb25zdCBwa2NzOERlciA9IEJ1ZmZlci5jb25jYXQoW3BrY3M4SGVhZGVyLCByYXdQcml2XSk7XG5cbiAgY29uc3QgcHJpdmF0ZUtleU9iamVjdCA9IGNyeXB0by5jcmVhdGVQcml2YXRlS2V5KHtcbiAgICBrZXk6IHBrY3M4RGVyLFxuICAgIGZvcm1hdDogXCJkZXJcIixcbiAgICB0eXBlOiBcInBrY3M4XCIsXG4gIH0pO1xuXG4gIGNvbnN0IHNpZ25hdHVyZSA9IGNyeXB0by5zaWduKG51bGwsIEJ1ZmZlci5mcm9tKHBheWxvYWQsIFwidXRmLThcIiksIHByaXZhdGVLZXlPYmplY3QpO1xuXG4gIHJldHVybiB7XG4gICAgaWQ6IHBhcmFtcy5pZGVudGl0eS5kZXZpY2VJZCxcbiAgICBwdWJsaWNLZXk6IHBhcmFtcy5pZGVudGl0eS5wdWJsaWNLZXksXG4gICAgc2lnbmF0dXJlOiBzaWduYXR1cmUudG9TdHJpbmcoXCJiYXNlNjR1cmxcIiksXG4gICAgc2lnbmVkQXQ6IHNpZ25lZEF0TXMsXG4gIH07XG59O1xuIl0sIm5hbWVzIjpbImNyeXB0byIsInByb21pc2VzIiwiZnMiLCJwYXRoIiwiZ2V0RGV2aWNlUGF0aCIsImpvaW4iLCJwcm9jZXNzIiwiY3dkIiwiZXh0cmFjdFJhd1B1YmxpY0tleSIsInNwa2lEZXIiLCJzdWJhcnJheSIsImV4dHJhY3RSYXdQcml2YXRlS2V5IiwicGtjczhEZXIiLCJmaW5nZXJwcmludFB1YmxpY0tleSIsInJhd1B1YmxpY0tleSIsImNyZWF0ZUhhc2giLCJ1cGRhdGUiLCJkaWdlc3QiLCJnZW5lcmF0ZURldmljZUlkZW50aXR5IiwicHVibGljS2V5IiwicHJpdmF0ZUtleSIsImdlbmVyYXRlS2V5UGFpclN5bmMiLCJyYXdQdWIiLCJleHBvcnQiLCJ0eXBlIiwiZm9ybWF0IiwicmF3UHJpdiIsImRldmljZUlkIiwidG9TdHJpbmciLCJyZWFkRGV2aWNlSWRlbnRpdHkiLCJyYXciLCJyZWFkRmlsZSIsInBhcnNlZCIsIkpTT04iLCJwYXJzZSIsIndyaXRlRGV2aWNlSWRlbnRpdHkiLCJpZGVudGl0eSIsImRldmljZVBhdGgiLCJta2RpciIsImRpcm5hbWUiLCJyZWN1cnNpdmUiLCJ3cml0ZUZpbGUiLCJzdHJpbmdpZnkiLCJnZXRPckNyZWF0ZURldmljZUlkZW50aXR5IiwiZXhpc3RpbmciLCJidWlsZERldmljZUF1dGhQYXlsb2FkIiwicGFyYW1zIiwiY2xpZW50SWQiLCJjbGllbnRNb2RlIiwicm9sZSIsInNjb3BlcyIsIlN0cmluZyIsInNpZ25lZEF0TXMiLCJ0b2tlbiIsInNpZ25Db25uZWN0Q2hhbGxlbmdlIiwiRGF0ZSIsIm5vdyIsInBheWxvYWQiLCJCdWZmZXIiLCJmcm9tIiwicGtjczhIZWFkZXIiLCJjb25jYXQiLCJwcml2YXRlS2V5T2JqZWN0IiwiY3JlYXRlUHJpdmF0ZUtleSIsImtleSIsInNpZ25hdHVyZSIsInNpZ24iLCJpZCIsInNpZ25lZEF0Il0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/gateway/device-identity.ts\n");

/***/ }),

/***/ "(rsc)/./lib/tokens.ts":
/*!***********************!*\
  !*** ./lib/tokens.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   issueAnonymousToken: () => (/* binding */ issueAnonymousToken),\n/* harmony export */   verifyAnonymousToken: () => (/* binding */ verifyAnonymousToken)\n/* harmony export */ });\n/* harmony import */ var node_crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! node:crypto */ \"node:crypto\");\n/* harmony import */ var node_crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(node_crypto__WEBPACK_IMPORTED_MODULE_0__);\n\nconst SECRET = process.env.CLAWBOARD_TOKEN_SECRET ?? \"clawboard-dev-secret\";\nconst base64UrlEncode = (value)=>Buffer.from(value, \"utf8\").toString(\"base64\").replace(/=/g, \"\").replace(/\\+/g, \"-\").replace(/\\//g, \"_\");\nconst base64UrlDecode = (value)=>{\n    const normalized = value.replace(/-/g, \"+\").replace(/_/g, \"/\");\n    const padding = normalized.length % 4 === 0 ? \"\" : \"=\".repeat(4 - normalized.length % 4);\n    return Buffer.from(normalized + padding, \"base64\").toString(\"utf8\");\n};\nconst sign = (encodedPayload)=>(0,node_crypto__WEBPACK_IMPORTED_MODULE_0__.createHmac)(\"sha256\", SECRET).update(encodedPayload).digest(\"base64\").replace(/=/g, \"\").replace(/\\+/g, \"-\").replace(/\\//g, \"_\");\nconst issueAnonymousToken = (subject)=>{\n    const payload = {\n        sub: subject,\n        iat: Math.floor(Date.now() / 1000)\n    };\n    const encodedPayload = base64UrlEncode(JSON.stringify(payload));\n    return `${encodedPayload}.${sign(encodedPayload)}`;\n};\nconst verifyAnonymousToken = (token)=>{\n    const [encodedPayload, signature] = token.split(\".\");\n    if (!encodedPayload || !signature) {\n        return null;\n    }\n    if (sign(encodedPayload) !== signature) {\n        return null;\n    }\n    try {\n        const payload = JSON.parse(base64UrlDecode(encodedPayload));\n        if (!payload.sub || typeof payload.sub !== \"string\") {\n            return null;\n        }\n        return payload;\n    } catch  {\n        return null;\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvdG9rZW5zLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBeUM7QUFFekMsTUFBTUMsU0FBU0MsUUFBUUMsR0FBRyxDQUFDQyxzQkFBc0IsSUFBSTtBQU9yRCxNQUFNQyxrQkFBa0IsQ0FBQ0MsUUFDdkJDLE9BQU9DLElBQUksQ0FBQ0YsT0FBTyxRQUNoQkcsUUFBUSxDQUFDLFVBQ1RDLE9BQU8sQ0FBQyxNQUFNLElBQ2RBLE9BQU8sQ0FBQyxPQUFPLEtBQ2ZBLE9BQU8sQ0FBQyxPQUFPO0FBRXBCLE1BQU1DLGtCQUFrQixDQUFDTDtJQUN2QixNQUFNTSxhQUFhTixNQUFNSSxPQUFPLENBQUMsTUFBTSxLQUFLQSxPQUFPLENBQUMsTUFBTTtJQUMxRCxNQUFNRyxVQUFVRCxXQUFXRSxNQUFNLEdBQUcsTUFBTSxJQUFJLEtBQUssSUFBSUMsTUFBTSxDQUFDLElBQUtILFdBQVdFLE1BQU0sR0FBRztJQUN2RixPQUFPUCxPQUFPQyxJQUFJLENBQUNJLGFBQWFDLFNBQVMsVUFBVUosUUFBUSxDQUFDO0FBQzlEO0FBRUEsTUFBTU8sT0FBTyxDQUFDQyxpQkFDWmpCLHVEQUFVQSxDQUFDLFVBQVVDLFFBQ2xCaUIsTUFBTSxDQUFDRCxnQkFDUEUsTUFBTSxDQUFDLFVBQ1BULE9BQU8sQ0FBQyxNQUFNLElBQ2RBLE9BQU8sQ0FBQyxPQUFPLEtBQ2ZBLE9BQU8sQ0FBQyxPQUFPO0FBRWIsTUFBTVUsc0JBQXNCLENBQUNDO0lBQ2xDLE1BQU1DLFVBQWlDO1FBQ3JDQyxLQUFLRjtRQUNMRyxLQUFLQyxLQUFLQyxLQUFLLENBQUNDLEtBQUtDLEdBQUcsS0FBSztJQUMvQjtJQUNBLE1BQU1YLGlCQUFpQlosZ0JBQWdCd0IsS0FBS0MsU0FBUyxDQUFDUjtJQUN0RCxPQUFPLEdBQUdMLGVBQWUsQ0FBQyxFQUFFRCxLQUFLQyxpQkFBaUI7QUFDcEQsRUFBRTtBQUVLLE1BQU1jLHVCQUF1QixDQUFDQztJQUNuQyxNQUFNLENBQUNmLGdCQUFnQmdCLFVBQVUsR0FBR0QsTUFBTUUsS0FBSyxDQUFDO0lBQ2hELElBQUksQ0FBQ2pCLGtCQUFrQixDQUFDZ0IsV0FBVztRQUNqQyxPQUFPO0lBQ1Q7SUFFQSxJQUFJakIsS0FBS0Msb0JBQW9CZ0IsV0FBVztRQUN0QyxPQUFPO0lBQ1Q7SUFFQSxJQUFJO1FBQ0YsTUFBTVgsVUFBVU8sS0FBS00sS0FBSyxDQUFDeEIsZ0JBQWdCTTtRQUMzQyxJQUFJLENBQUNLLFFBQVFDLEdBQUcsSUFBSSxPQUFPRCxRQUFRQyxHQUFHLEtBQUssVUFBVTtZQUNuRCxPQUFPO1FBQ1Q7UUFDQSxPQUFPRDtJQUNULEVBQUUsT0FBTTtRQUNOLE9BQU87SUFDVDtBQUNGLEVBQUUiLCJzb3VyY2VzIjpbIi9Vc2Vycy9lbGlhc3N0ZXZlbnNvbi9EZXNrdG9wL1Byb2plY3RzL2NsYXdib2FyZC9saWIvdG9rZW5zLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUhtYWMgfSBmcm9tIFwibm9kZTpjcnlwdG9cIjtcblxuY29uc3QgU0VDUkVUID0gcHJvY2Vzcy5lbnYuQ0xBV0JPQVJEX1RPS0VOX1NFQ1JFVCA/PyBcImNsYXdib2FyZC1kZXYtc2VjcmV0XCI7XG5cbmludGVyZmFjZSBBbm9ueW1vdXNUb2tlblBheWxvYWQge1xuICBzdWI6IHN0cmluZztcbiAgaWF0OiBudW1iZXI7XG59XG5cbmNvbnN0IGJhc2U2NFVybEVuY29kZSA9ICh2YWx1ZTogc3RyaW5nKTogc3RyaW5nID0+XG4gIEJ1ZmZlci5mcm9tKHZhbHVlLCBcInV0ZjhcIilcbiAgICAudG9TdHJpbmcoXCJiYXNlNjRcIilcbiAgICAucmVwbGFjZSgvPS9nLCBcIlwiKVxuICAgIC5yZXBsYWNlKC9cXCsvZywgXCItXCIpXG4gICAgLnJlcGxhY2UoL1xcLy9nLCBcIl9cIik7XG5cbmNvbnN0IGJhc2U2NFVybERlY29kZSA9ICh2YWx1ZTogc3RyaW5nKTogc3RyaW5nID0+IHtcbiAgY29uc3Qgbm9ybWFsaXplZCA9IHZhbHVlLnJlcGxhY2UoLy0vZywgXCIrXCIpLnJlcGxhY2UoL18vZywgXCIvXCIpO1xuICBjb25zdCBwYWRkaW5nID0gbm9ybWFsaXplZC5sZW5ndGggJSA0ID09PSAwID8gXCJcIiA6IFwiPVwiLnJlcGVhdCg0IC0gKG5vcm1hbGl6ZWQubGVuZ3RoICUgNCkpO1xuICByZXR1cm4gQnVmZmVyLmZyb20obm9ybWFsaXplZCArIHBhZGRpbmcsIFwiYmFzZTY0XCIpLnRvU3RyaW5nKFwidXRmOFwiKTtcbn07XG5cbmNvbnN0IHNpZ24gPSAoZW5jb2RlZFBheWxvYWQ6IHN0cmluZyk6IHN0cmluZyA9PlxuICBjcmVhdGVIbWFjKFwic2hhMjU2XCIsIFNFQ1JFVClcbiAgICAudXBkYXRlKGVuY29kZWRQYXlsb2FkKVxuICAgIC5kaWdlc3QoXCJiYXNlNjRcIilcbiAgICAucmVwbGFjZSgvPS9nLCBcIlwiKVxuICAgIC5yZXBsYWNlKC9cXCsvZywgXCItXCIpXG4gICAgLnJlcGxhY2UoL1xcLy9nLCBcIl9cIik7XG5cbmV4cG9ydCBjb25zdCBpc3N1ZUFub255bW91c1Rva2VuID0gKHN1YmplY3Q6IHN0cmluZyk6IHN0cmluZyA9PiB7XG4gIGNvbnN0IHBheWxvYWQ6IEFub255bW91c1Rva2VuUGF5bG9hZCA9IHtcbiAgICBzdWI6IHN1YmplY3QsXG4gICAgaWF0OiBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKSxcbiAgfTtcbiAgY29uc3QgZW5jb2RlZFBheWxvYWQgPSBiYXNlNjRVcmxFbmNvZGUoSlNPTi5zdHJpbmdpZnkocGF5bG9hZCkpO1xuICByZXR1cm4gYCR7ZW5jb2RlZFBheWxvYWR9LiR7c2lnbihlbmNvZGVkUGF5bG9hZCl9YDtcbn07XG5cbmV4cG9ydCBjb25zdCB2ZXJpZnlBbm9ueW1vdXNUb2tlbiA9ICh0b2tlbjogc3RyaW5nKTogQW5vbnltb3VzVG9rZW5QYXlsb2FkIHwgbnVsbCA9PiB7XG4gIGNvbnN0IFtlbmNvZGVkUGF5bG9hZCwgc2lnbmF0dXJlXSA9IHRva2VuLnNwbGl0KFwiLlwiKTtcbiAgaWYgKCFlbmNvZGVkUGF5bG9hZCB8fCAhc2lnbmF0dXJlKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBpZiAoc2lnbihlbmNvZGVkUGF5bG9hZCkgIT09IHNpZ25hdHVyZSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBwYXlsb2FkID0gSlNPTi5wYXJzZShiYXNlNjRVcmxEZWNvZGUoZW5jb2RlZFBheWxvYWQpKSBhcyBBbm9ueW1vdXNUb2tlblBheWxvYWQ7XG4gICAgaWYgKCFwYXlsb2FkLnN1YiB8fCB0eXBlb2YgcGF5bG9hZC5zdWIgIT09IFwic3RyaW5nXCIpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gcGF5bG9hZDtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn07XG4iXSwibmFtZXMiOlsiY3JlYXRlSG1hYyIsIlNFQ1JFVCIsInByb2Nlc3MiLCJlbnYiLCJDTEFXQk9BUkRfVE9LRU5fU0VDUkVUIiwiYmFzZTY0VXJsRW5jb2RlIiwidmFsdWUiLCJCdWZmZXIiLCJmcm9tIiwidG9TdHJpbmciLCJyZXBsYWNlIiwiYmFzZTY0VXJsRGVjb2RlIiwibm9ybWFsaXplZCIsInBhZGRpbmciLCJsZW5ndGgiLCJyZXBlYXQiLCJzaWduIiwiZW5jb2RlZFBheWxvYWQiLCJ1cGRhdGUiLCJkaWdlc3QiLCJpc3N1ZUFub255bW91c1Rva2VuIiwic3ViamVjdCIsInBheWxvYWQiLCJzdWIiLCJpYXQiLCJNYXRoIiwiZmxvb3IiLCJEYXRlIiwibm93IiwiSlNPTiIsInN0cmluZ2lmeSIsInZlcmlmeUFub255bW91c1Rva2VuIiwidG9rZW4iLCJzaWduYXR1cmUiLCJzcGxpdCIsInBhcnNlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/tokens.ts\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fconnect%2Froute&page=%2Fapi%2Fconnect%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fconnect%2Froute.ts&appDir=%2FUsers%2Feliasstevenson%2FDesktop%2FProjects%2Fclawboard%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Feliasstevenson%2FDesktop%2FProjects%2Fclawboard&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fconnect%2Froute&page=%2Fapi%2Fconnect%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fconnect%2Froute.ts&appDir=%2FUsers%2Feliasstevenson%2FDesktop%2FProjects%2Fclawboard%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Feliasstevenson%2FDesktop%2FProjects%2Fclawboard&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=! ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   handler: () => (/* binding */ handler),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/server/request-meta */ \"(rsc)/./node_modules/next/dist/server/request-meta.js\");\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(rsc)/./node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/shared/lib/router/utils/app-paths */ \"next/dist/shared/lib/router/utils/app-paths\");\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/base-http/node */ \"(rsc)/./node_modules/next/dist/server/base-http/node.js\");\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! next/dist/server/web/spec-extension/adapters/next-request */ \"(rsc)/./node_modules/next/dist/server/web/spec-extension/adapters/next-request.js\");\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(rsc)/./node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! next/dist/server/instrumentation/utils */ \"(rsc)/./node_modules/next/dist/server/instrumentation/utils.js\");\n/* harmony import */ var next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! next/dist/server/send-response */ \"(rsc)/./node_modules/next/dist/server/send-response.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! next/dist/server/web/utils */ \"(rsc)/./node_modules/next/dist/server/web/utils.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! next/dist/server/lib/cache-control */ \"(rsc)/./node_modules/next/dist/server/lib/cache-control.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! next/dist/lib/constants */ \"(rsc)/./node_modules/next/dist/lib/constants.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__);\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! next/dist/shared/lib/no-fallback-error.external */ \"next/dist/shared/lib/no-fallback-error.external\");\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__);\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! next/dist/server/response-cache */ \"(rsc)/./node_modules/next/dist/server/response-cache/index.js\");\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__);\n/* harmony import */ var _Users_eliasstevenson_Desktop_Projects_clawboard_app_api_connect_route_ts__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./app/api/connect/route.ts */ \"(rsc)/./app/api/connect/route.ts\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/connect/route\",\n        pathname: \"/api/connect\",\n        filename: \"route\",\n        bundlePath: \"app/api/connect/route\"\n    },\n    distDir: \".next\" || 0,\n    relativeProjectDir:  false || '',\n    resolvedPagePath: \"/Users/eliasstevenson/Desktop/Projects/clawboard/app/api/connect/route.ts\",\n    nextConfigOutput,\n    userland: _Users_eliasstevenson_Desktop_Projects_clawboard_app_api_connect_route_ts__WEBPACK_IMPORTED_MODULE_16__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\nasync function handler(req, res, ctx) {\n    var _nextConfig_experimental;\n    let srcPage = \"/api/connect/route\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {} else if (srcPage === '/index') {\n        // we always normalize /index specifically\n        srcPage = '/';\n    }\n    const multiZoneDraftMode = false;\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage,\n        multiZoneDraftMode\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return null;\n    }\n    const { buildId, params, nextConfig, isDraftMode, prerenderManifest, routerServerContext, isOnDemandRevalidate, revalidateOnlyGenerated, resolvedPathname } = prepareResult;\n    const normalizedSrcPage = (0,next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__.normalizeAppPath)(srcPage);\n    let isIsr = Boolean(prerenderManifest.dynamicRoutes[normalizedSrcPage] || prerenderManifest.routes[resolvedPathname]);\n    if (isIsr && !isDraftMode) {\n        const isPrerendered = Boolean(prerenderManifest.routes[resolvedPathname]);\n        const prerenderInfo = prerenderManifest.dynamicRoutes[normalizedSrcPage];\n        if (prerenderInfo) {\n            if (prerenderInfo.fallback === false && !isPrerendered) {\n                throw new next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError();\n            }\n        }\n    }\n    let cacheKey = null;\n    if (isIsr && !routeModule.isDev && !isDraftMode) {\n        cacheKey = resolvedPathname;\n        // ensure /index and / is normalized to one key\n        cacheKey = cacheKey === '/index' ? '/' : cacheKey;\n    }\n    const supportsDynamicResponse = // If we're in development, we always support dynamic HTML\n    routeModule.isDev === true || // If this is not SSG or does not have static paths, then it supports\n    // dynamic HTML.\n    !isIsr;\n    // This is a revalidation request if the request is for a static\n    // page and it is not being resumed from a postponed render and\n    // it is not a dynamic RSC request then it is a revalidation\n    // request.\n    const isRevalidate = isIsr && !supportsDynamicResponse;\n    const method = req.method || 'GET';\n    const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.getTracer)();\n    const activeSpan = tracer.getActiveScopeSpan();\n    const context = {\n        params,\n        prerenderManifest,\n        renderOpts: {\n            experimental: {\n                cacheComponents: Boolean(nextConfig.experimental.cacheComponents),\n                authInterrupts: Boolean(nextConfig.experimental.authInterrupts)\n            },\n            supportsDynamicResponse,\n            incrementalCache: (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'incrementalCache'),\n            cacheLifeProfiles: (_nextConfig_experimental = nextConfig.experimental) == null ? void 0 : _nextConfig_experimental.cacheLife,\n            isRevalidate,\n            waitUntil: ctx.waitUntil,\n            onClose: (cb)=>{\n                res.on('close', cb);\n            },\n            onAfterTaskError: undefined,\n            onInstrumentationRequestError: (error, _request, errorContext)=>routeModule.onRequestError(req, error, errorContext, routerServerContext)\n        },\n        sharedContext: {\n            buildId\n        }\n    };\n    const nodeNextReq = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextRequest(req);\n    const nodeNextRes = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextResponse(res);\n    const nextReq = next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.NextRequestAdapter.fromNodeNextRequest(nodeNextReq, (0,next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.signalFromNodeResponse)(res));\n    try {\n        const invokeRouteModule = async (span)=>{\n            return routeModule.handle(nextReq, context).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${req.url}`);\n                }\n            });\n        };\n        const handleResponse = async (currentSpan)=>{\n            var _cacheEntry_value;\n            const responseGenerator = async ({ previousCacheEntry })=>{\n                try {\n                    if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isOnDemandRevalidate && revalidateOnlyGenerated && !previousCacheEntry) {\n                        res.statusCode = 404;\n                        // on-demand revalidate always sets this header\n                        res.setHeader('x-nextjs-cache', 'REVALIDATED');\n                        res.end('This page could not be found');\n                        return null;\n                    }\n                    const response = await invokeRouteModule(currentSpan);\n                    req.fetchMetrics = context.renderOpts.fetchMetrics;\n                    let pendingWaitUntil = context.renderOpts.pendingWaitUntil;\n                    // Attempt using provided waitUntil if available\n                    // if it's not we fallback to sendResponse's handling\n                    if (pendingWaitUntil) {\n                        if (ctx.waitUntil) {\n                            ctx.waitUntil(pendingWaitUntil);\n                            pendingWaitUntil = undefined;\n                        }\n                    }\n                    const cacheTags = context.renderOpts.collectedTags;\n                    // If the request is for a static response, we can cache it so long\n                    // as it's not edge.\n                    if (isIsr) {\n                        const blob = await response.blob();\n                        // Copy the headers from the response.\n                        const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.toNodeOutgoingHttpHeaders)(response.headers);\n                        if (cacheTags) {\n                            headers[next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER] = cacheTags;\n                        }\n                        if (!headers['content-type'] && blob.type) {\n                            headers['content-type'] = blob.type;\n                        }\n                        const revalidate = typeof context.renderOpts.collectedRevalidate === 'undefined' || context.renderOpts.collectedRevalidate >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? false : context.renderOpts.collectedRevalidate;\n                        const expire = typeof context.renderOpts.collectedExpire === 'undefined' || context.renderOpts.collectedExpire >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? undefined : context.renderOpts.collectedExpire;\n                        // Create the cache entry for the response.\n                        const cacheEntry = {\n                            value: {\n                                kind: next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE,\n                                status: response.status,\n                                body: Buffer.from(await blob.arrayBuffer()),\n                                headers\n                            },\n                            cacheControl: {\n                                revalidate,\n                                expire\n                            }\n                        };\n                        return cacheEntry;\n                    } else {\n                        // send response without caching if not ISR\n                        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, response, context.renderOpts.pendingWaitUntil);\n                        return null;\n                    }\n                } catch (err) {\n                    // if this is a background revalidate we need to report\n                    // the request error here as it won't be bubbled\n                    if (previousCacheEntry == null ? void 0 : previousCacheEntry.isStale) {\n                        await routeModule.onRequestError(req, err, {\n                            routerKind: 'App Router',\n                            routePath: srcPage,\n                            routeType: 'route',\n                            revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                                isRevalidate,\n                                isOnDemandRevalidate\n                            })\n                        }, routerServerContext);\n                    }\n                    throw err;\n                }\n            };\n            const cacheEntry = await routeModule.handleResponse({\n                req,\n                nextConfig,\n                cacheKey,\n                routeKind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n                isFallback: false,\n                prerenderManifest,\n                isRoutePPREnabled: false,\n                isOnDemandRevalidate,\n                revalidateOnlyGenerated,\n                responseGenerator,\n                waitUntil: ctx.waitUntil\n            });\n            // we don't create a cacheEntry for ISR\n            if (!isIsr) {\n                return null;\n            }\n            if ((cacheEntry == null ? void 0 : (_cacheEntry_value = cacheEntry.value) == null ? void 0 : _cacheEntry_value.kind) !== next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE) {\n                var _cacheEntry_value1;\n                throw Object.defineProperty(new Error(`Invariant: app-route received invalid cache entry ${cacheEntry == null ? void 0 : (_cacheEntry_value1 = cacheEntry.value) == null ? void 0 : _cacheEntry_value1.kind}`), \"__NEXT_ERROR_CODE\", {\n                    value: \"E701\",\n                    enumerable: false,\n                    configurable: true\n                });\n            }\n            if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode')) {\n                res.setHeader('x-nextjs-cache', isOnDemandRevalidate ? 'REVALIDATED' : cacheEntry.isMiss ? 'MISS' : cacheEntry.isStale ? 'STALE' : 'HIT');\n            }\n            // Draft mode should never be cached\n            if (isDraftMode) {\n                res.setHeader('Cache-Control', 'private, no-cache, no-store, max-age=0, must-revalidate');\n            }\n            const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.fromNodeOutgoingHttpHeaders)(cacheEntry.value.headers);\n            if (!((0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isIsr)) {\n                headers.delete(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER);\n            }\n            // If cache control is already set on the response we don't\n            // override it to allow users to customize it via next.config\n            if (cacheEntry.cacheControl && !res.getHeader('Cache-Control') && !headers.get('Cache-Control')) {\n                headers.set('Cache-Control', (0,next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__.getCacheControlHeader)(cacheEntry.cacheControl));\n            }\n            await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(cacheEntry.value.body, {\n                headers,\n                status: cacheEntry.value.status || 200\n            }));\n            return null;\n        };\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await handleResponse(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, handleResponse));\n        }\n    } catch (err) {\n        if (!(err instanceof next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError)) {\n            await routeModule.onRequestError(req, err, {\n                routerKind: 'App Router',\n                routePath: normalizedSrcPage,\n                routeType: 'route',\n                revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                    isRevalidate,\n                    isOnDemandRevalidate\n                })\n            });\n        }\n        // rethrow so that we can handle serving error page\n        // If this is during static generation, throw the error again.\n        if (isIsr) throw err;\n        // Otherwise, send a 500 response.\n        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(null, {\n            status: 500\n        }));\n        return null;\n    }\n}\n\n//# sourceMappingURL=app-route.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZjb25uZWN0JTJGcm91dGUmcGFnZT0lMkZhcGklMkZjb25uZWN0JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGY29ubmVjdCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRmVsaWFzc3RldmVuc29uJTJGRGVza3RvcCUyRlByb2plY3RzJTJGY2xhd2JvYXJkJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRmVsaWFzc3RldmVuc29uJTJGRGVza3RvcCUyRlByb2plY3RzJTJGY2xhd2JvYXJkJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEJmlzR2xvYmFsTm90Rm91bmRFbmFibGVkPSEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDdkM7QUFDcUI7QUFDZDtBQUNTO0FBQ087QUFDSztBQUNtQztBQUNqRDtBQUNPO0FBQ2Y7QUFDc0M7QUFDekI7QUFDTTtBQUNDO0FBQ2hCO0FBQ29DO0FBQ3RHO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix5R0FBbUI7QUFDM0M7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLGFBQWEsT0FBb0MsSUFBSSxDQUFFO0FBQ3ZELHdCQUF3QixNQUF1QztBQUMvRDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFD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QUFZO0FBQzlCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWLDZFQUE2RSxnRkFBYztBQUMzRixpQ0FBaUMsUUFBUSxFQUFFLFFBQVE7QUFDbkQsMEJBQTBCLHVFQUFRO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsTUFBTTtBQUNOLDZCQUE2Qiw2RkFBZTtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQywyRkFBbUI7QUFDckQ7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsNkVBQVk7QUFDMUI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBOztBQUVBIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0IHsgZ2V0UmVxdWVzdE1ldGEgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yZXF1ZXN0LW1ldGFcIjtcbmltcG9ydCB7IGdldFRyYWNlciwgU3BhbktpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvdHJhY2UvdHJhY2VyXCI7XG5pbXBvcnQgeyBub3JtYWxpemVBcHBQYXRoIH0gZnJvbSBcIm5leHQvZGlzdC9zaGFyZWQvbGliL3JvdXRlci91dGlscy9hcHAtcGF0aHNcIjtcbmltcG9ydCB7IE5vZGVOZXh0UmVxdWVzdCwgTm9kZU5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Jhc2UtaHR0cC9ub2RlXCI7XG5pbXBvcnQgeyBOZXh0UmVxdWVzdEFkYXB0ZXIsIHNpZ25hbEZyb21Ob2RlUmVzcG9uc2UgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci93ZWIvc3BlYy1leHRlbnNpb24vYWRhcHRlcnMvbmV4dC1yZXF1ZXN0XCI7XG5pbXBvcnQgeyBCYXNlU2VydmVyU3BhbiB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi90cmFjZS9jb25zdGFudHNcIjtcbmltcG9ydCB7IGdldFJldmFsaWRhdGVSZWFzb24gfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9pbnN0cnVtZW50YXRpb24vdXRpbHNcIjtcbmltcG9ydCB7IHNlbmRSZXNwb25zZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3NlbmQtcmVzcG9uc2VcIjtcbmltcG9ydCB7IGZyb21Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycywgdG9Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycyB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3dlYi91dGlsc1wiO1xuaW1wb3J0IHsgZ2V0Q2FjaGVDb250cm9sSGVhZGVyIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL2NhY2hlLWNvbnRyb2xcIjtcbmltcG9ydCB7IElORklOSVRFX0NBQ0hFLCBORVhUX0NBQ0hFX1RBR1NfSEVBREVSIH0gZnJvbSBcIm5leHQvZGlzdC9saWIvY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBOb0ZhbGxiYWNrRXJyb3IgfSBmcm9tIFwibmV4dC9kaXN0L3NoYXJlZC9saWIvbm8tZmFsbGJhY2stZXJyb3IuZXh0ZXJuYWxcIjtcbmltcG9ydCB7IENhY2hlZFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3Jlc3BvbnNlLWNhY2hlXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL2VsaWFzc3RldmVuc29uL0Rlc2t0b3AvUHJvamVjdHMvY2xhd2JvYXJkL2FwcC9hcGkvY29ubmVjdC9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvY29ubmVjdC9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2Nvbm5lY3RcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2Nvbm5lY3Qvcm91dGVcIlxuICAgIH0sXG4gICAgZGlzdERpcjogcHJvY2Vzcy5lbnYuX19ORVhUX1JFTEFUSVZFX0RJU1RfRElSIHx8ICcnLFxuICAgIHJlbGF0aXZlUHJvamVjdERpcjogcHJvY2Vzcy5lbnYuX19ORVhUX1JFTEFUSVZFX1BST0pFQ1RfRElSIHx8ICcnLFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL2VsaWFzc3RldmVuc29uL0Rlc2t0b3AvUHJvamVjdHMvY2xhd2JvYXJkL2FwcC9hcGkvY29ubmVjdC9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHdvcmtBc3luY1N0b3JhZ2UsXG4gICAgICAgIHdvcmtVbml0QXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBwYXRjaEZldGNoLCAgfTtcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzLCBjdHgpIHtcbiAgICB2YXIgX25leHRDb25maWdfZXhwZXJpbWVudGFsO1xuICAgIGxldCBzcmNQYWdlID0gXCIvYXBpL2Nvbm5lY3Qvcm91dGVcIjtcbiAgICAvLyB0dXJib3BhY2sgZG9lc24ndCBub3JtYWxpemUgYC9pbmRleGAgaW4gdGhlIHBhZ2UgbmFtZVxuICAgIC8vIHNvIHdlIG5lZWQgdG8gdG8gcHJvY2VzcyBkeW5hbWljIHJvdXRlcyBwcm9wZXJseVxuICAgIC8vIFRPRE86IGZpeCB0dXJib3BhY2sgcHJvdmlkaW5nIGRpZmZlcmluZyB2YWx1ZSBmcm9tIHdlYnBhY2tcbiAgICBpZiAocHJvY2Vzcy5lbnYuVFVSQk9QQUNLKSB7XG4gICAgICAgIHNyY1BhZ2UgPSBzcmNQYWdlLnJlcGxhY2UoL1xcL2luZGV4JC8sICcnKSB8fCAnLyc7XG4gICAgfSBlbHNlIGlmIChzcmNQYWdlID09PSAnL2luZGV4Jykge1xuICAgICAgICAvLyB3ZSBhbHdheXMgbm9ybWFsaXplIC9pbmRleCBzcGVjaWZpY2FsbHlcbiAgICAgICAgc3JjUGFnZSA9ICcvJztcbiAgICB9XG4gICAgY29uc3QgbXVsdGlab25lRHJhZnRNb2RlID0gcHJvY2Vzcy5lbnYuX19ORVhUX01VTFRJX1pPTkVfRFJBRlRfTU9ERTtcbiAgICBjb25zdCBwcmVwYXJlUmVzdWx0ID0gYXdhaXQgcm91dGVNb2R1bGUucHJlcGFyZShyZXEsIHJlcywge1xuICAgICAgICBzcmNQYWdlLFxuICAgICAgICBtdWx0aVpvbmVEcmFmdE1vZGVcbiAgICB9KTtcbiAgICBpZiAoIXByZXBhcmVSZXN1bHQpIHtcbiAgICAgICAgcmVzLnN0YXR1c0NvZGUgPSA0MDA7XG4gICAgICAgIHJlcy5lbmQoJ0JhZCBSZXF1ZXN0Jyk7XG4gICAgICAgIGN0eC53YWl0VW50aWwgPT0gbnVsbCA/IHZvaWQgMCA6IGN0eC53YWl0VW50aWwuY2FsbChjdHgsIFByb21pc2UucmVzb2x2ZSgpKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNvbnN0IHsgYnVpbGRJZCwgcGFyYW1zLCBuZXh0Q29uZmlnLCBpc0RyYWZ0TW9kZSwgcHJlcmVuZGVyTWFuaWZlc3QsIHJvdXRlclNlcnZlckNvbnRleHQsIGlzT25EZW1hbmRSZXZhbGlkYXRlLCByZXZhbGlkYXRlT25seUdlbmVyYXRlZCwgcmVzb2x2ZWRQYXRobmFtZSB9ID0gcHJlcGFyZVJlc3VsdDtcbiAgICBjb25zdCBub3JtYWxpemVkU3JjUGFnZSA9IG5vcm1hbGl6ZUFwcFBhdGgoc3JjUGFnZSk7XG4gICAgbGV0IGlzSXNyID0gQm9vbGVhbihwcmVyZW5kZXJNYW5pZmVzdC5keW5hbWljUm91dGVzW25vcm1hbGl6ZWRTcmNQYWdlXSB8fCBwcmVyZW5kZXJNYW5pZmVzdC5yb3V0ZXNbcmVzb2x2ZWRQYXRobmFtZV0pO1xuICAgIGlmIChpc0lzciAmJiAhaXNEcmFmdE1vZGUpIHtcbiAgICAgICAgY29uc3QgaXNQcmVyZW5kZXJlZCA9IEJvb2xlYW4ocHJlcmVuZGVyTWFuaWZlc3Qucm91dGVzW3Jlc29sdmVkUGF0aG5hbWVdKTtcbiAgICAgICAgY29uc3QgcHJlcmVuZGVySW5mbyA9IHByZXJlbmRlck1hbmlmZXN0LmR5bmFtaWNSb3V0ZXNbbm9ybWFsaXplZFNyY1BhZ2VdO1xuICAgICAgICBpZiAocHJlcmVuZGVySW5mbykge1xuICAgICAgICAgICAgaWYgKHByZXJlbmRlckluZm8uZmFsbGJhY2sgPT09IGZhbHNlICYmICFpc1ByZXJlbmRlcmVkKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vRmFsbGJhY2tFcnJvcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGxldCBjYWNoZUtleSA9IG51bGw7XG4gICAgaWYgKGlzSXNyICYmICFyb3V0ZU1vZHVsZS5pc0RldiAmJiAhaXNEcmFmdE1vZGUpIHtcbiAgICAgICAgY2FjaGVLZXkgPSByZXNvbHZlZFBhdGhuYW1lO1xuICAgICAgICAvLyBlbnN1cmUgL2luZGV4IGFuZCAvIGlzIG5vcm1hbGl6ZWQgdG8gb25lIGtleVxuICAgICAgICBjYWNoZUtleSA9IGNhY2hlS2V5ID09PSAnL2luZGV4JyA/ICcvJyA6IGNhY2hlS2V5O1xuICAgIH1cbiAgICBjb25zdCBzdXBwb3J0c0R5bmFtaWNSZXNwb25zZSA9IC8vIElmIHdlJ3JlIGluIGRldmVsb3BtZW50LCB3ZSBhbHdheXMgc3VwcG9ydCBkeW5hbWljIEhUTUxcbiAgICByb3V0ZU1vZHVsZS5pc0RldiA9PT0gdHJ1ZSB8fCAvLyBJZiB0aGlzIGlzIG5vdCBTU0cgb3IgZG9lcyBub3QgaGF2ZSBzdGF0aWMgcGF0aHMsIHRoZW4gaXQgc3VwcG9ydHNcbiAgICAvLyBkeW5hbWljIEhUTUwuXG4gICAgIWlzSXNyO1xuICAgIC8vIFRoaXMgaXMgYSByZXZhbGlkYXRpb24gcmVxdWVzdCBpZiB0aGUgcmVxdWVzdCBpcyBmb3IgYSBzdGF0aWNcbiAgICAvLyBwYWdlIGFuZCBpdCBpcyBub3QgYmVpbmcgcmVzdW1lZCBmcm9tIGEgcG9zdHBvbmVkIHJlbmRlciBhbmRcbiAgICAvLyBpdCBpcyBub3QgYSBkeW5hbWljIFJTQyByZXF1ZXN0IHRoZW4gaXQgaXMgYSByZXZhbGlkYXRpb25cbiAgICAvLyByZXF1ZXN0LlxuICAgIGNvbnN0IGlzUmV2YWxpZGF0ZSA9IGlzSXNyICYmICFzdXBwb3J0c0R5bmFtaWNSZXNwb25zZTtcbiAgICBjb25zdCBtZXRob2QgPSByZXEubWV0aG9kIHx8ICdHRVQnO1xuICAgIGNvbnN0IHRyYWNlciA9IGdldFRyYWNlcigpO1xuICAgIGNvbnN0IGFjdGl2ZVNwYW4gPSB0cmFjZXIuZ2V0QWN0aXZlU2NvcGVTcGFuKCk7XG4gICAgY29uc3QgY29udGV4dCA9IHtcbiAgICAgICAgcGFyYW1zLFxuICAgICAgICBwcmVyZW5kZXJNYW5pZmVzdCxcbiAgICAgICAgcmVuZGVyT3B0czoge1xuICAgICAgICAgICAgZXhwZXJpbWVudGFsOiB7XG4gICAgICAgICAgICAgICAgY2FjaGVDb21wb25lbnRzOiBCb29sZWFuKG5leHRDb25maWcuZXhwZXJpbWVudGFsLmNhY2hlQ29tcG9uZW50cyksXG4gICAgICAgICAgICAgICAgYXV0aEludGVycnVwdHM6IEJvb2xlYW4obmV4dENvbmZpZy5leHBlcmltZW50YWwuYXV0aEludGVycnVwdHMpXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc3VwcG9ydHNEeW5hbWljUmVzcG9uc2UsXG4gICAgICAgICAgICBpbmNyZW1lbnRhbENhY2hlOiBnZXRSZXF1ZXN0TWV0YShyZXEsICdpbmNyZW1lbnRhbENhY2hlJyksXG4gICAgICAgICAgICBjYWNoZUxpZmVQcm9maWxlczogKF9uZXh0Q29uZmlnX2V4cGVyaW1lbnRhbCA9IG5leHRDb25maWcuZXhwZXJpbWVudGFsKSA9PSBudWxsID8gdm9pZCAwIDogX25leHRDb25maWdfZXhwZXJpbWVudGFsLmNhY2hlTGlmZSxcbiAgICAgICAgICAgIGlzUmV2YWxpZGF0ZSxcbiAgICAgICAgICAgIHdhaXRVbnRpbDogY3R4LndhaXRVbnRpbCxcbiAgICAgICAgICAgIG9uQ2xvc2U6IChjYik9PntcbiAgICAgICAgICAgICAgICByZXMub24oJ2Nsb3NlJywgY2IpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9uQWZ0ZXJUYXNrRXJyb3I6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIG9uSW5zdHJ1bWVudGF0aW9uUmVxdWVzdEVycm9yOiAoZXJyb3IsIF9yZXF1ZXN0LCBlcnJvckNvbnRleHQpPT5yb3V0ZU1vZHVsZS5vblJlcXVlc3RFcnJvcihyZXEsIGVycm9yLCBlcnJvckNvbnRleHQsIHJvdXRlclNlcnZlckNvbnRleHQpXG4gICAgICAgIH0sXG4gICAgICAgIHNoYXJlZENvbnRleHQ6IHtcbiAgICAgICAgICAgIGJ1aWxkSWRcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3Qgbm9kZU5leHRSZXEgPSBuZXcgTm9kZU5leHRSZXF1ZXN0KHJlcSk7XG4gICAgY29uc3Qgbm9kZU5leHRSZXMgPSBuZXcgTm9kZU5leHRSZXNwb25zZShyZXMpO1xuICAgIGNvbnN0IG5leHRSZXEgPSBOZXh0UmVxdWVzdEFkYXB0ZXIuZnJvbU5vZGVOZXh0UmVxdWVzdChub2RlTmV4dFJlcSwgc2lnbmFsRnJvbU5vZGVSZXNwb25zZShyZXMpKTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBpbnZva2VSb3V0ZU1vZHVsZSA9IGFzeW5jIChzcGFuKT0+e1xuICAgICAgICAgICAgcmV0dXJuIHJvdXRlTW9kdWxlLmhhbmRsZShuZXh0UmVxLCBjb250ZXh0KS5maW5hbGx5KCgpPT57XG4gICAgICAgICAgICAgICAgaWYgKCFzcGFuKSByZXR1cm47XG4gICAgICAgICAgICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICAgICAgJ2h0dHAuc3RhdHVzX2NvZGUnOiByZXMuc3RhdHVzQ29kZSxcbiAgICAgICAgICAgICAgICAgICAgJ25leHQucnNjJzogZmFsc2VcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBjb25zdCByb290U3BhbkF0dHJpYnV0ZXMgPSB0cmFjZXIuZ2V0Um9vdFNwYW5BdHRyaWJ1dGVzKCk7XG4gICAgICAgICAgICAgICAgLy8gV2Ugd2VyZSB1bmFibGUgdG8gZ2V0IGF0dHJpYnV0ZXMsIHByb2JhYmx5IE9URUwgaXMgbm90IGVuYWJsZWRcbiAgICAgICAgICAgICAgICBpZiAoIXJvb3RTcGFuQXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChyb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnNwYW5fdHlwZScpICE9PSBCYXNlU2VydmVyU3Bhbi5oYW5kbGVSZXF1ZXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgVW5leHBlY3RlZCByb290IHNwYW4gdHlwZSAnJHtyb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnNwYW5fdHlwZScpfScuIFBsZWFzZSByZXBvcnQgdGhpcyBOZXh0LmpzIGlzc3VlIGh0dHBzOi8vZ2l0aHViLmNvbS92ZXJjZWwvbmV4dC5qc2ApO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IHJvdXRlID0gcm9vdFNwYW5BdHRyaWJ1dGVzLmdldCgnbmV4dC5yb3V0ZScpO1xuICAgICAgICAgICAgICAgIGlmIChyb3V0ZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuYW1lID0gYCR7bWV0aG9kfSAke3JvdXRlfWA7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4uc2V0QXR0cmlidXRlcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAnbmV4dC5yb3V0ZSc6IHJvdXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHAucm91dGUnOiByb3V0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICduZXh0LnNwYW5fbmFtZSc6IG5hbWVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4udXBkYXRlTmFtZShuYW1lKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzcGFuLnVwZGF0ZU5hbWUoYCR7bWV0aG9kfSAke3JlcS51cmx9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGhhbmRsZVJlc3BvbnNlID0gYXN5bmMgKGN1cnJlbnRTcGFuKT0+e1xuICAgICAgICAgICAgdmFyIF9jYWNoZUVudHJ5X3ZhbHVlO1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2VHZW5lcmF0b3IgPSBhc3luYyAoeyBwcmV2aW91c0NhY2hlRW50cnkgfSk9PntcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWdldFJlcXVlc3RNZXRhKHJlcSwgJ21pbmltYWxNb2RlJykgJiYgaXNPbkRlbWFuZFJldmFsaWRhdGUgJiYgcmV2YWxpZGF0ZU9ubHlHZW5lcmF0ZWQgJiYgIXByZXZpb3VzQ2FjaGVFbnRyeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLnN0YXR1c0NvZGUgPSA0MDQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBvbi1kZW1hbmQgcmV2YWxpZGF0ZSBhbHdheXMgc2V0cyB0aGlzIGhlYWRlclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLnNldEhlYWRlcigneC1uZXh0anMtY2FjaGUnLCAnUkVWQUxJREFURUQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5lbmQoJ1RoaXMgcGFnZSBjb3VsZCBub3QgYmUgZm91bmQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgaW52b2tlUm91dGVNb2R1bGUoY3VycmVudFNwYW4pO1xuICAgICAgICAgICAgICAgICAgICByZXEuZmV0Y2hNZXRyaWNzID0gY29udGV4dC5yZW5kZXJPcHRzLmZldGNoTWV0cmljcztcbiAgICAgICAgICAgICAgICAgICAgbGV0IHBlbmRpbmdXYWl0VW50aWwgPSBjb250ZXh0LnJlbmRlck9wdHMucGVuZGluZ1dhaXRVbnRpbDtcbiAgICAgICAgICAgICAgICAgICAgLy8gQXR0ZW1wdCB1c2luZyBwcm92aWRlZCB3YWl0VW50aWwgaWYgYXZhaWxhYmxlXG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIGl0J3Mgbm90IHdlIGZhbGxiYWNrIHRvIHNlbmRSZXNwb25zZSdzIGhhbmRsaW5nXG4gICAgICAgICAgICAgICAgICAgIGlmIChwZW5kaW5nV2FpdFVudGlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3R4LndhaXRVbnRpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC53YWl0VW50aWwocGVuZGluZ1dhaXRVbnRpbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVuZGluZ1dhaXRVbnRpbCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjYWNoZVRhZ3MgPSBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkVGFncztcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlIHJlcXVlc3QgaXMgZm9yIGEgc3RhdGljIHJlc3BvbnNlLCB3ZSBjYW4gY2FjaGUgaXQgc28gbG9uZ1xuICAgICAgICAgICAgICAgICAgICAvLyBhcyBpdCdzIG5vdCBlZGdlLlxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNJc3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJsb2IgPSBhd2FpdCByZXNwb25zZS5ibG9iKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDb3B5IHRoZSBoZWFkZXJzIGZyb20gdGhlIHJlc3BvbnNlLlxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaGVhZGVycyA9IHRvTm9kZU91dGdvaW5nSHR0cEhlYWRlcnMocmVzcG9uc2UuaGVhZGVycyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2FjaGVUYWdzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyc1tORVhUX0NBQ0hFX1RBR1NfSEVBREVSXSA9IGNhY2hlVGFncztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaGVhZGVyc1snY29udGVudC10eXBlJ10gJiYgYmxvYi50eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyc1snY29udGVudC10eXBlJ10gPSBibG9iLnR5cGU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXZhbGlkYXRlID0gdHlwZW9mIGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRSZXZhbGlkYXRlID09PSAndW5kZWZpbmVkJyB8fCBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkUmV2YWxpZGF0ZSA+PSBJTkZJTklURV9DQUNIRSA/IGZhbHNlIDogY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZFJldmFsaWRhdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBleHBpcmUgPSB0eXBlb2YgY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZEV4cGlyZSA9PT0gJ3VuZGVmaW5lZCcgfHwgY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZEV4cGlyZSA+PSBJTkZJTklURV9DQUNIRSA/IHVuZGVmaW5lZCA6IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRFeHBpcmU7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgdGhlIGNhY2hlIGVudHJ5IGZvciB0aGUgcmVzcG9uc2UuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYWNoZUVudHJ5ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtpbmQ6IENhY2hlZFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib2R5OiBCdWZmZXIuZnJvbShhd2FpdCBibG9iLmFycmF5QnVmZmVyKCkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWNoZUNvbnRyb2w6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwaXJlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjYWNoZUVudHJ5O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VuZCByZXNwb25zZSB3aXRob3V0IGNhY2hpbmcgaWYgbm90IElTUlxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2VuZFJlc3BvbnNlKG5vZGVOZXh0UmVxLCBub2RlTmV4dFJlcywgcmVzcG9uc2UsIGNvbnRleHQucmVuZGVyT3B0cy5wZW5kaW5nV2FpdFVudGlsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIHRoaXMgaXMgYSBiYWNrZ3JvdW5kIHJldmFsaWRhdGUgd2UgbmVlZCB0byByZXBvcnRcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHJlcXVlc3QgZXJyb3IgaGVyZSBhcyBpdCB3b24ndCBiZSBidWJibGVkXG4gICAgICAgICAgICAgICAgICAgIGlmIChwcmV2aW91c0NhY2hlRW50cnkgPT0gbnVsbCA/IHZvaWQgMCA6IHByZXZpb3VzQ2FjaGVFbnRyeS5pc1N0YWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCByb3V0ZU1vZHVsZS5vblJlcXVlc3RFcnJvcihyZXEsIGVyciwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdXRlcktpbmQ6ICdBcHAgUm91dGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3V0ZVBhdGg6IHNyY1BhZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm91dGVUeXBlOiAncm91dGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldmFsaWRhdGVSZWFzb246IGdldFJldmFsaWRhdGVSZWFzb24oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1JldmFsaWRhdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzT25EZW1hbmRSZXZhbGlkYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIHJvdXRlclNlcnZlckNvbnRleHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY29uc3QgY2FjaGVFbnRyeSA9IGF3YWl0IHJvdXRlTW9kdWxlLmhhbmRsZVJlc3BvbnNlKHtcbiAgICAgICAgICAgICAgICByZXEsXG4gICAgICAgICAgICAgICAgbmV4dENvbmZpZyxcbiAgICAgICAgICAgICAgICBjYWNoZUtleSxcbiAgICAgICAgICAgICAgICByb3V0ZUtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgICAgICAgICAgaXNGYWxsYmFjazogZmFsc2UsXG4gICAgICAgICAgICAgICAgcHJlcmVuZGVyTWFuaWZlc3QsXG4gICAgICAgICAgICAgICAgaXNSb3V0ZVBQUkVuYWJsZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGlzT25EZW1hbmRSZXZhbGlkYXRlLFxuICAgICAgICAgICAgICAgIHJldmFsaWRhdGVPbmx5R2VuZXJhdGVkLFxuICAgICAgICAgICAgICAgIHJlc3BvbnNlR2VuZXJhdG9yLFxuICAgICAgICAgICAgICAgIHdhaXRVbnRpbDogY3R4LndhaXRVbnRpbFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyB3ZSBkb24ndCBjcmVhdGUgYSBjYWNoZUVudHJ5IGZvciBJU1JcbiAgICAgICAgICAgIGlmICghaXNJc3IpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgoY2FjaGVFbnRyeSA9PSBudWxsID8gdm9pZCAwIDogKF9jYWNoZUVudHJ5X3ZhbHVlID0gY2FjaGVFbnRyeS52YWx1ZSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9jYWNoZUVudHJ5X3ZhbHVlLmtpbmQpICE9PSBDYWNoZWRSb3V0ZUtpbmQuQVBQX1JPVVRFKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9jYWNoZUVudHJ5X3ZhbHVlMTtcbiAgICAgICAgICAgICAgICB0aHJvdyBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3IEVycm9yKGBJbnZhcmlhbnQ6IGFwcC1yb3V0ZSByZWNlaXZlZCBpbnZhbGlkIGNhY2hlIGVudHJ5ICR7Y2FjaGVFbnRyeSA9PSBudWxsID8gdm9pZCAwIDogKF9jYWNoZUVudHJ5X3ZhbHVlMSA9IGNhY2hlRW50cnkudmFsdWUpID09IG51bGwgPyB2b2lkIDAgOiBfY2FjaGVFbnRyeV92YWx1ZTEua2luZH1gKSwgXCJfX05FWFRfRVJST1JfQ09ERVwiLCB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBcIkU3MDFcIixcbiAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFnZXRSZXF1ZXN0TWV0YShyZXEsICdtaW5pbWFsTW9kZScpKSB7XG4gICAgICAgICAgICAgICAgcmVzLnNldEhlYWRlcigneC1uZXh0anMtY2FjaGUnLCBpc09uRGVtYW5kUmV2YWxpZGF0ZSA/ICdSRVZBTElEQVRFRCcgOiBjYWNoZUVudHJ5LmlzTWlzcyA/ICdNSVNTJyA6IGNhY2hlRW50cnkuaXNTdGFsZSA/ICdTVEFMRScgOiAnSElUJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBEcmFmdCBtb2RlIHNob3VsZCBuZXZlciBiZSBjYWNoZWRcbiAgICAgICAgICAgIGlmIChpc0RyYWZ0TW9kZSkge1xuICAgICAgICAgICAgICAgIHJlcy5zZXRIZWFkZXIoJ0NhY2hlLUNvbnRyb2wnLCAncHJpdmF0ZSwgbm8tY2FjaGUsIG5vLXN0b3JlLCBtYXgtYWdlPTAsIG11c3QtcmV2YWxpZGF0ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgaGVhZGVycyA9IGZyb21Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycyhjYWNoZUVudHJ5LnZhbHVlLmhlYWRlcnMpO1xuICAgICAgICAgICAgaWYgKCEoZ2V0UmVxdWVzdE1ldGEocmVxLCAnbWluaW1hbE1vZGUnKSAmJiBpc0lzcikpIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzLmRlbGV0ZShORVhUX0NBQ0hFX1RBR1NfSEVBREVSKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIElmIGNhY2hlIGNvbnRyb2wgaXMgYWxyZWFkeSBzZXQgb24gdGhlIHJlc3BvbnNlIHdlIGRvbid0XG4gICAgICAgICAgICAvLyBvdmVycmlkZSBpdCB0byBhbGxvdyB1c2VycyB0byBjdXN0b21pemUgaXQgdmlhIG5leHQuY29uZmlnXG4gICAgICAgICAgICBpZiAoY2FjaGVFbnRyeS5jYWNoZUNvbnRyb2wgJiYgIXJlcy5nZXRIZWFkZXIoJ0NhY2hlLUNvbnRyb2wnKSAmJiAhaGVhZGVycy5nZXQoJ0NhY2hlLUNvbnRyb2wnKSkge1xuICAgICAgICAgICAgICAgIGhlYWRlcnMuc2V0KCdDYWNoZS1Db250cm9sJywgZ2V0Q2FjaGVDb250cm9sSGVhZGVyKGNhY2hlRW50cnkuY2FjaGVDb250cm9sKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhd2FpdCBzZW5kUmVzcG9uc2Uobm9kZU5leHRSZXEsIG5vZGVOZXh0UmVzLCBuZXcgUmVzcG9uc2UoY2FjaGVFbnRyeS52YWx1ZS5ib2R5LCB7XG4gICAgICAgICAgICAgICAgaGVhZGVycyxcbiAgICAgICAgICAgICAgICBzdGF0dXM6IGNhY2hlRW50cnkudmFsdWUuc3RhdHVzIHx8IDIwMFxuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIC8vIFRPRE86IGFjdGl2ZVNwYW4gY29kZSBwYXRoIGlzIGZvciB3aGVuIHdyYXBwZWQgYnlcbiAgICAgICAgLy8gbmV4dC1zZXJ2ZXIgY2FuIGJlIHJlbW92ZWQgd2hlbiB0aGlzIGlzIG5vIGxvbmdlciB1c2VkXG4gICAgICAgIGlmIChhY3RpdmVTcGFuKSB7XG4gICAgICAgICAgICBhd2FpdCBoYW5kbGVSZXNwb25zZShhY3RpdmVTcGFuKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGF3YWl0IHRyYWNlci53aXRoUHJvcGFnYXRlZENvbnRleHQocmVxLmhlYWRlcnMsICgpPT50cmFjZXIudHJhY2UoQmFzZVNlcnZlclNwYW4uaGFuZGxlUmVxdWVzdCwge1xuICAgICAgICAgICAgICAgICAgICBzcGFuTmFtZTogYCR7bWV0aG9kfSAke3JlcS51cmx9YCxcbiAgICAgICAgICAgICAgICAgICAga2luZDogU3BhbktpbmQuU0VSVkVSLFxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnaHR0cC5tZXRob2QnOiBtZXRob2QsXG4gICAgICAgICAgICAgICAgICAgICAgICAnaHR0cC50YXJnZXQnOiByZXEudXJsXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCBoYW5kbGVSZXNwb25zZSkpO1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGlmICghKGVyciBpbnN0YW5jZW9mIE5vRmFsbGJhY2tFcnJvcikpIHtcbiAgICAgICAgICAgIGF3YWl0IHJvdXRlTW9kdWxlLm9uUmVxdWVzdEVycm9yKHJlcSwgZXJyLCB7XG4gICAgICAgICAgICAgICAgcm91dGVyS2luZDogJ0FwcCBSb3V0ZXInLFxuICAgICAgICAgICAgICAgIHJvdXRlUGF0aDogbm9ybWFsaXplZFNyY1BhZ2UsXG4gICAgICAgICAgICAgICAgcm91dGVUeXBlOiAncm91dGUnLFxuICAgICAgICAgICAgICAgIHJldmFsaWRhdGVSZWFzb246IGdldFJldmFsaWRhdGVSZWFzb24oe1xuICAgICAgICAgICAgICAgICAgICBpc1JldmFsaWRhdGUsXG4gICAgICAgICAgICAgICAgICAgIGlzT25EZW1hbmRSZXZhbGlkYXRlXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vIHJldGhyb3cgc28gdGhhdCB3ZSBjYW4gaGFuZGxlIHNlcnZpbmcgZXJyb3IgcGFnZVxuICAgICAgICAvLyBJZiB0aGlzIGlzIGR1cmluZyBzdGF0aWMgZ2VuZXJhdGlvbiwgdGhyb3cgdGhlIGVycm9yIGFnYWluLlxuICAgICAgICBpZiAoaXNJc3IpIHRocm93IGVycjtcbiAgICAgICAgLy8gT3RoZXJ3aXNlLCBzZW5kIGEgNTAwIHJlc3BvbnNlLlxuICAgICAgICBhd2FpdCBzZW5kUmVzcG9uc2Uobm9kZU5leHRSZXEsIG5vZGVOZXh0UmVzLCBuZXcgUmVzcG9uc2UobnVsbCwge1xuICAgICAgICAgICAgc3RhdHVzOiA1MDBcbiAgICAgICAgfSkpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXBcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fconnect%2Froute&page=%2Fapi%2Fconnect%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fconnect%2Froute.ts&appDir=%2FUsers%2Feliasstevenson%2FDesktop%2FProjects%2Fclawboard%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Feliasstevenson%2FDesktop%2FProjects%2Fclawboard&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/server/app-render/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/action-async-storage.external.js");

/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "./work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("net");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "next/dist/shared/lib/no-fallback-error.external":
/*!******************************************************************!*\
  !*** external "next/dist/shared/lib/no-fallback-error.external" ***!
  \******************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/no-fallback-error.external");

/***/ }),

/***/ "next/dist/shared/lib/router/utils/app-paths":
/*!**************************************************************!*\
  !*** external "next/dist/shared/lib/router/utils/app-paths" ***!
  \**************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/app-paths");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:crypto");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:fs");

/***/ }),

/***/ "node:path":
/*!****************************!*\
  !*** external "node:path" ***!
  \****************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fconnect%2Froute&page=%2Fapi%2Fconnect%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fconnect%2Froute.ts&appDir=%2FUsers%2Feliasstevenson%2FDesktop%2FProjects%2Fclawboard%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Feliasstevenson%2FDesktop%2FProjects%2Fclawboard&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!")));
module.exports = __webpack_exports__;

})();